!function(){var t=void 0;!function(){function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(t){return i(e[a][1][t]||t)},d,d.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){"use strict";function r(t,e){var n=t;return function(){if(--n<1)return e.apply(this,arguments)}}n.__esModule=!0,n.default=r},{}],2:[function(t,e,n){"use strict";function r(t,e){for(var n=e,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if(i=n.next(),i.done)break;o=i.value}var a=o;t.indexOf(a)<0&&t.push(a)}}n.__esModule=!0,n.default=r},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return(0,s.default)(t,function(e){var n=t[e];void 0===n||null===n||""===n?(0,a.default)(t,e):"object"!==(void 0===n?"undefined":o(n))||n instanceof Date||Array.isArray(n)&&!(Object.keys(n).length>0)||i(t[e])}),t}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.default=i;var a=r(t("./deleteProperty")),s=r(t("./each"))},{"./deleteProperty":5,"./each":8}],4:[function(t,e,n){"use strict";function r(t,e){if(void 0===e&&(e=!1),!t)return t;if(!e&&JSON.parse&&JSON.stringify)return JSON.parse(JSON.stringify(t));switch(void 0===t?"undefined":i(t)){case"object":if(!Array.isArray(t)){if(t instanceof Date)return new Date(t.getTime());var n={};for(var o in t)({}).hasOwnProperty.call(t,o)&&(n[o]=r(t[o],e));return n}for(var a=new Array(t.length),s=0,c=t.length;s<c;s+=1)a[s]=r(t[s],e);return a;default:return t}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.default=r},{}],5:[function(t,e,n){"use strict";function r(t,e){try{delete t[e]}catch(n){t[e]=void 0}}n.__esModule=!0,n.default=r},{}],6:[function(t,e,n){"use strict";function r(t,e){if(e=e||window.document,/^(#?[\w-]+|\.[\w-.]+)$/.test(t))switch(t.charAt(0)){case"#":var n=e.getElementById(t.substr(1));return n?[n]:[];case".":var r=t.substr(1).replace(/\./g," ");return[].slice.call(e.getElementsByClassName(r));default:return[].slice.call(e.getElementsByTagName(t))}return[].slice.call(e.querySelectorAll(t))}n.__esModule=!0,n.default=r},{}],7:[function(t,e,n){"use strict";function r(t){return""===(t=t.trim())?[]:(t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),t.split("."))}function i(t,e){if(e){for(var n=r(e),i=t;n.length>0;){var o=n.shift();if(void 0===i||null===i||!i.hasOwnProperty||!{}.hasOwnProperty.call(i,o)||void 0===i[o])return;i=i[o]}return i}}function o(t,e,n){if("object"===(void 0===t?"undefined":a(t))&&"string"==typeof e)for(var i=r(e),o=0;o<i.length;o++){var s=i[o];"object"!==a(t[s])&&(t[s]={}),o===i.length-1&&(t[s]=n),t=t[s]}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.getProp=i,n.setProp=o,n.default=void 0;var s={getProp:i,setProp:o};n.default=s},{}],8:[function(t,e,n){"use strict";function r(t,e){for(var n in t)({}).hasOwnProperty.call(t,n)&&e(n,t[n])}n.__esModule=!0,n.default=r},{}],9:[function(t,e,n){"use strict";function r(t,e,n,r){return t[o](s+e,n,r||!1),n}function i(t,e,n,r){return t[a](s+e,n,r||!1),n}n.__esModule=!0,n.bind=r,n.unbind=i;var o=window.addEventListener?"addEventListener":"attachEvent",a=window.removeEventListener?"removeEventListener":"detachEvent",s="addEventListener"!==o?"on":""},{}],10:[function(t,e,n){"use strict";function r(t){var e=[].slice.call(arguments,1),n=0;return t.replace(/%([a-z])/gi,function(t,r){return o[r]?o[r](e[n++]):t+r})}n.__esModule=!0,n.default=r;var i=window.JSON?JSON.stringify:String,o={o:i,s:String,d:parseInt}},{}],11:[function(t,e,n){"use strict";function r(t){if(window.dataLayer&&window.dataLayer.push)for(var e=window.dataLayer.length;e>=0;e-=1)if("object"===i(window.dataLayer[e])){var n=(0,o.getProp)(window.dataLayer[e],t);if(void 0!==n)return n}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.default=r;var o=t("./dotProp")},{"./dotProp":7}],12:[function(t,e,n){"use strict";function r(t,e){"string"!=typeof e&&(e=i.default.getLocation().search),t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+t+"=([^&#]*)"),r=n.exec(e);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}n.__esModule=!0,n.default=r;var i=function(t){return t&&t.__esModule?t:{default:t}}(t("./htmlGlobals"))},{"./htmlGlobals":17}],13:[function(t,e,n){"use strict";function r(t,e){return window.getComputedStyle?window.getComputedStyle(t)[e]:t.currentStyle?t.currentStyle[e]:void 0}n.__esModule=!0,n.default=r},{}],14:[function(t,e,n){"use strict";function r(t,e){return"constant"===t.type?t.value:(0,i.getProp)(e,t.value)}n.__esModule=!0,n.default=r;var i=t("./dotProp")},{"./dotProp":7}],15:[function(t,e,n){"use strict";n.__esModule=!0,n.default=void 0;var r=function(t,e,n){void 0===n&&(n=[]),Object.keys(e).forEach(function(r){var i=e[r];n.indexOf(r)<0&&(/^data-.*/.test(r)?t.setAttribute(r,i):t[r]=i)})};n.default=r},{}],16:[function(t,e,n){"use strict";n.__esModule=!0,n.default=void 0;var r=function(t,e){void 0===e&&(e="src");var n="https:"===document.location.protocol||"chrome-extension:"===document.location.protocol;t[e]&&0===t[e].indexOf("//")&&(t[e]=n?"https:"+t[e]:"http:"+t[e]),n&&t.https?t[e]=t.https:!n&&t.http&&(t[e]=t.http)};n.default=r},{}],17:[function(t,e,n){"use strict";n.__esModule=!0,n.default=void 0;var r={getDocument:function(){return window.document},getLocation:function(){return window.location},getNavigator:function(){return window.navigator}};n.default=r},{}],18:[function(t,e,n){"use strict";function r(t){var e=0;return t.split(".").forEach(function(t){e<<=8,e+=parseInt(t,10)}),e>>>0}n.__esModule=!0,n.default=r},{}],19:[function(t,e,n){"use strict";function r(t){return i.some(function(e){return e.test(t)})}n.__esModule=!0,n.default=r;var i=[/bot/i,/spider/i,/facebookexternalhit/i,/simplepie/i,/yahooseeker/i,/embedly/i,/quora link preview/i,/outbrain/i,/vkshare/i,/monit/i,/Pingability/i,/Monitoring/i,/WinHttpRequest/i,/Apache-HttpClient/i,/getprismatic.com/i,/python-requests/i,/Twurly/i,/compatible; yandex/i,/browserproxy/i,/Monitoring/i,/crawler/i,/Qwantify/i,/Yahoo! Slurp/i,/pinterest/i]},{}],20:[function(t,e,n){"use strict";function r(t){return t.constructor===Object&&0===Object.keys(t).length}n.__esModule=!0,n.default=r},{}],21:[function(t,e,n){"use strict";function r(t){if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return!0;var e=t.which,n=t.button;return e||void 0===n?2===e:1&!n&&2&!n&&4&n}n.__esModule=!0,n.default=r},{}],22:[function(t,e,n){"use strict";function r(t){return t&&"object"===(void 0===t?"undefined":i(t))&&t.then&&"function"==typeof t.then}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.default=r},{}],23:[function(t,e,n){"use strict";function r(t,e){return"string"!=typeof t&&(t=JSON.stringify(t)),"string"!=typeof e&&(e=JSON.stringify(e)),t===e}n.__esModule=!0,n.default=r},{}],24:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new Error("Cant load nothing...");"string"==typeof t&&(t={src:t}),(0,s.default)(t);var n=document.createElement("iframe");return(0,a.default)(n,t,["width","height","frameBorder","style","http","https"]),n.width=t.width||0,n.height=t.height||0,n.frameBorder=t.frameBorder||0,n.style.display="none","function"==typeof e&&(0,o.default)(n,e),setTimeout(function(){document.body.appendChild(n)},0),n}n.__esModule=!0,n.default=i;var o=r(t("./scriptOnLoad")),a=r(t("./helpers/setAttributes")),s=r(t("./helpers/setOptionsProtocol"))},{"./helpers/setAttributes":15,"./helpers/setOptionsProtocol":16,"./scriptOnLoad":34}],25:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new Error("Cant load nothing...");(0,s.default)(t,"href");var n=document.createElement("link");return(0,a.default)(n,t,["https","http"]),"function"==typeof e&&(0,o.default)(n,e),setTimeout(function(){var t=document.getElementsByTagName("link")[0];t.parentNode.insertBefore(n,t)},0),n}n.__esModule=!0,n.default=i;var o=r(t("./scriptOnLoad")),a=r(t("./helpers/setAttributes")),s=r(t("./helpers/setOptionsProtocol"))},{"./helpers/setAttributes":15,"./helpers/setOptionsProtocol":16,"./scriptOnLoad":34}],26:[function(t,e,n){"use strict";function r(t,e,n){return function(r){r=r||window.event;var i=new Error(e);i.event=r,i.source=n,t(i)}}function i(t,e){e=e||function(){};var n=new Image;return n.onerror=r(e,"failed to load pixel",n),n.onload=e,(0,o.default)(n,t,["width","height"]),n.width=1,n.height=1,n}n.__esModule=!0,n.default=i;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./helpers/setAttributes"))},{"./helpers/setAttributes":15}],27:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new Error("Cant load nothing...");"string"==typeof t&&(t={src:t}),(0,s.default)(t);var n=document.createElement("script");n.type="text/javascript",n.async=!0,(0,a.default)(n,t,["async","type","http","https"]),n.src=t.src,"function"==typeof e&&(0,o.default)(n,e);var r=function(){var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)};return"Microsoft Internet Explorer"===navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)?setTimeout(r,0):r(),n}n.__esModule=!0,n.default=i;var o=r(t("./scriptOnLoad")),a=r(t("./helpers/setAttributes")),s=r(t("./helpers/setOptionsProtocol"))},{"./helpers/setAttributes":15,"./helpers/setOptionsProtocol":16,"./scriptOnLoad":34}],28:[function(t,e,n){"use strict";function r(t,e){console.log=console.log||i.default,console.warn=console.warn||console.log,console.error=console.error||console.warn,e?e===o?console.warn(t):e===a&&console.error(t):console.log(t)}n.__esModule=!0,n.default=void 0;var i=function(t){return t&&t.__esModule?t:{default:t}}(t("./noop")),o="warning",a="error";r.MESSAGE="message",r.WARNING=o,r.ERROR=a;var s=r;n.default=s},{"./noop":29}],29:[function(t,e,n){"use strict";function r(){}n.__esModule=!0,n.default=r},{}],30:[function(t,e,n){"use strict";function r(t){return t?String(t).trim().toLowerCase():""}n.__esModule=!0,n.default=r},{}],31:[function(t,e,n){"use strict";function r(t){return t=t||window.event,t.preventDefault?t.preventDefault():t.returnValue=!1}n.__esModule=!0,n.default=r},{}],32:[function(t,e,n){"use strict";function r(t){if("string"!=typeof t)return{};if(""===(t=t.trim()))return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var e={},n=t.split("&"),r=0;r<n.length;r++){var i=n[r].split("="),o=u(i[0]),a=s.exec(o);a?(e[a[1]]=e[a[1]]||[],e[a[1]][a[2]]=u(i[1])):e[i[0]]=null===i[1]?"":u(i[1])}return e}function i(t){if(!t)return"";var e=[];return(0,a.default)(t,function(n,r){if("object"===(void 0===r?"undefined":o(r))&&r.length)for(var i=0;i<r.length;++i)e.push(c(n+"["+i+"]")+"="+c(r[i]));else e.push(c(n)+"="+c(t[n]))}),e.join("&")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.parse=r,n.stringify=i;var a=function(t){return t&&t.__esModule?t:{default:t}}(t("./each.js")),s=/(\w+)\[(\d+)\]/,c=function(t){try{return encodeURIComponent(t)}catch(e){return t}},u=function(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return t}}},{"./each.js":8}],33:[function(t,e,n){"use strict";function r(t,e){window.console.log(t,e)}function i(t){window.console.warn(t)}function o(t){window.console.info(t)}function a(t){if(window.__DEV_MODE__)throw t;window.console.error(t)}function s(t){d?window.console.group(t):r(t)}function c(){d&&window.console.groupEnd()}n.__esModule=!0,n.log=r,n.warn=i,n.info=o,n.error=a,n.group=s,n.groupEnd=c;var u=function(t){return t&&t.__esModule?t:{default:t}}(t("./noop"));window.console.log=window.console.log||u.default,window.console.info=window.console.info||window.console.log,window.console.warn=window.console.warn||window.console.log,window.console.error=window.console.error||window.console.warn;var d=!!window.console.group},{"./noop":29}],34:[function(t,e,n){"use strict";function r(t,e){t.addEventListener("load",function(t,n){e(null,n)},!1),t.addEventListener("error",function(n){var r=new Error('script error "'+t.src+'"');r.event=n,e(r)},!1)}function i(t,e){t.attachEvent("onreadystatechange",function(n){/complete|loaded/.test(t.readyState)&&("loaded"===t.readyState?setTimeout(function(){e(null,n)},500):e(null,n))}),t.attachEvent("onerror",function(n){var r=new Error('failed to load the script "'+t.src+'"');r.event=n||window.event,e(r)})}function o(t,e){return t.addEventListener?r(t,e):i(t,e)}n.__esModule=!0,n.default=o},{}],35:[function(t,e,n){"use strict";function r(t,e){for(var n=t.split("."),r=e.split("."),i=0;i<3;i++){var o=Number(n[i]),a=Number(r[i]);if(o>a)return 1;if(a>o)return-1;if(!isNaN(o)&&isNaN(a))return 1;if(isNaN(o)&&!isNaN(a))return-1}return 0}n.__esModule=!0,n.cmp=r,n.default=void 0;var i={cmp:r};n.default=i},{}],36:[function(t,e,n){"use strict";function r(t){var e=0;for(var n in t)({}).hasOwnProperty.call(t,n)&&(e+=1);return e}n.__esModule=!0,n.default=r},{}],37:[function(t,e,n){"use strict";function r(t){var e=(0,o.parse)(t).hostname,n=e.split("."),r=n[n.length-1],i=[];if(4===n.length&&parseInt(r,10)===r)return i;if(n.length<=1)return i;for(var a=n.length-2;a>=0;--a)i.push(n.slice(a).join("."));return i}function i(t){for(var e=r(t),n=0;n<e.length;++n){var i=e[n],o={domain:"."+i};if(a.default.set("__tld__",1,o),a.default.get("__tld__"))return a.default.set("__tld__",null,o),i}return""}n.__esModule=!0,n.default=i;var o=t("./url.js"),a=function(t){return t&&t.__esModule?t:{default:t}}(t("js-cookie"))},{"./url.js":38,"js-cookie":102}],38:[function(t,e,n){"use strict";function r(t){switch(t){case"http:":return 80;case"https:":return 443;default:return window.location.port}}function i(t){var e=document.createElement("a");return e.href=t,{href:e.href,host:e.host||window.location.host,port:"0"===e.port||""===e.port?r(e.protocol):e.port,hash:e.hash,hostname:e.hostname||window.location.hostname,pathname:"/"!==e.pathname.charAt(0)?"/"+e.pathname:e.pathname,protocol:e.protocol&&":"!==e.protocol?e.protocol:window.location.protocol,search:e.search,query:e.search.slice(1)}}n.__esModule=!0,n.parse=i},{}],39:[function(t,e,n){"use strict";function r(t){"?"===t.charAt(0)&&(t=t.substring(1)),t=t.replace(/\?/g,"&");var e=(0,i.parse)(t),n={};return(0,o.default)(e,function(t,r){"utm_"===t.substr(0,4)&&(r=t.substr(4),"campaign"===r&&(r="name"),n[r]=e[t])}),n}n.__esModule=!0,n.default=r;var i=t("./queryString.js"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("./each.js"))},{"./each.js":8,"./queryString.js":32}],40:[function(t,e,n){"use strict";function r(t){var e={};if(c||(0,i.default)(t)!==(0,i.default)(window.location.hostname)){var n=d(t),r=(0,o.parse)(t);if(n){var s=(0,a.parse)(r.query);e.source=n.name,e.medium="organic",s[n.query]&&(e.term=s[n.query])}else t&&(e.source=l(r.hostname),e.medium="referral")}return e}n.__esModule=!0,n.default=r,n.setIgnoreSameDomainCheck=void 0;var i=function(t){return t&&t.__esModule?t:{default:t}}(t("./topDomain")),o=t("./url"),a=t("./queryString"),s=[{regex:/www.google./,query:"q",name:"google"},{regex:/^https?:\/\/.*ampproject.(org|net)/,query:"q",name:"google"},{regex:/^https?:\/\/.*duckduckgo\.com./,query:"q",name:"duckduckgo"},{regex:/^https?:\/\/(www\.|nova\.)?rambler\.ru/,query:"query",name:"rambler"},{regex:/^https?:\/\/(www\.)?yandex\.([a-z]{2,3})\/?$/,query:"text",name:"yandex"},{regex:/yandex..*\/.*\?.*text=/,query:"text",name:"yandex"},{regex:/go.mail.ru\//,query:"q",name:"mailru"},{regex:/www.bing.com\//,query:"q",name:"bing"},{regex:/search.yahoo.com\/search/,query:"p",name:"yahoo"},{regex:/ru.ask.com\//,query:"q",name:"ask"},{regex:/search.qip.ru\/search/,query:"query",name:"qip"},{regex:/360.cn\//,query:"q",name:"360.cn"},{regex:/www.alice.com\//,query:"qs",name:"Alice"},{regex:/aliceadsl.fr/,query:"qs",name:"Alice"},{regex:/www.alltheweb.com\//,query:"q",name:"Alltheweb"},{regex:/www.altavista.com\//,query:"q",name:"Altavista"},{regex:/www.ask.com\//,query:"q",name:"Ask"},{regex:/search.aol.fr/,query:"q",name:"Ask"},{regex:/alicesuche.aol.de/,query:"q",name:"Ask"},{regex:/search.auone.jp\//,query:"q",name:"Auone"},{regex:/isearch.avg.com/,query:"q",name:"Avg"},{regex:/search.babylon.com/,query:"q",name:"Babylon"},{regex:/www.baidu.com\//,query:"wd",name:"Baidu"},{regex:/biglobe.ne.jp/,query:"q",name:"Biglobe"},{regex:/search.centrum.cz\//,query:"q",name:"Centrum.cz"},{regex:/search.comcast.net/,query:"q",name:"Comcast"},{regex:/search.conduit.com/,query:"q",name:"Conduit"},{regex:/www.cnn.com\/SEARCH\//,query:"q",name:"CNN"},{regex:/www.daum.net\//,query:"q",name:"Daum"},{regex:/www.ekolay.net\//,query:"q",name:"Ekolay"},{regex:/www.eniro.se\//,query:"search_word",name:"Eniro"},{regex:/www.globo.com\/busca\//,query:"q",name:"Globo"},{regex:/goo.ne.jp/,query:"MT",name:"goo.ne"},{regex:/www.haosou.com\/s/,query:"q",name:"haosou.com"},{regex:/search.incredimail.com/,query:"q",name:"Incredimail"},{regex:/www.kvasir.no\//,query:"q",name:"Kvasir"},{regex:/www.lycos.com\//,query:"q",name:"Lycos"},{regex:/search.lycos./,query:"query",name:"Lycos"},{regex:/www.mamma.com\//,query:"query",name:"Mamma"},{regex:/www.msn.com\//,query:"q",name:"MSN"},{regex:/www.mynet.com\//,query:"q",name:"Mynet"},{regex:/najdi.si/,query:"q",name:"Najdi"},{regex:/www.naver.com\//,query:"query",name:"Naver"},{regex:/search.netscape.com\//,query:"query",name:"Netscape"},{regex:/szukaj.onet.pl/,query:"qt",name:"ONET"},{regex:/www.ozu.es\//,query:"q",name:"Ozu"},{regex:/rakuten.co.jp/,query:"qt",name:"Rakuten"},{regex:/search-results.com/,query:"q",name:"Search-results"},{regex:/search.smt.docomo.ne.jp/,query:"MT",name:"search.smt.docomo"},{regex:/sesam.no\//,query:"q",name:"Sesam"},{regex:/www.seznam.cz\//,query:"q",name:"Seznam"},{regex:/www.so.com\/s/,query:"q",name:"So.com"},{regex:/www.sogou.com\//,query:"query",name:"Sogou"},{regex:/www.startsiden.no\/sok/,query:"q",name:"Startsiden"},{regex:/www.szukacz.pl\//,query:"q",name:"Szukacz"},{regex:/buscador.terra.com.br/,query:"query",name:"Terra"},{regex:/search.tut.by\//,query:"query",name:"Tut.by"},{regex:/search.ukr.net\//,query:"q",name:"Ukr"},{regex:/search.virgilio.it\//,query:"qs",name:"Virgilio"},{regex:/www.voila.fr\//,query:"rdata",name:"Voila"},{regex:/www.wp.pl\//,query:"szukaj",name:"Wirtulana Polska"},{regex:/www.yam.com\//,query:"k",name:"Yam"}],c=!1,u=function(t){c=t};n.setIgnoreSameDomainCheck=u;var d=function(t){return s.find(function(e){return e.regex.test(t)})||!1},l=function(t){return t.replace(/^www\./i,"")}},{"./queryString":32,"./topDomain":37,"./url":38}],41:[function(t,e,n){(function(e,r){"use strict";function i(t){setTimeout(t,0)}function o(t){return(0,c.default)(function(e,n){t(function(){e.apply(null,n)})})}Object.defineProperty(n,"__esModule",{value:!0}),n.hasNextTick=n.hasSetImmediate=void 0,n.fallback=i,n.wrap=o;var a,s=t("lodash/_baseRest"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=n.hasSetImmediate="function"==typeof r&&r,d=n.hasNextTick="object"==typeof e&&"function"==typeof e.nextTick;a=u?r:d?e.nextTick:i,n.default=o(a)}).call(this,t("_process"),t("timers").setImmediate)},{_process:127,"lodash/_baseRest":108,timers:129}],42:[function(t,e,n){(function(r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,a=t("./internal/setImmediate");o=a.hasNextTick?r.nextTick:a.hasSetImmediate?i:a.fallback,n.default=(0,a.wrap)(o),e.exports=n.default}).call(this,t("_process"),t("timers").setImmediate)},{"./internal/setImmediate":41,_process:127,timers:129}],43:[function(t,e,n){function r(t){if(t)return i(t)}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){r.off(t,n),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===e||r.fn===e){n.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks[t];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],44:[function(t,e,n){t("../../modules/es6.array.fill"),e.exports=t("../../modules/_core").Array.fill},{"../../modules/_core":57,"../../modules/es6.array.fill":95}],45:[function(t,e,n){t("../../modules/es6.array.find"),e.exports=t("../../modules/_core").Array.find},{"../../modules/_core":57,"../../modules/es6.array.find":96}],46:[function(t,e,n){t("../../modules/es6.object.assign"),e.exports=t("../../modules/_core").Object.assign},{"../../modules/_core":57,"../../modules/es6.object.assign":97}],47:[function(t,e,n){t("../../modules/es6.string.ends-with"),e.exports=t("../../modules/_core").String.endsWith},{"../../modules/_core":57,"../../modules/es6.string.ends-with":98}],48:[function(t,e,n){e.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],49:[function(t,e,n){var r=t("./_wks")("unscopables"),i=Array.prototype;void 0==i[r]&&t("./_hide")(i,r,{}),e.exports=function(t){i[r][t]=!0}},{"./_hide":69,"./_wks":94}],50:[function(t,e,n){var r=t("./_is-object");e.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},{"./_is-object":73}],51:[function(t,e,n){"use strict";var r=t("./_to-object"),i=t("./_to-absolute-index"),o=t("./_to-length");e.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);u>s;)e[s++]=t;return e}},{"./_to-absolute-index":87,"./_to-length":90,"./_to-object":91}],52:[function(t,e,n){var r=t("./_to-iobject"),i=t("./_to-length"),o=t("./_to-absolute-index");e.exports=function(t){return function(e,n,a){var s,c=r(e),u=i(c.length),d=o(a,u);if(t&&n!=n){for(;u>d;)if((s=c[d++])!=s)return!0}else for(;u>d;d++)if((t||d in c)&&c[d]===n)return t||d||0;return!t&&-1}}},{"./_to-absolute-index":87,"./_to-iobject":89,"./_to-length":90}],53:[function(t,e,n){var r=t("./_ctx"),i=t("./_iobject"),o=t("./_to-object"),a=t("./_to-length"),s=t("./_array-species-create");e.exports=function(t,e){var n=1==t,c=2==t,u=3==t,d=4==t,l=6==t,p=5==t||l,f=e||s;return function(e,s,g){for(var m,h,y=o(e),v=i(y),E=r(s,g,3),w=a(v.length),_=0,b=n?f(e,w):c?f(e,0):void 0;w>_;_++)if((p||_ in v)&&(m=v[_],h=E(m,_,y),t))if(n)b[_]=h;else if(h)switch(t){case 3:return!0;case 5:return m;case 6:return _;case 2:b.push(m)}else if(d)return!1;return l?-1:u||d?d:b}}},{"./_array-species-create":55,"./_ctx":58,"./_iobject":71,"./_to-length":90,"./_to-object":91}],54:[function(t,e,n){var r=t("./_is-object"),i=t("./_is-array"),o=t("./_wks")("species");e.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},{"./_is-array":72,"./_is-object":73,"./_wks":94}],55:[function(t,e,n){var r=t("./_array-species-constructor");e.exports=function(t,e){return new(r(t))(e)}},{"./_array-species-constructor":54}],56:[function(t,e,n){var r={}.toString;e.exports=function(t){return r.call(t).slice(8,-1)}},{}],57:[function(t,e,n){var r=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=r)},{}],58:[function(t,e,n){var r=t("./_a-function");e.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},{"./_a-function":48}],59:[function(t,e,n){e.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],60:[function(t,e,n){e.exports=!t("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":65}],61:[function(t,e,n){var r=t("./_is-object"),i=t("./_global").document,o=r(i)&&r(i.createElement);e.exports=function(t){return o?i.createElement(t):{}}},{"./_global":67,"./_is-object":73}],62:[function(t,e,n){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],63:[function(t,e,n){var r=t("./_global"),i=t("./_core"),o=t("./_hide"),a=t("./_redefine"),s=t("./_ctx"),c=function(t,e,n){var u,d,l,p,f=t&c.F,g=t&c.G,m=t&c.S,h=t&c.P,y=t&c.B,v=g?r:m?r[e]||(r[e]={}):(r[e]||{}).prototype,E=g?i:i[e]||(i[e]={}),w=E.prototype||(E.prototype={});g&&(n=e);for(u in n)d=!f&&v&&void 0!==v[u],l=(d?v:n)[u],p=y&&d?s(l,r):h&&"function"==typeof l?s(Function.call,l):l,v&&a(v,u,l,t&c.U),E[u]!=l&&o(E,u,p),h&&w[u]!=l&&(w[u]=l)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},{"./_core":57,"./_ctx":58,"./_global":67,"./_hide":69,"./_redefine":83}],64:[function(t,e,n){var r=t("./_wks")("match");e.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},{"./_wks":94}],65:[function(t,e,n){e.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],66:[function(t,e,n){e.exports=t("./_shared")("native-function-to-string",Function.toString)},{"./_shared":85}],67:[function(t,e,n){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],68:[function(t,e,n){var r={}.hasOwnProperty;e.exports=function(t,e){return r.call(t,e)}},{}],69:[function(t,e,n){var r=t("./_object-dp"),i=t("./_property-desc");e.exports=t("./_descriptors")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},{"./_descriptors":60,"./_object-dp":77,"./_property-desc":82}],70:[function(t,e,n){e.exports=!t("./_descriptors")&&!t("./_fails")(function(){return 7!=Object.defineProperty(t("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":60,"./_dom-create":61,"./_fails":65}],71:[function(t,e,n){var r=t("./_cof");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},{"./_cof":56}],72:[function(t,e,n){var r=t("./_cof");e.exports=Array.isArray||function(t){return"Array"==r(t)}},{"./_cof":56}],73:[function(t,e,n){e.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],74:[function(t,e,n){var r=t("./_is-object"),i=t("./_cof"),o=t("./_wks")("match");e.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},{"./_cof":56,"./_is-object":73,"./_wks":94}],75:[function(t,e,n){e.exports=!1},{}],76:[function(t,e,n){"use strict";var r=t("./_descriptors"),i=t("./_object-keys"),o=t("./_object-gops"),a=t("./_object-pie"),s=t("./_to-object"),c=t("./_iobject"),u=Object.assign;e.exports=!u||t("./_fails")(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=s(t),u=arguments.length,d=1,l=o.f,p=a.f;u>d;)for(var f,g=c(arguments[d++]),m=l?i(g).concat(l(g)):i(g),h=m.length,y=0;h>y;)f=m[y++],r&&!p.call(g,f)||(n[f]=g[f]);return n}:u},{"./_descriptors":60,"./_fails":65,"./_iobject":71,"./_object-gops":78,"./_object-keys":80,"./_object-pie":81,"./_to-object":91}],77:[function(t,e,n){var r=t("./_an-object"),i=t("./_ie8-dom-define"),o=t("./_to-primitive"),a=Object.defineProperty;n.f=t("./_descriptors")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},{"./_an-object":50,"./_descriptors":60,"./_ie8-dom-define":70,"./_to-primitive":92}],78:[function(t,e,n){n.f=Object.getOwnPropertySymbols},{}],79:[function(t,e,n){var r=t("./_has"),i=t("./_to-iobject"),o=t("./_array-includes")(!1),a=t("./_shared-key")("IE_PROTO");e.exports=function(t,e){var n,s=i(t),c=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~o(u,n)||u.push(n));return u}},{"./_array-includes":52,"./_has":68,"./_shared-key":84,"./_to-iobject":89}],80:[function(t,e,n){var r=t("./_object-keys-internal"),i=t("./_enum-bug-keys");e.exports=Object.keys||function(t){return r(t,i)}},{"./_enum-bug-keys":62,"./_object-keys-internal":79}],81:[function(t,e,n){n.f={}.propertyIsEnumerable},{}],82:[function(t,e,n){e.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},{}],83:[function(t,e,n){var r=t("./_global"),i=t("./_hide"),o=t("./_has"),a=t("./_uid")("src"),s=t("./_function-to-string"),c=(""+s).split("toString");t("./_core").inspectSource=function(t){return s.call(t)},(e.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},{"./_core":57,"./_function-to-string":66,"./_global":67,"./_has":68,"./_hide":69,"./_uid":93}],84:[function(t,e,n){var r=t("./_shared")("keys"),i=t("./_uid");e.exports=function(t){return r[t]||(r[t]=i(t))}},{"./_shared":85,"./_uid":93}],85:[function(t,e,n){var r=t("./_core"),i=t("./_global"),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:t("./_library")?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},{"./_core":57,"./_global":67,"./_library":75}],86:[function(t,e,n){var r=t("./_is-regexp"),i=t("./_defined");e.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},{"./_defined":59,"./_is-regexp":74}],87:[function(t,e,n){var r=t("./_to-integer"),i=Math.max,o=Math.min;e.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},{"./_to-integer":88}],88:[function(t,e,n){var r=Math.ceil,i=Math.floor;e.exports=function(t){return isNaN(t=+t)?0:(t>0?i:r)(t)}},{}],89:[function(t,e,n){var r=t("./_iobject"),i=t("./_defined");e.exports=function(t){return r(i(t))}},{"./_defined":59,"./_iobject":71}],90:[function(t,e,n){var r=t("./_to-integer"),i=Math.min;e.exports=function(t){return t>0?i(r(t),9007199254740991):0}},{"./_to-integer":88}],91:[function(t,e,n){var r=t("./_defined");e.exports=function(t){return Object(r(t))}},{"./_defined":59}],92:[function(t,e,n){var r=t("./_is-object");e.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":73}],93:[function(t,e,n){var r=0,i=Math.random();e.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+i).toString(36))}},{}],94:[function(t,e,n){var r=t("./_shared")("wks"),i=t("./_uid"),o=t("./_global").Symbol,a="function"==typeof o;(e.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},{"./_global":67,"./_shared":85,"./_uid":93}],95:[function(t,e,n){var r=t("./_export");r(r.P,"Array",{fill:t("./_array-fill")}),t("./_add-to-unscopables")("fill")},{"./_add-to-unscopables":49,"./_array-fill":51,"./_export":63}],96:[function(t,e,n){"use strict";var r=t("./_export"),i=t("./_array-methods")(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),t("./_add-to-unscopables")("find")},{"./_add-to-unscopables":49,"./_array-methods":53,"./_export":63}],97:[function(t,e,n){var r=t("./_export");r(r.S+r.F,"Object",{assign:t("./_object-assign")})},{"./_export":63,"./_object-assign":76}],98:[function(t,e,n){"use strict";var r=t("./_export"),i=t("./_to-length"),o=t("./_string-context"),a="".endsWith;r(r.P+r.F*t("./_fails-is-regexp")("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),c=String(t);return a?a.call(e,c,s):e.slice(s-c.length,s)===c}})},{"./_export":63,"./_fails-is-regexp":64,"./_string-context":86,"./_to-length":90}],99:[function(e,n,r){!function(e,i){"object"==typeof r?n.exports=r=i():"function"==typeof t&&t.amd?t([],i):e.CryptoJS=i()}(this,function(){var t=t||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),r={},i=r.lib={},o=i.Base=function(){return{extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=i.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var o=0;o<i;o+=4)e[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,r=[],i=0;i<e;i+=4){var o=function(e){var e=e,n=987654321,r=4294967295;return function(){n=36969*(65535&n)+(n>>16)&r,e=18e3*(65535&e)+(e>>16)&r;var i=(n<<16)+e&r;return i/=4294967296,(i+=.5)*(t.random()>.5?1:-1)}}(4294967296*(n||t.random()));n=987654071*o(),r.push(4294967296*o()|0)}return new a.init(r,e)}}),s=r.enc={},c=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new a.init(n,e/2)}},u=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new a.init(n,e)}},d=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=4*o,c=i/s;c=e?t.ceil(c):t.max((0|c)-this._minBufferSize,0);var u=c*o,d=t.min(4*u,i);if(u){for(var l=0;l<u;l+=o)this._doProcessBlock(r,l);var p=r.splice(0,u);n.sigBytes-=d}return new a.init(p,d)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),p=(i.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new p.HMAC.init(t,n).finalize(e)}}}),r.algo={});return r}(Math);return t})},{}],100:[function(e,n,r){!function(i,o){"object"==typeof r?n.exports=r=o(e("./core")):"function"==typeof t&&t.amd?t(["./core"],o):o(i.CryptoJS)}(this,function(t){return function(e){function n(t,e,n,r,i,o,a){var s=t+(e&n|~e&r)+i+a;return(s<<o|s>>>32-o)+e}function r(t,e,n,r,i,o,a){var s=t+(e&r|n&~r)+i+a;return(s<<o|s>>>32-o)+e}function i(t,e,n,r,i,o,a){var s=t+(e^n^r)+i+a;return(s<<o|s>>>32-o)+e}function o(t,e,n,r,i,o,a){var s=t+(n^(e|~r))+i+a;return(s<<o|s>>>32-o)+e}var a=t,s=a.lib,c=s.WordArray,u=s.Hasher,d=a.algo,l=[];!function(){for(var t=0;t<64;t++)l[t]=4294967296*e.abs(e.sin(t+1))|0}();var p=d.MD5=u.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var a=0;a<16;a++){var s=e+a,c=t[s];t[s]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var u=this._hash.words,d=t[e+0],p=t[e+1],f=t[e+2],g=t[e+3],m=t[e+4],h=t[e+5],y=t[e+6],v=t[e+7],E=t[e+8],w=t[e+9],_=t[e+10],b=t[e+11],I=t[e+12],P=t[e+13],T=t[e+14],D=t[e+15],O=u[0],C=u[1],S=u[2],A=u[3];O=n(O,C,S,A,d,7,l[0]),A=n(A,O,C,S,p,12,l[1]),S=n(S,A,O,C,f,17,l[2]),C=n(C,S,A,O,g,22,l[3]),O=n(O,C,S,A,m,7,l[4]),A=n(A,O,C,S,h,12,l[5]),S=n(S,A,O,C,y,17,l[6]),C=n(C,S,A,O,v,22,l[7]),O=n(O,C,S,A,E,7,l[8]),A=n(A,O,C,S,w,12,l[9]),S=n(S,A,O,C,_,17,l[10]),C=n(C,S,A,O,b,22,l[11]),O=n(O,C,S,A,I,7,l[12]),A=n(A,O,C,S,P,12,l[13]),S=n(S,A,O,C,T,17,l[14]),C=n(C,S,A,O,D,22,l[15]),O=r(O,C,S,A,p,5,l[16]),A=r(A,O,C,S,y,9,l[17]),S=r(S,A,O,C,b,14,l[18]),C=r(C,S,A,O,d,20,l[19]),O=r(O,C,S,A,h,5,l[20]),A=r(A,O,C,S,_,9,l[21]),S=r(S,A,O,C,D,14,l[22]),C=r(C,S,A,O,m,20,l[23]),O=r(O,C,S,A,w,5,l[24]),A=r(A,O,C,S,T,9,l[25]),S=r(S,A,O,C,g,14,l[26]),C=r(C,S,A,O,E,20,l[27]),O=r(O,C,S,A,P,5,l[28]),A=r(A,O,C,S,f,9,l[29]),S=r(S,A,O,C,v,14,l[30]),C=r(C,S,A,O,I,20,l[31]),O=i(O,C,S,A,h,4,l[32]),A=i(A,O,C,S,E,11,l[33]),S=i(S,A,O,C,b,16,l[34]),C=i(C,S,A,O,T,23,l[35]),O=i(O,C,S,A,p,4,l[36]),A=i(A,O,C,S,m,11,l[37]),S=i(S,A,O,C,v,16,l[38]),C=i(C,S,A,O,_,23,l[39]),O=i(O,C,S,A,P,4,l[40]),A=i(A,O,C,S,d,11,l[41]),S=i(S,A,O,C,g,16,l[42]),C=i(C,S,A,O,y,23,l[43]),O=i(O,C,S,A,w,4,l[44]),A=i(A,O,C,S,I,11,l[45]),S=i(S,A,O,C,D,16,l[46]),C=i(C,S,A,O,f,23,l[47]),O=o(O,C,S,A,d,6,l[48]),A=o(A,O,C,S,v,10,l[49]),S=o(S,A,O,C,T,15,l[50]),C=o(C,S,A,O,h,21,l[51]),O=o(O,C,S,A,I,6,l[52]),A=o(A,O,C,S,g,10,l[53]),S=o(S,A,O,C,_,15,l[54]),C=o(C,S,A,O,p,21,l[55]),O=o(O,C,S,A,E,6,l[56]),A=o(A,O,C,S,D,10,l[57]),S=o(S,A,O,C,y,15,l[58]),C=o(C,S,A,O,P,21,l[59]),O=o(O,C,S,A,m,6,l[60]),A=o(A,O,C,S,b,10,l[61]),S=o(S,A,O,C,f,15,l[62]),C=o(C,S,A,O,w,21,l[63]),u[0]=u[0]+O|0,u[1]=u[1]+C|0,u[2]=u[2]+S|0,u[3]=u[3]+A|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),a=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var d=c[u];c[u]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return s},clone:function(){var t=u.clone.call(this);return t._hash=this._hash.clone(),t}});a.MD5=u._createHelper(p),a.HmacMD5=u._createHmacHelper(p)}(Math),t.MD5})},{"./core":99}],101:[function(e,n,r){!function(i,o){"object"==typeof r?n.exports=r=o(e("./core")):"function"==typeof t&&t.amd?t(["./core"],o):o(i.CryptoJS)}(this,function(t){return function(e){var n=t,r=n.lib,i=r.WordArray,o=r.Hasher,a=n.algo,s=[],c=[];!function(){function t(t){return 4294967296*(t-(0|t))|0}for(var n=2,r=0;r<64;)(function(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0})(n)&&(r<8&&(s[r]=t(e.pow(n,.5))),c[r]=t(e.pow(n,1/3)),r++),n++}();var u=[],d=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],d=n[5],l=n[6],p=n[7],f=0;f<64;f++){if(f<16)u[f]=0|t[e+f];else{var g=u[f-15],m=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,h=u[f-2],y=(h<<15|h>>>17)^(h<<13|h>>>19)^h>>>10;u[f]=m+u[f-7]+y+u[f-16]}var v=s&d^~s&l,E=r&i^r&o^i&o,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),_=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),b=p+_+v+c[f]+u[f],I=w+E;p=l,l=d,d=s,s=a+b|0,a=o,o=i,i=r,r=b+I|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});n.SHA256=o._createHelper(d),n.HmacSHA256=o._createHmacHelper(d)}(Math),t.SHA256})},{"./core":99}],102:[function(e,n,r){!function(e){var i;if("function"==typeof t&&t.amd&&(t(e),i=!0),"object"==typeof r&&(n.exports=e(),i=!0),!i){var o=window.Cookies,a=window.Cookies=e();a.noConflict=function(){return window.Cookies=o,a}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(r){function i(){}function o(e,n,o){if("undefined"!=typeof document){o=t({path:"/"},i.defaults,o),"number"==typeof o.expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=e+"="+n+s}}function a(t,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(r.read||r)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(i[u]=c,t===u)break}catch(t){}}return t?i[t]:i}}return i.set=o,i.get=function(t){return a(t,!1)},i.getJSON=function(t){return a(t,!0)},i.remove=function(e,n){o(e,"",t(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}return n(function(){})})},{}],103:[function(e,n,r){!function(e,i){void 0!==r?void 0!==n&&n.exports&&(r=n.exports=i(e,r)):"function"==typeof t&&t.amd?t(["exports"],function(t){e.Lockr=i(e,t)}):e.Lockr=i(e,{})}(this,function(t,e){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1}),e.prefix="",e._getPrefixedKey=function(t,e){return e=e||{},e.noPrefix?t:this.prefix+t},e.set=function(t,e,n){var r=this._getPrefixedKey(t,n);try{localStorage.setItem(r,JSON.stringify({data:e}))}catch(n){console&&console.warn("Lockr didn't successfully save the '{"+t+": "+e+"}' pair, because the localStorage is full.")}},e.get=function(t,e,n){var r,i=this._getPrefixedKey(t,n);try{r=JSON.parse(localStorage.getItem(i))}catch(t){r=localStorage[i]?{data:localStorage.getItem(i)}:null}return r?"object"==typeof r&&void 0!==r.data?r.data:void 0:e},e.sadd=function(t,n,r){var i,o=this._getPrefixedKey(t,r),a=e.smembers(t);if(a.indexOf(n)>-1)return null;try{a.push(n),i=JSON.stringify({data:a}),localStorage.setItem(o,i)}catch(e){console.log(e),console&&console.warn("Lockr didn't successfully add the "+n+" to "+t+" set, because the localStorage is full.")}},e.smembers=function(t,e){var n,r=this._getPrefixedKey(t,e);try{n=JSON.parse(localStorage.getItem(r))}catch(t){n=null}return n&&n.data?n.data:[]},e.sismember=function(t,n,r){return e.smembers(t).indexOf(n)>-1},e.keys=function(){var t=[],n=Object.keys(localStorage);return 0===e.prefix.length?n:(n.forEach(function(n){-1!==n.indexOf(e.prefix)&&t.push(n.replace(e.prefix,""))}),t)},e.getAll=function(t){var n=e.keys();return t?n.reduce(function(t,n){var r={};return r[n]=e.get(n),t.push(r),t},[]):n.map(function(t){return e.get(t)})},e.srem=function(t,n,r){var i,o,a=this._getPrefixedKey(t,r),s=e.smembers(t,n);o=s.indexOf(n),o>-1&&s.splice(o,1),i=JSON.stringify({data:s});try{localStorage.setItem(a,i)}catch(e){console&&console.warn("Lockr couldn't remove the "+n+" from the set "+t)}},e.rm=function(t){var e=this._getPrefixedKey(t);localStorage.removeItem(e)},e.flush=function(){e.prefix.length?e.keys().forEach(function(t){localStorage.removeItem(e._getPrefixedKey(t))}):localStorage.clear()},e})},{}],104:[function(t,e,n){var r=t("./_root"),i=r.Symbol;e.exports=i},{"./_root":119}],105:[function(t,e,n){function r(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}e.exports=r},{}],106:[function(t,e,n){function r(t){return null==t?void 0===t?c:s:u&&u in Object(t)?o(t):a(t)}var i=t("./_Symbol"),o=t("./_getRawTag"),a=t("./_objectToString"),s="[object Null]",c="[object Undefined]",u=i?i.toStringTag:void 0;e.exports=r},{"./_Symbol":104,"./_getRawTag":114,"./_objectToString":117}],107:[function(t,e,n){function r(t){return!(!a(t)||o(t))&&(i(t)?g:u).test(s(t))}var i=t("./isFunction"),o=t("./_isMasked"),a=t("./isObject"),s=t("./_toSource"),c=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,d=Function.prototype,l=Object.prototype,p=d.toString,f=l.hasOwnProperty,g=RegExp("^"+p.call(f).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{"./_isMasked":116,"./_toSource":122,"./isFunction":125,"./isObject":126}],108:[function(t,e,n){function r(t,e){return a(o(t,e,i),t+"")}var i=t("./identity"),o=t("./_overRest"),a=t("./_setToString");e.exports=r},{"./_overRest":118,"./_setToString":120,"./identity":124}],109:[function(t,e,n){var r=t("./constant"),i=t("./_defineProperty"),o=t("./identity"),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;e.exports=a},{"./_defineProperty":111,"./constant":123,"./identity":124}],110:[function(t,e,n){var r=t("./_root"),i=r["__core-js_shared__"];e.exports=i},{"./_root":119}],111:[function(t,e,n){var r=t("./_getNative"),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.exports=i},{"./_getNative":113}],112:[function(t,e,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],113:[function(t,e,n){function r(t,e){var n=o(t,e);return i(n)?n:void 0}var i=t("./_baseIsNative"),o=t("./_getValue");e.exports=r},{"./_baseIsNative":107,"./_getValue":115}],114:[function(t,e,n){function r(t){var e=a.call(t,c),n=t[c];try{t[c]=void 0;var r=!0}catch(t){}var i=s.call(t);return r&&(e?t[c]=n:delete t[c]),i}var i=t("./_Symbol"),o=Object.prototype,a=o.hasOwnProperty,s=o.toString,c=i?i.toStringTag:void 0;e.exports=r},{"./_Symbol":104}],115:[function(t,e,n){function r(t,e){return null==t?void 0:t[e]}e.exports=r},{}],116:[function(t,e,n){function r(t){return!!o&&o in t}var i=t("./_coreJsData"),o=function(){var t=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();e.exports=r},{"./_coreJsData":110}],117:[function(t,e,n){function r(t){return o.call(t)}var i=Object.prototype,o=i.toString;e.exports=r},{}],118:[function(t,e,n){function r(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var r=arguments,a=-1,s=o(r.length-e,0),c=Array(s);++a<s;)c[a]=r[e+a];a=-1;for(var u=Array(e+1);++a<e;)u[a]=r[a];return u[e]=n(c),i(t,this,u)}}var i=t("./_apply"),o=Math.max;e.exports=r},{"./_apply":105}],119:[function(t,e,n){var r=t("./_freeGlobal"),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},{"./_freeGlobal":112}],120:[function(t,e,n){var r=t("./_baseSetToString"),i=t("./_shortOut"),o=i(r);e.exports=o},{"./_baseSetToString":109,"./_shortOut":121}],121:[function(t,e,n){function r(t){var e=0,n=0;return function(){var r=a(),s=o-(r-n);if(n=r,s>0){if(++e>=i)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var i=800,o=16,a=Date.now;e.exports=r},{}],122:[function(t,e,n){function r(t){if(null!=t){try{return o.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var i=Function.prototype,o=i.toString;e.exports=r},{}],123:[function(t,e,n){function r(t){return function(){return t}}e.exports=r},{}],124:[function(t,e,n){function r(t){return t}e.exports=r},{}],125:[function(t,e,n){function r(t){if(!o(t))return!1;var e=i(t);return e==s||e==c||e==a||e==u}var i=t("./_baseGetTag"),o=t("./isObject"),a="[object AsyncFunction]",s="[object Function]",c="[object GeneratorFunction]",u="[object Proxy]";e.exports=r},{"./_baseGetTag":106,"./isObject":126}],126:[function(t,e,n){function r(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}e.exports=r},{}],127:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function a(t){if(p===clearTimeout)return clearTimeout(t);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function s(){h&&g&&(h=!1,g.length?m=g.concat(m):y=-1,m.length&&c())}function c(){if(!h){var t=o(s);h=!0;for(var e=m.length;e;){for(g=m,m=[];++y<e;)g&&g[y].run();y=-1,e=m.length}g=null,h=!1,a(t)}}function u(t,e){this.fun=t,this.array=e}function d(){}var l,p,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(t){p=i}}();var g,m=[],h=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new u(t,e)),1!==m.length||h||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=d,f.addListener=d,f.once=d,f.off=d,f.removeListener=d,f.removeAllListeners=d,f.emit=d,f.prependListener=d,f.prependOnceListener=d,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],128:[function(e,n,r){(function(e,i){!function(e,i){"object"==typeof r&&void 0!==n?i():"function"==typeof t&&t.amd?t(i):i()}(0,function(){"use strict";function t(){}function n(t,e){return function(){t.apply(e,arguments)}}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function o(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?a:s)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)})}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof r)return t._state=3,t._value=e,void c(t);if("function"==typeof i)return void d(n(i,e),t)}t._state=1,t._value=e,c(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var l=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},p=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(e,n){var r=new this.constructor(t);return o(this,new u(e,n,r)),r},r.prototype.finally=l,r.all=function(t){return new r(function(e,n){function r(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(t,e)},n)}i[t]=a,0==--o&&e(i)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},r._immediateFn="function"==typeof i&&function(t){i(t)}||function(t){p(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var f=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();f.Promise?f.Promise.prototype.finally||(f.Promise.prototype.finally=l):f.Promise=r})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{timers:129}],129:[function(t,e,n){(function(e,r){function i(t,e){this._id=t,this._clearFn=e}var o=t("process/browser.js").nextTick,a=Function.prototype.apply,s=Array.prototype.slice,c={},u=0;n.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=u++,r=!(arguments.length<2)&&s.call(arguments,1);return c[e]=!0,o(function(){c[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete c[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":127,timers:129}],130:[function(e,n,r){!function(e,i){"use strict";var o="model",a="name",s="type",c="vendor",u="version",d="mobile",l="tablet",p={extend:function(t,e){var n={};for(var r in t)e[r]&&e[r].length%2==0?n[r]=e[r].concat(t[r]):n[r]=t[r];return n},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(t,e){for(var n,r,i,o,a,s,c=0;c<e.length&&!a;){var u=e[c],d=e[c+1];for(n=r=0;n<u.length&&!a;)if(a=u[n++].exec(t))for(i=0;i<d.length;i++)s=a[++r],o=d[i],"object"==typeof o&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,s):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=s?s.replace(o[1],o[2]):void 0:this[o[0]]=s?o[1].call(this,s,o[2]):void 0:4==o.length&&(this[o[0]]=s?o[3].call(this,s.replace(o[1],o[2])):void 0):this[o]=s||void 0;c+=2}},str:function(t,e){for(var n in e)if("object"==typeof e[n]&&e[n].length>0){for(var r=0;r<e[n].length;r++)if(p.has(e[n][r],t))return"?"===n?void 0:n}else if(p.has(e[n],t))return"?"===n?void 0:n;return t}},g={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},m={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,u],[/(opios)[\/\s]+([\w\.]+)/i],[[a,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[a,u],[/(konqueror)\/([\w\.]+)/i],[[a,"Konqueror"],u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],u],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[a,"Edge"],u],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],u],[/(puffin)\/([\w\.]+)/i],[[a,"Puffin"],u],[/(focus)\/([\w\.]+)/i],[[a,"Firefox Focus"],u],[/(opt)\/([\w\.]+)/i],[[a,"Opera Touch"],u],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[a,"UCBrowser"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],u],[/(windowswechat qbcore)\/([\w\.]+)/i],[[a,"WeChat(Win) Desktop"],u],[/(micromessenger)\/([\w\.]+)/i],[[a,"WeChat"],u],[/(brave)\/([\w\.]+)/i],[[a,"Brave"],u],[/(qqbrowserlite)\/([\w\.]+)/i],[a,u],[/(QQ)\/([\d\.]+)/i],[a,u],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[a,u],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[a,u],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[a,u],[/(MetaSr)[\/\s]?([\w\.]+)/i],[a],[/(LBBROWSER)/i],[a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[a,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[u,[a,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[a,u],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[u,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,/(.+)/,"$1 WebView"],u],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[a,/(.+(?:g|us))(.+)/,"$1 $2"],u],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[a,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[a,"Sailfish Browser"],u],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,u],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],u],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],u],[/(coast)\/([\w\.]+)/i],[[a,"Opera Coast"],u],[/fxios\/([\w\.-]+)/i],[u,[a,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,a],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[a,"GSA"],u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[u,f.str,g.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[a,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",p.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",p.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",p.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[o,c,[s,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[c,"Apple"],[s,l]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[c,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[c,o,[s,l]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[o,[c,"Amazon"],[s,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[o,f.str,g.device.amazon.model],[c,"Amazon"],[s,d]],[/android.+aft([bms])\sbuild/i],[o,[c,"Amazon"],[s,"smarttv"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,c,[s,d]],[/\((ip[honed|\s\w*]+);/i],[o,[c,"Apple"],[s,d]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[c,o,[s,d]],[/\(bb10;\s(\w+)/i],[o,[c,"BlackBerry"],[s,d]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[o,[c,"Asus"],[s,l]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[c,"Sony"],[o,"Xperia Tablet"],[s,l]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[c,"Sony"],[s,d]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[c,o,[s,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[c,"Nvidia"],[s,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[c,"Sony"],[s,"console"]],[/(sprint\s(\w+))/i],[[c,f.str,g.device.sprint.vendor],[o,f.str,g.device.sprint.model],[s,d]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[c,[o,/_/g," "],[s,d]],[/(nexus\s9)/i],[o,[c,"HTC"],[s,l]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[o,[c,"Huawei"],[s,d]],[/(microsoft);\s(lumia[\s\w]+)/i],[c,o,[s,d]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[c,"Microsoft"],[s,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[c,"Microsoft"],[s,d]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[c,"Motorola"],[s,d]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[c,"Motorola"],[s,l]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[c,p.trim],[o,p.trim],[s,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[c,"Samsung"],[s,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[o,[c,"Sharp"],[s,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[c,"Samsung"],o,[s,l]],[/smart-tv.+(samsung)/i],[c,[s,"smarttv"],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[c,"Samsung"],o,[s,d]],[/sie-(\w*)/i],[o,[c,"Siemens"],[s,d]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[c,"Nokia"],o,[s,d]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[c,"Acer"],[s,l]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[c,"LG"],[s,l]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[c,"LG"],o,[s,l]],[/(lg) netcast\.tv/i],[c,o,[s,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[c,"LG"],[s,d]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[c,o,[s,l]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[c,"Lenovo"],[s,l]],[/(lenovo)[_\s-]?([\w-]+)/i],[c,o,[s,d]],[/linux;.+((jolla));/i],[c,o,[s,d]],[/((pebble))app\/[\d\.]+\s/i],[c,o,[s,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[c,o,[s,d]],[/crkey/i],[[o,"Chromecast"],[c,"Google"]],[/android.+;\s(glass)\s\d/i],[o,[c,"Google"],[s,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[o,[c,"Google"],[s,l]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[o,[c,"Google"],[s,d]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[c,"Xiaomi"],[s,d]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[c,"Xiaomi"],[s,l]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[c,"Meizu"],[s,d]],[/(mz)-([\w-]{2,})/i],[[c,"Meizu"],o,[s,d]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[o,[c,"OnePlus"],[s,d]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[c,"RCA"],[s,l]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[o,[c,"Dell"],[s,l]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[c,"Verizon"],[s,l]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[c,"Barnes & Noble"],o,[s,l]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[c,"NuVision"],[s,l]],[/android.+;\s(k88)\sbuild/i],[o,[c,"ZTE"],[s,l]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[c,"Swiss"],[s,d]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[c,"Swiss"],[s,l]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[c,"Zeki"],[s,l]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[c,"Dragon Touch"],o,[s,l]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[c,"Insignia"],[s,l]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[c,"NextBook"],[s,l]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[c,"Voice"],o,[s,d]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[c,"LvTel"],o,[s,d]],[/android.+;\s(PH-1)\s/i],[o,[c,"Essential"],[s,d]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[c,"Envizen"],[s,l]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[c,o,[s,l]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[c,"MachSpeed"],[s,l]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[c,o,[s,l]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[c,"Rotor"],[s,l]],[/android.+(KS(.+))\s+build/i],[o,[c,"Amazon"],[s,l]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[c,o,[s,l]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[s,p.lowerize],c,o],[/[\s\/\(](smart-?tv)[;\)]/i],[[s,"smarttv"]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[c,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[a,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,u],[/rv\:([\w\.]{1,9}).+(gecko)/i],[u,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[u,f.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[u,f.str,g.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[a,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[a,"Symbian"],u],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[a,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],u],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[a,u],[/(haiku)\s(\w+)/i],[a,u],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[u,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[a,u]]},h=function(t,n){if("object"==typeof t&&(n=t,t=void 0),!(this instanceof h))return new h(t,n).getResult();var r=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),i=n?p.extend(m,n):m;return this.getBrowser=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,r,i.browser),t.major=p.major(t.version),t},this.getCPU=function(){var t={architecture:void 0};return f.rgx.call(t,r,i.cpu),t},this.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return f.rgx.call(t,r,i.device),t},this.getEngine=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,r,i.engine),t},this.getOS=function(){var t={name:void 0,version:void 0};return f.rgx.call(t,r,i.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(t){return r=t,this},this};h.VERSION="0.7.20",h.BROWSER={NAME:a,MAJOR:"major",VERSION:u},h.CPU={ARCHITECTURE:"architecture"},h.DEVICE={MODEL:o,VENDOR:c,TYPE:s,CONSOLE:"console",MOBILE:d,SMARTTV:"smarttv",TABLET:l,WEARABLE:"wearable",EMBEDDED:"embedded"},h.ENGINE={NAME:a,VERSION:u},h.OS={NAME:a,VERSION:u},void 0!==r?(void 0!==n&&n.exports&&(r=n.exports=h),r.UAParser=h):"function"==typeof t&&t.amd?t(function(){return h}):e&&(e.UAParser=h);var y=e&&(e.jQuery||e.Zepto);if(void 0!==y&&!y.ua){var v=new h;y.ua=v.getResult(),y.ua.get=function(){return v.getUA()},y.ua.set=function(t){v.setUA(t);var e=v.getResult();for(var n in e)y.ua[n]=e[n]}}}("object"==typeof window?window:this)},{}],131:[function(t,e,n){function r(t,e){var n=e||0,r=i;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}for(var i=[],o=0;o<256;++o)i[o]=(o+256).toString(16).substr(1);e.exports=r},{}],132:[function(t,e,n){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);e.exports=function(){return r(i),i}}else{var o=new Array(16);e.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},{}],133:[function(t,e,n){function r(t,e,n){var r=e&&n||0,d=e||[];t=t||{};var l=t.node||i,p=void 0!==t.clockseq?t.clockseq:o;if(null==l||null==p){var f=a();null==l&&(l=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var g=void 0!==t.msecs?t.msecs:(new Date).getTime(),m=void 0!==t.nsecs?t.nsecs:u+1,h=g-c+(m-u)/1e4;if(h<0&&void 0===t.clockseq&&(p=p+1&16383),(h<0||g>c)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=g,u=m,o=p,g+=122192928e5;var y=(1e4*(268435455&g)+m)%4294967296;d[r++]=y>>>24&255,d[r++]=y>>>16&255,d[r++]=y>>>8&255,d[r++]=255&y;var v=g/4294967296*1e4&268435455;d[r++]=v>>>8&255,d[r++]=255&v,d[r++]=v>>>24&15|16,d[r++]=v>>>16&255,d[r++]=p>>>8|128,d[r++]=255&p;for(var E=0;E<6;++E)d[r+E]=l[E];return e||s(d)}var i,o,a=t("./lib/rng"),s=t("./lib/bytesToUuid"),c=0,u=0;e.exports=r},{"./lib/bytesToUuid":131,"./lib/rng":132}],134:[function(t,e,n){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader,n=a(e);return e.readAsArrayBuffer(t),n}function c(t){var e=new FileReader,n=a(e);return e.readAsText(t),n}function u(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function d(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(y.arrayBuffer&&y.blob&&E(t))this._bodyArrayBuffer=d(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!w(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return c(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(t){var e=t.toUpperCase();return _.indexOf(e)>-1?e:t}function f(t,e){e=e||{};var n=e.body;if(t instanceof f){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=p(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function g(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function m(t){var e=new i;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function h(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(y.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=function(t){return t&&DataView.prototype.isPrototypeOf(t)},w=ArrayBuffer.isView||function(t){return t&&v.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,r){t=e(t),r=n(r);var i=this.map[t];this.map[t]=i?i+","+r:r},i.prototype.delete=function(t){delete this.map[e(t)]},i.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},i.prototype.set=function(t,r){this.map[e(t)]=n(r)},i.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},l.call(f.prototype),l.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},h.error=function(){var t=new h(null,{status:0,statusText:""});return t.type="error",t};var b=[301,302,303,307,308];h.redirect=function(t,e){if(-1===b.indexOf(e))throw new RangeError("Invalid status code");return new h(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=f,t.Response=h,t.fetch=function(t,e){return new Promise(function(n,r){var i=new f(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new h(e,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&y.blob&&(o.responseType="blob"),i.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],135:[function(t,e,n){"use strict";n.__esModule=!0,n.CONSENT_NAME=n.COOKIE_CONSENT_OPTOUT=n.COOKIE_CONSENT_OPTIN=n.COOKIE_CONSENT_INFO=n.COOKIE_CONSENT_NONE=void 0;var r=t("@segmentstream/utils/eventListener"),i=t("./constants"),o=n.COOKIE_CONSENT_NONE="none",a=n.COOKIE_CONSENT_INFO="info",s=(n.COOKIE_CONSENT_OPTIN="optin",n.COOKIE_CONSENT_OPTOUT="optout"),c=n.CONSENT_NAME="cookieConsent",u=["mousemove","click","keydown","scroll","wheel","touchstart"],d=void 0,l=void 0,p=void 0,f=function(){return l.get(c)},g=function(t){d.changes.push([c,t,i.SDK_CHANGE_SOURCE]),l.persist(c)};n.default={initialize:function(t,e,n){if(p=t,d=e,l=n,!f()){var i=function t(){g(!0),u.forEach(function(e){(0,r.unbind)(window,e,t)})};t===a&&u.forEach(function(t){(0,r.bind)(window,t,i)})}},setConsent:g,getConsent:f,isConsentObtained:function(){if(p===o)return!0;var t=f();return p===s?!1!==t:!!t}}},{"./constants":149,"@segmentstream/utils/eventListener":9}],136:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var o=t("js-cookie"),a=r(o),s=t("@segmentstream/utils/topDomain"),c=r(s),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.options=Object.assign({cookieDomain:(0,c.default)(window.location.href),cookieMaxAge:31536e3,prefix:""},e),this.getOption("cookieDomain")&&(this.set("__tld__",!0),this.get("__tld__")||this.setOption("cookieDomain",null),this.remove("__tld__"))}return t.prototype.supportsSubDomains=function(){return!0},t.prototype.set=function(t,e,n){t=this.getOption("prefix")+t,n=n||this.getOption("cookieMaxAge");var r=n/86400;return a.default.set(t,e,{expires:r,domain:this.getOption("cookieDomain")})},t.prototype.get=function(t){return t=this.getOption("prefix")+t,a.default.getJSON(t)},t.prototype.remove=function(t){t=this.getOption("prefix")+t,a.default.remove(t,{domain:this.getOption("cookieDomain")})},t.prototype.getOption=function(t){return this.options[t]},t.prototype.setOption=function(t,e){this.options[t]=e},t.prototype.clear=function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e+=1){var n=t[e],r=n.indexOf("="),i=r>-1?n.substr(0,r):n;document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}},t}();n.default=u},{"@segmentstream/utils/topDomain":37,"js-cookie":102}],137:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return e.id&&String(e.id)===String(t)}function a(t,e){return e.skuCode&&String(e.skuCode)===String(t)}function s(t,e,n){return(!e||a(e,n))&&o(t,n)}n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("@segmentstream/utils/clone"),d=r(u),l=t("@segmentstream/utils/deleteProperty"),p=r(l),f=function(){function t(){i(this,t)}return t.get=function(t,e){var n=(0,c.getProp)(e,t);return(0,d.default)(n)},t.set=function(t,e,n){(0,c.setProp)(n,t,(0,d.default)(e))},t.replace=function(e,n){Object.keys(n).forEach(function(t){["changes","events","version","context","user","cart","website"].indexOf(t)<0&&(0,p.default)(n,t)}),Object.keys(e).forEach(function(r){["changes","events"].indexOf(r)<0&&t.set(r,e[r],n)}),n.changes.length=0,0===n.events.filter(function(t){return!t.hasFired}).length&&(n.events.length=0)},t.getProduct=function(t,e,n){if(n.product&&String(n.product.id)===String(t))return(0,d.default)(n.product);var r=void 0;return["listing","recommendation","wishlist"].some(function(i){var o=n[i];return o&&(Array.isArray(o)||(o=[o]),o.some(function(n){return!!(n.items&&n.items.length&&(n.items.some(function(n){return!!s(t,e,n)&&(r=(0,d.default)(n),!0)}),r))})),!!r}),r||(n.cart&&n.cart.lineItems&&n.cart.lineItems.length&&n.cart.lineItems.some(function(n){return!!s(t,e,n.product)&&(r=(0,d.default)(n.product),!0)}),r)},t.getListItem=function(t,e,n){var r=void 0;return["listing","recommendation","wishlist"].some(function(i){var a=e[i];return!(!a||(Array.isArray(a)||(a=[a]),a.some(function(e){if(e.items&&e.items.length&&(!n||n===e.listId))for(var i=0,a=e.items.length;i<a;i+=1)if(o(t,e.items[i])){var s=(0,d.default)(e.items[i]);return r={},r.product=s,r.position=i+1,r.listId=n||e.listId,r.listName=e.listName,!0}return!1}),!r))}),r},t.getCampaign=function(t,e){var n=void 0;return e.campaigns&&e.campaigns.length&&e.campaigns.some(function(e){return!(!e.id||String(e.id)!==String(t))&&(n=(0,d.default)(e),!0)}),n},t}();n.default=f},{"@segmentstream/utils/clone":4,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],138:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=t("@segmentstream/utils/dotProp"),o=t("@segmentstream/utils/arrayMerge"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e,n,i){r(this,t),this.digitalData=e,this.storage=n,i&&(this.ddReserveStorage=new t(e,i),i.supportsSubDomains()||this.transferFromReserveStorage())}return t.prototype.transferFromReserveStorage=function(){var t=this;this.ddReserveStorage.getLastEventTimestamp()&&(this.ddReserveStorage.getLastEventTimestamp()>this.getLastEventTimestamp()?this.setLastEventTimestamp(this.ddReserveStorage.getLastEventTimestamp()):this.ddReserveStorage.removeLastEventTimestamp(),this.ddReserveStorage.getPersistedKeys().forEach(function(e){var n=t.get(e),r=t.ddReserveStorage.getTtl(e);void 0!==n&&t.storage.set(e,n,r),t.ddReserveStorage.getStorage().remove(e)}),this.updatePersistedKeys(this.getPersistedKeys()),this.ddReserveStorage.clearPersistedKeys())},t.prototype.getStorage=function(){return this.storage},t.prototype.getTtl=function(t){if(this.getStorage().getTtl)return this.getStorage().getTtl(t)},t.prototype.persist=function(t,e){var n=(0,i.getProp)(this.digitalData,t);void 0!==n&&(this.addPersistedKey(t),this.storage.set(t,n,e),this.ddReserveStorage&&this.ddReserveStorage.unpersist(t))},t.prototype.getPersistedKeys=function(){var t=this.storage.get("_persistedKeys")||[];if(this.ddReserveStorage){var e=this.ddReserveStorage.getPersistedKeys();(0,a.default)(t,e)}return t},t.prototype.addPersistedKey=function(t){var e=this.getPersistedKeys();e.indexOf(t)<0&&(e.push(t),this.updatePersistedKeys(e))},t.prototype.removePersistedKey=function(t){var e=this.getPersistedKeys(),n=e.indexOf(t);n>-1&&e.splice(n,1),this.updatePersistedKeys(e)},t.prototype.getLastEventTimestamp=function(){return this.storage.get("_lastEventTimestamp")},t.prototype.removeLastEventTimestamp=function(){this.storage.remove("_lastEventTimestamp")},t.prototype.setLastEventTimestamp=function(t){return this.ddReserveStorage&&this.ddReserveStorage.removeLastEventTimestamp(),this.storage.set("_lastEventTimestamp",t)},t.prototype.updatePersistedKeys=function(t){Array.isArray(t)&&t.length>0?this.storage.set("_persistedKeys",t):this.storage.remove("_persistedKeys")},t.prototype.clearPersistedKeys=function(){this.storage.remove("_persistedKeys")},t.prototype.get=function(t){var e=this.storage.get(t);return void 0===e&&this.ddReserveStorage&&(e=this.ddReserveStorage.get(t)),void 0===e&&this.removePersistedKey(t),e},t.prototype.unpersist=function(t){return this.ddReserveStorage&&this.ddReserveStorage.unpersist(t),this.removePersistedKey(t),this.storage.remove(t)},t.prototype.clear=function(){var t=this;this.ddReserveStorage&&this.ddReserveStorage.clear(),this.getPersistedKeys().forEach(function(e){t.storage.remove(e)}),this.storage.remove("_persistedKeys"),this.storage.remove("_lastEventTimestamp")},t}();n.default=s},{"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/dotProp":7}],139:[function(t,e,n){"use strict";function r(t){if(!i){var e=window.onerror;window.onerror=function(n,r,i,o,a){var s=n;return a&&void 0!==a.message&&(s=a.message),s+=" @ "+r+":"+i+":"+o,t.events.push({name:"Exception",category:"JS Errors",exception:{message:String(n),description:s,lineNumber:i,columnNumber:o,isFatal:!0}}),"function"==typeof e&&e(n,r,i,o,a)},i=!0}}n.__esModule=!0,n.enableErrorTracking=r;var i=!1},{}],140:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){var e=Object.assign({},t);return(0,l.default)(e,"events"),(0,l.default)(e,"changes"),(0,u.default)(e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(t){return void 0===t?"undefined":a(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":a(t)},c=t("@segmentstream/utils/clone"),u=r(c),d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/size"),f=r(p),g=t("@segmentstream/utils/after"),m=r(g),h=t("@segmentstream/utils/jsonIsEqual"),y=r(h),v=t("@segmentstream/utils/safeConsole"),E=t("@segmentstream/utils/cleanObject"),w=r(E),_=t("./DDHelper"),b=r(_),I=t("./enrichments/EventDataEnricher"),P=r(I),T=t("./events/CustomEvent"),D=r(T),O=t("./events/semanticEvents"),C=t("./constants"),S={},A=[],k={},R={},V=void 0,N=!1,L=!1,M=[],j=function(){function t(e,n){i(this,t),R=e||R,Array.isArray(R.events)||(R.events=[]),Array.isArray(R.changes)||(R.changes=[]),A=n||A,k=o(R)}return t.prototype.import=function(t){var e=this;t=t||[],t.forEach(function(t){var n=new D.default(t.name,t.trigger,(0,w.default)({event:t.event,selector:t.selector,followLink:t.followLink,scrollDepth:t.scrollDepth,seconds:t.seconds}),t.handler,R,e);M.push(n)})},t.prototype.addEvent=function(t,e,n,r){var i=new D.default(t,e,n,r,R,this);M.push(i)},t.prototype.initialize=function(){var t=this,e=R,n=e.events;M.forEach(function(t){t.track()}),this.addEarlyCallbacks(),this.fireDefine(),A.push=function(e){t.addCallback(e),A[A.length]=e},this.applyEarlyChanges(),this.enableChangesTracking(),this.isViewedPageSent()?(this.fireViewedPageEvent(),this.enableEventsTracking(),this.fireUnfiredEvents()):L&&!this.isViewedPageSent()?(this.addViewedPageEvent(),this.enableEventsTracking(),this.fireUnfiredEvents()):n.push=function(e){e.name===O.VIEWED_PAGE?(t.addViewedPageEvent(e),t.enableEventsTracking(),t.fireUnfiredEvents()):n[n.length]=e},N=!0},t.prototype.enableEventsTracking=function(){var t=this,e=R,n=e.events;n.push=function(e){n[n.length]=e,t.fireEvent(e)}},t.prototype.enableChangesTracking=function(){var t=this,e=R,n=e.changes;n.push=function(e){n[n.length]=e,t.applyChange(e)},V=setInterval(function(){t.fireDefine(),t.checkForChanges()},100)},t.prototype.setSendViewedPageEvent=function(t){L=t},t.prototype.getSendViewedPageEvent=function(){return L},t.prototype.checkForChanges=function(){if(S.change&&S.change.length>0||S.define&&S.define.length>0){var t=o(R);if(!(0,y.default)(k,t)){var e=o(k);k=(0,u.default)(t),this.fireDefine(),this.fireChange(t,e)}}},t.prototype.addCallback=function(t,e){if(!1!==e&&(e=!0),Array.isArray(t)&&!(t.length<2))if("on"===t[0]){if(t.length<3)return;var n=t[2];this.on(t[1],n,e)}else t[0]},t.prototype.isViewedPageSent=function(){return R.events.some(function(t){return t.name===O.VIEWED_PAGE})},t.prototype.addViewedPageEvent=function(t){t||(t={name:O.VIEWED_PAGE,source:C.SDK_EVENT_SOURCE}),R.events.unshift(t)},t.prototype.fireDefine=function(){S.define&&S.define.length>0&&S.define.forEach(function(t){var e=void 0;if(t.key){var n=t.key;e=b.default.get(n,R)}else e=R;if(void 0!==e){try{t.handler(e)}catch(t){(0,v.error)(t)}S.define.splice(S.define.indexOf(t),1)}})},t.prototype.fireChange=function(t,e){var n=function(t,e,n){try{t(e,n)}catch(t){(0,v.error)(t)}};S.change&&S.change.length>0&&S.change.forEach(function(r){if(r.key){var i=r.key,o=b.default.get(i,t),a=b.default.get(i,e);(0,y.default)(o,a)||n(r.handler,o,a)}else n(r.handler,t,e)})},t.prototype.applyEarlyChanges=function(){var t=this;R.changes.forEach(function(e){t.applyChange(e)})},t.prototype.applyChange=function(t){if(Array.isArray(t)){var e=t[0],n=t[1];b.default.set(e,n,R)}else"object"===(void 0===t?"undefined":s(t))&&b.default.replace(t,R)},t.prototype.beforeFireEvent=function(t){if(!S.beforeEvent)return!0;var e=!0;return S.beforeEvent.forEach(function(n){!1===n.handler(t)&&(e=!1)}),e},t.prototype.fireEvent=function(t){var e=this;if(t.timestamp||(t.timestamp=Date.now()),this.beforeFireEvent(t)){if(S.event){var n=[],r=[],i=(0,m.default)((0,f.default)(S.event),function(){"function"==typeof t.callback&&t.callback(n,r)}),o=function(t,e){void 0!==e&&n.push(e),t&&r.push(t),i()};S.event.forEach(function(n){var r=(0,u.default)(t,!0);(0,l.default)(r,"callback"),!1!==r.enrichEventData&&(r=e.enrichEventWithData(r));try{var i=n.handler(r);o(null,i)}catch(t){o(t),(0,v.error)(t)}})}else"function"==typeof t.callback&&t.callback();t.hasFired=!0}},t.prototype.on=function(t,e,n){var r=t.split(":"),i=r[0],o=r[1];S[i]=S[i]||[],S[i].push({key:o,handler:e}),N&&"event"===i&&n&&this.applyCallbackForPastEvents(e)},t.prototype.applyCallbackForPastEvents=function(t){var e=this;R.events.forEach(function(n){if(n.hasFired){var r=(0,u.default)(n,!0);(0,l.default)(r,"callback"),!1!==r.enrichEventData&&(r=e.enrichEventWithData(r));try{t(r)}catch(t){(0,v.error)(t)}}})},t.prototype.fireViewedPageEvent=function(){var t=R.events.find(function(t){return t.name===O.VIEWED_PAGE});this.fireEvent(t)},t.prototype.fireUnfiredEvents=function(){var t=this;R.events.forEach(function(e){e.hasFired||t.fireEvent(e)})},t.prototype.addEarlyCallbacks=function(){var t=this;A.forEach(function(e){t.addCallback(e)})},t.prototype.enrichEventWithData=function(t){return P.default.enrichCommonData(t,R)},t.prototype.reset=function(){for(clearInterval(V);A.length;)A.pop();for(;R.changes.length;)R.changes.pop();A.push=Array.prototype.push,R.changes.push=Array.prototype.push,S={},L=!1},t}();n.default=j},{"./DDHelper":137,"./constants":149,"./enrichments/EventDataEnricher":155,"./events/CustomEvent":157,"./events/semanticEvents":158,"@segmentstream/utils/after":1,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/clone":4,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/jsonIsEqual":23,"@segmentstream/utils/safeConsole":33,"@segmentstream/utils/size":36}],141:[function(t,e,n){"use strict";function r(t,e){var n=e.getEventValidationConfig(t);return n?E(t,n):[!0]}function i(t,e,n){(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).forEach(function(r){var i=r[0],o=r[1];r[3]===s&&t.events.push({name:"Integration Validation Failed",category:"DDM Validations",label:e.name+" ("+n+")",action:"Field '"+i+"' "+o,nonInteraction:!0})})}n.__esModule=!0,n.validateEvent=n.TYPE_SUCCESS=n.TYPE_WARNING=n.TYPE_ERROR=void 0;var o;n.validateIntegrationEvent=r,n.trackValidationErrors=i;var a=t("@segmentstream/utils/dotProp"),s=n.TYPE_ERROR="ERR",c=n.TYPE_WARNING="WARN",u=n.TYPE_SUCCESS="OK",d=function(t){return void 0===t||null===t||""===t},l=function(t){return!d(t)||"is required"},p=function(t){return d(t)?null:"string"==typeof t||"should be a string"},f=function(t){return d(t)?null:"number"==typeof t||"should be numeric"},g=function(t){return d(t)?null:!!Array.isArray(t)||"should be an array"},m=function(t){return d(t)?null:"boolean"==typeof t||"shoule be boolean"},h=(o={},o.required=l,o.string=p,o.numeric=f,o.array=g,o.boolean=m,o),y=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.errors||[],i=n.warnings||[],o=0,a=r.length;o<a;o+=1){var l=r[o],p=h[l](e);if(!d(p)&&!0!==p)return[!1,[t,p,e,s]]}for(var f=0,g=i.length;f<g;f+=1){var m=i[f],y=h[m](e);if(!d(y)&&!0!==y)return[!0,[t,y,e,c]]}return d(e)?[!0]:[!0,[t,!0,e,u]]},v=function(t,e,n,r){var i=[],o=!0;if(Array.isArray(e)){var s=0;e.forEach(function(e){var c=(0,a.getProp)(e,n),u=[t,s,n].join("."),d=y(u,c,r),l=d[0],p=d[1];l||(o=!1),p&&i.push(p),s+=1})}else{var c=[t,n].join("[]."),u=y(c,void 0,r),d=u[0],l=u[1];l&&i.push(l),o=d}return[o,i]},E=n.validateEvent=function(t,e){var n=e.fields||[],r=[],i=!0;return n.forEach(function(n){var o=e.validations||{},s=o[n];if(n.indexOf("[]")>0){var c=n.split("[]."),u=c[0],d=c[1],l=(0,a.getProp)(t,u),p=v(u,l,d,s),f=p[0],g=p[1];r=r.concat(g),f||(i=!1)}else{var m=(0,a.getProp)(t,n),h=y(n,m,s),E=h[0],w=h[1];w&&r.push(w),E||(i=!1)}}),[i,r]}},{"@segmentstream/utils/dotProp":7}],142:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var o=t("@segmentstream/utils/getQueryParam"),a=r(o),s=t("js-cookie"),c=r(s),u=t("@segmentstream/utils/domQuery"),d=r(u),l=t("@segmentstream/utils/loadScript"),p=r(l),f=t("@segmentstream/utils/loadLink"),g=r(f),m=t("@segmentstream/utils/loadIframe"),h=r(m),y=t("@segmentstream/utils/loadPixel"),v=r(y),E=t("@segmentstream/utils/dotProp"),w=t("@segmentstream/utils/getDataLayerProp"),_=r(w),b=t("./DDHelper"),I=r(b),P=t("./RollingAttributesHelper"),T=t("./helpers/ValidationHelper"),D=function(){function t(e,n,r){var o=this;i(this,t),this.handler=e,this.args=r,this.utils={counterInc:function(t,e,r){return(0,P.counterInc)(t,e,r,n)},counter:function(t){return(0,P.counter)(t,n)},validate:function(t,e,n){return(0,T.validate)(t,e,n)},queryParam:a.default,cookie:c.default.get,get:function(t,e){return(0,E.getProp)(t,e)},digitalData:function(t){return I.default.get(t,n)},domQuery:function(t){return window.jQuery?window.jQuery(t).get():(0,d.default)(t)},global:function(t){return(0,E.getProp)(window,t)},dataLayer:_.default,fetch:function(t,e,n){return n||(n=e,e=void 0),new Promise(function(r){window.fetch(t,e).then(function(t){return t.text()}).then(function(t){try{t=JSON.parse(t)}catch(t){}r(n(t))})})},timeout:function(t,e){return new Promise(function(n){setTimeout(function(){n(e())},t)})},retry:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;try{e>0&&t()}catch(r){setTimeout(function(){o.utils.retry(t,e-1)},n)}},loadPixel:v.default,loadScript:p.default,loadIframe:h.default,loadLink:g.default}}return t.prototype.run=function(){return this.handler.bind(this.utils).apply(void 0,this.args)},t}();n.default=D},{"./DDHelper":137,"./RollingAttributesHelper":146,"./helpers/ValidationHelper":159,"@segmentstream/utils/domQuery":6,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getDataLayerProp":11,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/loadIframe":24,"@segmentstream/utils/loadLink":25,"@segmentstream/utils/loadPixel":26,"@segmentstream/utils/loadScript":27,"js-cookie":102}],143:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(t){return void 0===t?"undefined":s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":s(t)},u=t("@segmentstream/utils/loadScript"),d=r(u),l=t("@segmentstream/utils/loadLink"),p=r(l),f=t("@segmentstream/utils/loadIframe"),g=r(f),m=t("@segmentstream/utils/loadPixel"),h=r(m),y=t("@segmentstream/utils/format"),v=r(y),E=t("@segmentstream/utils/clone"),w=r(E),_=t("@segmentstream/utils/noop"),b=r(_),I=t("@segmentstream/utils/log"),P=r(I),T=t("@segmentstream/utils/deleteProperty"),D=r(T),O=t("@segmentstream/utils/safeConsole"),C=t("@segmentstream/utils/each"),S=r(C),A=t("async/nextTick"),k=r(A),R=t("component-emitter"),V=r(R),N=function(t){function e(n,r,a){i(this,e);var s=o(this,t.call(this));return s.options=r||{},s.overrideFunctions={},r&&r.overrideFunctions&&s.defineOverrideFunctions(r.overrideFunctions),s.digitalData=n,s.tags=a||{},s.onLoad=s.onLoad.bind(s),s._isEnriched=!1,s._isInitialized=!1,s._productOverrideErrorFired=!1,s.overrideOptions(),s}return a(e,t),e.prototype.defineOverrideFunctions=function(t){var e=this;t.event&&(this.overrideFunctions.event=function(n){try{t.event.bind(e)(n)}catch(t){(0,P.default)("function override error for event "+n.name+" in integration "+e.getName()+": "+t,P.default.ERROR)}}),t.product&&(this.overrideFunctions.product=function(n){try{t.product.bind(e)(n)}catch(t){e._productOverrideErrorFired||((0,P.default)("function override error for product in integration "+e.getName()+": "+t,P.default.ERROR),e._productOverrideErrorFired=!0)}}),t.options&&(this.overrideFunctions.options=function(n){try{t.options.bind(e)(n)}catch(t){(0,P.default)("function override error for options of integration "+e.getName()+": "+t,P.default.ERROR)}})},e.prototype.getProductOverrideFunction=function(){return this.overrideFunctions.product},e.prototype.getEventOverrideFunction=function(){return this.overrideFunctions.event},e.prototype.getOptionsOverrideFunction=function(){return this.overrideFunctions.options},e.prototype.overrideOptions=function(){var t=this.getOptionsOverrideFunction();t&&t(this.options)},e.prototype.getEventEnrichments=function(){return this.getOption("eventEnrichments")||[]},e.prototype.setName=function(t){this.name=t},e.prototype.getName=function(){return this.name},e.prototype.initialize=function(){var t=this.onLoad;this._isLoaded=!0,(0,k.default)(t)},e.prototype.load=function(t,e,n){var r=this,i=!1,o=function(){i||(n(),i=!0)},a=setInterval(function(){r.isLoaded()&&(o(),clearInterval(a))},500);"function"==typeof t&&(n=t,e=null,t=null),t&&"object"===(void 0===t?"undefined":c(t))&&(n=e,e=t,t=null),"function"==typeof e&&(n=e,e=null),t=t||"library";var s=this.tags[t];if(!s)throw new Error((0,v.default)('tag "%s" not defined.',t));n=n||b.default;var u=void 0,l=(0,w.default)(s.attr);switch(this.replaceAttrTemplate(e,l),s.type){case"img":l.width=1,l.height=1,u=(0,h.default)(l,o);break;case"script":u=(0,d.default)(l,function(e){e?(0,O.error)('error loading "'+t+'" error="'+e+'"'):o()}),(0,D.default)(l,"src"),(0,S.default)(l,function(t,e){u.setAttribute(t,e)});break;case"link":u=(0,p.default)(l,function(n){n?e&&"function"==typeof e.onError?((0,O.warn)('error loading "'+t+'" error="'+n+'"'),e.onError()):(0,O.error)('error loading "'+t+'" error="'+n+'"'):o()});break;case"iframe":u=(0,g.default)(l,o)}},e.prototype.replaceAttrTemplate=function(t,e){return t?((0,S.default)(e,function(n,r){"onError"!==n&&(r&&(e[n]=r.replace(/\{\{ *(\w+) *\}\}/g,function(e,n){return void 0!==t[n]?t[n]:""})),"src"!==n&&"href"!==n||(e[n]=e[n].replace(/[^?=&]+=(&|$)/g,"").replace(/&$/,"")))}),e):e},e.prototype.isLoaded=function(){return!!this._isLoaded},e.prototype.onLoadInitiated=function(){},e.prototype.onLoad=function(){this.emit("load")},e.prototype.addTag=function(t,e){return e||(e=t,t="library"),this.tags[t]=e,this},e.prototype.getTag=function(t){return t||(t="library"),this.tags[t]},e.prototype.setOption=function(t,e){return this.options[t]=e,this},e.prototype.getOption=function(t){return this.options[t]},e.prototype.reset=function(){this._isLoaded=!1,this._isInitialized=!1},e.prototype.onEnrich=function(){this._isEnriched=!0,this.emit("enrich")},e.prototype.enrichDigitalData=function(){},e.prototype.getEnrichableEventProps=function(){return[]},e.prototype.getEventValidationConfig=function(){},e.prototype.getSemanticEvents=function(){return[]},e.prototype.getIgnoredEvents=function(){return[]},e.prototype.allowCustomEvents=function(){return!1},e.prototype.allowNoConflictInitialization=function(){return!1},e.prototype.isEnriched=function(){return this._isEnriched},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.setInitialized=function(t){this._isInitialized=t,this._isInitialized&&this.emit("ready")},e.prototype.setDDManager=function(t){this.ddManager=t},e.prototype.trackEvent=function(){},e.prototype.pushEventQueue=function(t){this.eventQueueFlushed?this.trackEvent(t):(this.eventQueue=this.eventQueue||[],this.eventQueue.push(t))},e.prototype.flushEventQueue=function(){this.eventQueue=this.eventQueue||[];for(var t=this.eventQueue.shift();t;)this.trackEvent(t),t=this.eventQueue.shift();this.eventQueueFlushed=!0},e.prototype.on=function(t,e){this.addEventListener(t,e)},e.prototype.addEventListener=function(e,n){if("enrich"===e){if(this._isEnriched)return void n()}else if("load"===e&&this.isLoaded())return void n();t.prototype.addEventListener.call(this,e,n)},e}(V.default);n.default=N},{"@segmentstream/utils/clone":4,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/each":8,"@segmentstream/utils/format":10,"@segmentstream/utils/loadIframe":24,"@segmentstream/utils/loadLink":25,"@segmentstream/utils/loadPixel":26,"@segmentstream/utils/loadScript":27,"@segmentstream/utils/log":28,"@segmentstream/utils/noop":29,"@segmentstream/utils/safeConsole":33,"async/nextTick":42,"component-emitter":43}],144:[function(t,e,n){"use strict";function r(t){var e=[];return(0,u.default)(t,function(t,n){n.type===l.DIGITALDATA_VAR&&e.push(n.value)}),e}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},i=t;return(0,u.default)(e,function(e,o){var a=void 0,c=o.type===l.DIGITALDATA_VAR?"event":o.type;n.multipleScopes&&(i=t[c]),i&&void 0!==(a="object"===(void 0===o?"undefined":s(o))&&o.type?(0,d.getProp)(i,o.value):(0,d.getProp)(i,o))&&("boolean"==typeof a&&n.booleanToString&&(a=a.toString()),r[e]=a)}),r}function o(t,e,n){var r=n[e];return"object"===(void 0===r?"undefined":s(r))&&r.type?(0,d.getProp)(t,r.value):(0,d.getProp)(t,r)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(t){return void 0===t?"undefined":a(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":a(t)};n.getEnrichableVariableMappingProps=r,n.extractVariableMappingValues=i,n.getVariableMappingValue=o;var c=t("@segmentstream/utils/each"),u=function(t){return t&&t.__esModule?t:{default:t}}(c),d=t("@segmentstream/utils/dotProp"),l=t("./variableTypes")},{"./variableTypes":231,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8}],145:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=t("@segmentstream/utils/each"),o=r(i),a=t("@segmentstream/utils/safeConsole"),s=t("@segmentstream/utils/clone"),c=r(s),u=t("@segmentstream/utils/eventListener"),d=t("./Integration"),l=r(d),p=void 0,f=void 0,g=void 0,m=void 0,h={},y={setAvailableIntegrations:function(t){p=t},addIntegration:function(t,e,n){if(!(e instanceof l.default&&t))throw new TypeError("attempted to add an invalid integration");e.setName(t),e.setDDManager(n),h[t]=e},getIntegration:function(t){return h[t]},getIntegrations:function(){return h},getIntegrationsByPriority:function(){var t=g||{},e=t.before||[],n=t.after||[],r=e.concat(n),i=Object.keys(h),o=i.filter(function(t){return-1===r.indexOf(t)});return e=e.concat(o),e.concat(n).map(function(t){return h[t]}).filter(function(t){return!!t})},initialize:function(t,e){f=t.version,g=t.integrationsPriority,m=t.pageLoadTimeout;var n=t.integrations;n&&(Array.isArray(n)?n.forEach(function(t){var n=t.name,r=(0,c.default)(t.options,!0);if("function"==typeof p[n]){var i=new p[n](e.getDigitalData(),r||{});y.addIntegration(n,i,e)}}):(0,o.default)(n,function(t,n){if("function"==typeof p[t])try{var r=new p[t](e.getDigitalData(),(0,c.default)(n,!0));y.addIntegration(t,r,e)}catch(t){(0,a.error)(t)}}))},initializeIntegration:function(t){t.getOption("disabled")||(!t.isLoaded()||t.getOption("noConflict")||t.allowNoConflictInitialization()?!1!==t.initialize(f)&&t.setInitialized(!0):(0,a.warn)('Integration "'+t.getName()+"\" can't be initialized properly because of the conflict"))},loadIntegration:function(t){t.isInitialized()&&(t.flushEventQueue(),t.isLoaded()||t.getOption("noConflict")?t.onLoad():t.load(t.onLoad),t.onLoadInitiated())},queueIntegrationLoad:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=g||{},r=e?[]:n.after||[],i="complete"===window.document.readyState,o=!1;if(r.indexOf(t.getName())>=0&&!i){var a=setTimeout(function(){o||(o=!0,y.loadIntegration(t))},m||3e3);(0,u.bind)(window,"load",function(){o||(o=!0,clearTimeout(a),y.loadIntegration(t))})}else y.loadIntegration(t)},reset:function(){(0,o.default)(h,function(t,e){e.removeAllListeners(),e.reset(),e.eventQueueFlushed=!1}),h={}}};n.default=y},{"./Integration":143,"@segmentstream/utils/clone":4,"@segmentstream/utils/each":8,"@segmentstream/utils/eventListener":9,"@segmentstream/utils/safeConsole":33}],146:[function(t,e,n){"use strict";function r(t){var e=0;if("string"==typeof t)switch(t){case"1week":t={weeks:1};break;case"1month":t={months:1};break;case"1year":t={days:365};break;default:t={days:1}}return(0,c.default)(t,function(t,n){switch(t){case"minutes":e+=d*parseInt(n,10);break;case"hours":e+=l*parseInt(n,10);break;case"days":e+=p*parseInt(n,10);break;case"weeks":e+=7*p*parseInt(n,10);break;case"months":e+=f*parseInt(n,10)}}),e}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=t.data,r=t.ttl,i=t.granularity;if(!n)return{};var o=e/1e3-r;return{ttl:r,granularity:i,data:Object.keys(n).filter(function(t){return o<t}).reduce(function(t,e){return t[e]=n[e],t},{})}}function o(t,e,n,o){var a=r(e),s=r(n),c=i((0,u.getProp)(o,t)||{}),d=Date.now()/1e3,l=d-d%a,p=c.data||{};return p[l]=(p[l]||0)+1,{ttl:s,granularity:a,data:p}}function a(t,e){var n=(0,u.getProp)(e,t);if(!n)return 0;var r=i(n),o=r.data||{};return Object.keys(o).reduce(function(t,e){return t+o[e]},0)}n.__esModule=!0,n.objectToTime=r,n.cleanData=i,n.counterInc=o,n.counter=a;var s=t("@segmentstream/utils/each"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=t("@segmentstream/utils/dotProp"),d=60,l=60*d,p=24*l,f=30*p},{"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8}],147:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=t("lockr"),o=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.options=Object.assign({prefix:""},e)}return t.prototype.supportsSubDomains=function(){return!1},t.prototype.set=function(t,e,n){t=this.getOption("prefix")+t,void 0!==n?o.default.set(t,{val:e,exp:1e3*n,time:Date.now()}):o.default.set(t,e)},t.prototype.get=function(t){if(t=this.getOption("prefix")+t,window.localStorage){var e=o.default.get(t);return e instanceof Object&&void 0!==e.val&&e.exp&&e.time?Date.now()-e.time>e.exp?void o.default.rm(t):e.val:e}},t.prototype.getTtl=function(t){t=this.getOption("prefix")+t;var e=o.default.get(t);if(void 0!==e&&void 0!==e.val&&e.exp&&e.time)return e.exp-(Date.now()-e.time)},t.prototype.remove=function(t){return t=this.getOption("prefix")+t,o.default.rm(t)},t.prototype.isEnabled=function(){try{window.localStorage.setItem("ddm_localstorage_test",1),window.localStorage.removeItem("ddm_localstorage_test")}catch(t){return!1}return!0},t.prototype.getOption=function(t){return this.options[t]},t.prototype.clear=function(){window.localStorage.clear()},t}();n.default=a},{lockr:103}],148:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=t("./integrations/GoogleAnalytics"),o=r(i),a=t("./integrations/GoogleTagManager"),s=r(a),c=t("./integrations/GoogleAdWords"),u=r(c),d=t("./integrations/Driveback"),l=r(d),p=t("./integrations/RetailRocket"),f=r(p),g=t("./integrations/FacebookPixel"),m=r(g),h=t("./integrations/SendPulse"),y=r(h),v=t("./integrations/OWOXBIStreaming"),E=r(v),w=t("./integrations/Criteo"),_=r(w),b=t("./integrations/MyTarget"),I=r(b),P=t("./integrations/YandexMetrica"),T=r(P),D=t("./integrations/Vkontakte"),O=r(D),C=t("./integrations/Emarsys"),S=r(C),A=t("./integrations/OneSignal"),k=r(A),R=t("./integrations/Sociomantic"),V=r(R),N=t("./integrations/Admitad"),L=r(N),M=t("./integrations/Actionpay"),j=r(M),x=t("./integrations/Mindbox"),U=r(x),q=t("./integrations/DoubleClickFloodlight"),W=r(q),G=t("./integrations/RTBHouse"),H=r(G),F=t("./integrations/Ofsys"),B=r(F),z=t("./integrations/Soloway"),Q=r(z),K=t("./integrations/OneDMC"),Y=r(K),J=t("./integrations/AdSpire"),X=r(J),$=t("./integrations/Weborama"),Z=r($),tt=t("./integrations/CityAds"),et=r(tt),nt=t("./integrations/Aidata"),rt=r(nt),it=t("./integrations/Segmento"),ot=r(it),at=t("./integrations/Mixmarket"),st=r(at),ct=t("./integrations/GdeSlon"),ut=r(ct),dt=t("./integrations/RichRelevance"),lt=r(dt),pt=t("./integrations/Linkprofit"),ft=r(pt),gt=t("./integrations/Flocktory"),mt=r(gt),ht=t("./integrations/DDManagerStreaming"),yt=r(ht),vt=t("./integrations/Recreativ"),Et=r(vt),wt=t("./integrations/Multilead"),_t=r(wt),bt=t("./integrations/AdvCake"),It=r(bt),Pt=t("./integrations/JivoChat"),Tt=r(Pt),Dt=t("./integrations/Adnetic"),Ot=r(Dt),Ct=t("./integrations/AnyQuery"),St=r(Ct),At=t("./integrations/VeInteractive"),kt=r(At),Rt=t("./integrations/REES46"),Vt=r(Rt),Nt=t("./integrations/PushWorld"),Lt=r(Nt),Mt=t("./integrations/Get4Click"),jt=r(Mt),xt=t("./integrations/Renta"),Ut=r(xt),qt=t("./integrations/Target2Sell"),Wt=r(qt),Gt=t("./integrations/TradeTracker"),Ht=r(Gt),Ft=t("./integrations/TryFit"),Bt=r(Ft),zt=t("./integrations/Getintent"),Qt=r(zt),Kt=t("./integrations/Glami"),Yt=r(Kt),Jt=t("./integrations/K50"),Xt=r(Jt),$t=t("./integrations/Calltouch"),Zt=r($t),te=t("./integrations/DynamicYield"),ee=r(te),ne={"Google Analytics":o.default,"Google Tag Manager":s.default,"Google AdWords":u.default,"OWOX BI Streaming":E.default,"Facebook Pixel":m.default,Driveback:l.default,"Retail Rocket":f.default,SendPulse:y.default,Criteo:_.default,myTarget:I.default,"Yandex Metrica":T.default,Vkontakte:O.default,Emarsys:S.default,OneSignal:k.default,Sociomantic:V.default,Admitad:L.default,Actionpay:j.default,Mindbox:U.default,"DoubleClick Floodlight":W.default,"RTB House":H.default,Ofsys:B.default,Soloway:Q.default,"1DMC":Y.default,AdSpire:X.default,Weborama:Z.default,CityAds:et.default,Aidata:rt.default,Segmento:ot.default,Mixmarket:st.default,GdeSlon:ut.default,RichRelevance:lt.default,Linkprofit:ft.default,Flocktory:mt.default,"DDManager Streaming":yt.default,Recreativ:Et.default,Multilead:_t.default,AdvCake:It.default,JivoChat:Tt.default,Adnetic:Ot.default,AnyQuery:St.default,"Ve Interactive":kt.default,REES46:Vt.default,"Push.world":Lt.default,Get4Click:jt.default,Renta:Ut.default,Target2Sell:Wt.default,TradeTracker:Ht.default,"Try.Fit":Bt.default,Getintent:Qt.default,Glami:Yt.default,K50:Xt.default,Calltouch:Zt.default,"Dynamic Yield":ee.default};n.default=ne},{"./integrations/Actionpay":161,"./integrations/AdSpire":162,"./integrations/Admitad":163,"./integrations/Adnetic":164,"./integrations/AdvCake":165,"./integrations/Aidata":166,"./integrations/AnyQuery":167,"./integrations/Calltouch":168,"./integrations/CityAds":169,"./integrations/Criteo":170,"./integrations/DDManagerStreaming":171,"./integrations/DoubleClickFloodlight":173,"./integrations/Driveback":174,"./integrations/DynamicYield":175,"./integrations/Emarsys":176,"./integrations/FacebookPixel":177,"./integrations/Flocktory":178,"./integrations/GdeSlon":179,"./integrations/Get4Click":180,"./integrations/Getintent":181,"./integrations/Glami":182,"./integrations/GoogleAdWords":183,"./integrations/GoogleAnalytics":184,"./integrations/GoogleTagManager":185,"./integrations/JivoChat":186,"./integrations/K50":187,"./integrations/Linkprofit":188,"./integrations/Mindbox":189,"./integrations/Mixmarket":190,"./integrations/Multilead":191,"./integrations/MyTarget":192,"./integrations/OWOXBIStreaming":193,"./integrations/Ofsys":194,"./integrations/OneDMC":195,"./integrations/OneSignal":196,"./integrations/PushWorld":197,"./integrations/REES46":198,"./integrations/RTBHouse":199,"./integrations/Recreativ":200,"./integrations/Renta":201,"./integrations/RetailRocket":202,"./integrations/RichRelevance":203,"./integrations/Segmento":204,"./integrations/SendPulse":205,"./integrations/Sociomantic":206,"./integrations/Soloway":207,"./integrations/Target2Sell":208,"./integrations/TradeTracker":209,"./integrations/TryFit":210,"./integrations/VeInteractive":211,"./integrations/Vkontakte":212,"./integrations/Weborama":213,"./integrations/YandexMetrica":214}],149:[function(t,e,n){"use strict";n.__esModule=!0;n.ANONYMOUS_ID_COOOKIE_NAME="ssaid",n.SDK_EVENT_SOURCE="DDManager SDK",n.SDK_CHANGE_SOURCE="DDManager SDK",n.CUSTOM_EVENT_SOURCE="DDManager Custom Event",n.CUSTOM_CHANGE_SOURCE="DDManager Custom Enrichment"},{}],150:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){"object"===f(window.digitalData)?ut=window.digitalData:window.digitalData=ut,Array.isArray(window.ddListener)?dt=window.ddListener:window.ddListener=dt}function o(t,e,n){var r=(0,$.validateIntegrationEvent)(t,e),i=r[0],o=r[1],a=e.getName(),s=e.isInitialized();i&&s?e.pushEventQueue(t):n&&(0,$.trackValidationErrors)(ut,t,a,o)}function a(t,e){if(!it.default.isConsentObtained())return!1;var n=t.excludeIntegrations,r=t.includeIntegrations;return(!n||!r)&&(!(n&&!Array.isArray(n)||r&&!Array.isArray(r))&&(r?r.indexOf(e)>=0:!n||n.indexOf(e)<0))}function s(t){lt.addCallback(["on","event",function(e){var n=(0,X.mapEvent)(e.name),r=k.default.getIntegrationsByPriority();n===X.VIEWED_PAGE&&r.forEach(function(r){if(!r.isInitialized()){var i=r.getName();if(a(e,i))try{if(r.getIgnoredEvents().indexOf(n)>=0)return;var o=(0,m.default)(e,!0);if(o.name=n,o=V.default.enrichIntegrationData(o,ut,r),!o.name||o.ignore)return;k.default.initializeIntegration(r);var s=t.prioritiesTest&&t.prioritiesTestVar&&1===(0,I.getProp)(ut,t.prioritiesTestVar);k.default.queueIntegrationLoad(r,s)}catch(t){(0,b.error)(t)}}}),r.forEach(function(r){var i=r.getName();if(a(e,i))try{if(r.getIgnoredEvents().indexOf(n)>=0)return;if(r.getSemanticEvents().indexOf(n)<0&&!r.allowCustomEvents())return;var s=(0,m.default)(e,!0);if(s.name=n,s=V.default.enrichIntegrationData(s,ut,r),!s.name||s.ignore)return;o(s,r,t.trackValidationErrors)}catch(t){(0,b.error)(t)}})},!0])}function c(t){gt=new W.default(ut,t.pageLoadTimeout),gt.import(t.scripts),lt.addCallback(["on","event",function(t){gt.run(t)}],!0)}function u(t){lt.import(t.events)}function d(t){ft=new U.default(ut,mt),ft.import(t.enrichments),lt.addCallback(["on","beforeEvent",function(t){t.name===X.VIEWED_PAGE&&pt.enrichDigitalData(),ft.enrichDigitalData(ut,t,!0)}]),lt.addCallback(["on","event",function(t){ft.enrichDigitalData(ut,t,!1)}])}function l(t){var e=new Q.default((0,E.default)({cookieDomain:t})),n=mt.get("user.anonymousId"),r=e.get(ct.ANONYMOUS_ID_COOOKIE_NAME)||window.localStorage.getItem(ct.ANONYMOUS_ID_COOOKIE_NAME)||n||(0,T.default)();e.set(ct.ANONYMOUS_ID_COOOKIE_NAME,r),window.localStorage.setItem(ct.ANONYMOUS_ID_COOOKIE_NAME,r),n&&mt.unpersist("user.anonymousId")}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var f="function"==typeof Symbol&&"symbol"===p(Symbol.iterator)?function(t){return void 0===t?"undefined":p(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":p(t)},g=t("@segmentstream/utils/clone"),m=r(g),h=t("async/nextTick"),y=r(h),v=t("@segmentstream/utils/cleanObject"),E=r(v),w=t("component-emitter"),_=r(w),b=t("@segmentstream/utils/safeConsole"),I=t("@segmentstream/utils/dotProp"),P=t("uuid/v1"),T=r(P),D=t("./Integration"),O=r(D),C=t("./EventManager"),S=r(C),A=t("./IntegrationsLoader"),k=r(A),R=t("./enrichments/EventDataEnricher"),V=r(R),N=t("./DDHelper"),L=r(N),M=t("./enrichments/DigitalDataEnricher"),j=r(M),x=t("./enrichments/CustomEnrichments"),U=r(x),q=t("./scripts/CustomScripts"),W=r(q),G=t("./Storage"),H=r(G),F=t("./DDStorage"),B=r(F),z=t("./CookieStorage"),Q=r(z),K=t("js-cookie"),Y=r(K),J=t("./testMode"),X=t("./events/semanticEvents"),$=t("./EventValidator"),Z=t("./ErrorTracker"),tt=t("./trackers"),et=t("./integrations/DDManagerStreaming"),nt=r(et),rt=t("./ConsentManager"),it=r(rt),ot=t("./trackers/trackTimeOnPage"),at=t("./trackers/trackScroll"),st=t("./trackers/trackTimeOnSite"),ct=t("./constants"),ut={},dt=[],lt=void 0,pt=void 0,ft=void 0,gt=void 0,mt=void 0,ht=!1,yt=!1,vt={VERSION:"1.2.289",setConsent:it.default.setConsent,getConsent:it.default.getConsent,setAvailableIntegrations:function(t){k.default.setAvailableIntegrations(t)},processEarlyStubCalls:function(t){for(var e=t||[];e.length>0;){var n=e.shift(),r=n.shift();vt[r]&&("initialize"===r&&e.length>0?(0,y.default)(function(t,e){return function(){vt[t].apply(vt,e)}}(r,n)):vt[r].apply(vt,n))}},initialize:function(t){if(t=Object.assign({domain:null,websiteMaxWidth:"auto",sessionLength:3600,sendViewedPageEvent:!0,useCookieStorage:!1,trackValidationErrors:!1,trackJsErrors:!1,enableMonitoring:!0,cookieConsent:"none",unpersistContextCampaignOnTransaction:!0},t),yt)throw new Error("ddManager is already initialized");i(),t.trackJsErrors&&(0,Z.enableErrorTracking)(ut);var e=new H.default({prefix:"ddl:"}),n=new Q.default((0,E.default)({prefix:"dd_",cookieDomain:t.domain}));mt=t.useCookieStorage||!e.isEnabled()?new B.default(ut,n,e):new B.default(ut,e,n),l(t.domain),it.default.initialize(t.cookieConsent,ut,mt),pt=new j.default(ut,dt,mt,{sessionLength:t.sessionLength,unpersistContextCampaignOnTransaction:t.unpersistContextCampaignOnTransaction}),lt=new S.default(ut,dt),lt.setSendViewedPageEvent(t.sendViewedPageEvent),d(t),u(t),lt.addCallback(["on","event",function(t){t.name===X.SESSION_STARTED&&(0,st.reset)(),t.name===X.VIEWED_PAGE&&((0,ot.reset)(),(0,at.reset)())}]),k.default.initialize(t,vt);var r=k.default.getIntegration("DDManager Streaming");if(!r&&t.enableMonitoring)try{r=new nt.default(ut,{internal:!0}),k.default.addIntegration("DDManager Streaming",r,vt)}catch(t){(0,b.error)(t)}if(r&&(r.setOption("projectId",t.projectId),r.setOption("projectName",t.projectName),r.setOption("buildNumber",t.buildNumber),r.setOption("library",{name:"ddmanager.js",version:vt.VERSION})),s(t),c(t),yt=!0,vt.emit("ready"),lt.initialize(),(0,J.isTestMode)())try{(0,J.showTestModeMessage)(),(0,J.showTestModeBadge)()}catch(t){(0,b.error)(t)}},isLoaded:function(){return ht},isReady:function(){return yt},addIntegration:function(t,e){if(yt)throw new Error("Adding integrations after ddManager initialization is not allowed");k.default.addIntegration(t,e,vt)},getIntegration:function(t){return k.default.getIntegration(t)},get:function(t){return L.default.get(t,ut)},persist:function(t,e){return mt.persist(t,e)},unpersist:function(t){return mt.unpersist(t)},getProduct:function(t,e){return L.default.getProduct(t,e,ut)},getCampaign:function(t){return L.default.getCampaign(t,ut)},getEventManager:function(){return lt},getDigitalData:function(){return ut},trackLink:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,tt.trackLink)(t,e,n)},trackChange:function(t,e){(0,tt.trackChange)(t,e)},trackImpression:function(t,e){(0,tt.trackImpression)(t,e)},addEnrichment:function(t,e,n,r){ft.addEnrichment(t,e,n,r)},addEvent:function(t,e,n,r){lt.addEvent(t,e,n,r)},reset:function(){Y.default.remove(ct.ANONYMOUS_ID_COOOKIE_NAME),mt&&mt.clear(),lt instanceof S.default&&lt.reset(),ft&&ft.reset(),k.default.reset(),vt.removeAllListeners(),lt=null,ht=!1,yt=!1},Integration:O.default};(0,_.default)(vt);var Et=vt.on;vt.on=vt.addEventListener=function(t,e){if("ready"===t){if(yt)return void e()}else if("load"===t&&ht)return void e();Et.call(vt,t,e)},n.default=vt},{"./ConsentManager":135,"./CookieStorage":136,"./DDHelper":137,"./DDStorage":138,"./ErrorTracker":139,"./EventManager":140,"./EventValidator":141,"./Integration":143,"./IntegrationsLoader":145,"./Storage":147,"./constants":149,"./enrichments/CustomEnrichments":152,"./enrichments/DigitalDataEnricher":154,"./enrichments/EventDataEnricher":155,"./events/semanticEvents":158,"./integrations/DDManagerStreaming":171,"./scripts/CustomScripts":221,"./testMode":222,"./trackers":223,"./trackers/trackScroll":228,"./trackers/trackTimeOnPage":229,"./trackers/trackTimeOnSite":230,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/clone":4,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/safeConsole":33,"async/nextTick":42,"component-emitter":43,"js-cookie":102,"uuid/v1":133}],151:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var o=t("@segmentstream/utils/safeConsole"),a=t("@segmentstream/utils/isPromise"),s=r(a),c=t("../Handler"),u=r(c),d=t("../constants"),l=function(){function t(e,n){i(this,t),this.config=e,this.collection=n,this.digitalData=n.getDigitalData(),this.ddStorage=n.getDDStorage(),this.done=!1,this.recursionFreeze=!1}return t.prototype.hasDependencies=function(){return this.config.dependencies&&this.config.dependencies.length},t.prototype.getDependencies=function(){return this.config.dependencies||[]},t.prototype.enrich=function(t,e){var n=this,r=function(e){void 0!==e&&(t.changes.push([n.config.prop,e,d.CUSTOM_CHANGE_SOURCE]),n.config.persist&&n.ddStorage.persist(n.config.prop,n.config.persistTtl)),n.done=!0};if(!this.recursionFreeze&&(this.recursionFreeze=!0,!this.isDone())){if(this.hasDependencies()){this.getDependencies().forEach(function(r){var i=n.collection.getEnrichment(r);i&&i.enrich(t,e)})}var i=new u.default(this.config.handler,this.digitalData,e),a=void 0;try{a=i.run(),(0,s.default)(a)?a.then(function(t){r(t)}):r(a)}catch(t){t.message='DDManager Custom Enrichment "'+this.config.prop+'" Error\n\n '+t.message,(0,o.error)(t)}}},t.prototype.isDone=function(){return this.done},t.prototype.reset=function(){this.done=!1,this.recursionFreeze=!1},t}();n.default=l},{"../Handler":142,"../constants":149,"@segmentstream/utils/isPromise":22,"@segmentstream/utils/safeConsole":33}],152:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var o,a="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(t){return void 0===t?"undefined":i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":i(t)},s=t("./CustomEnrichmentsCollection"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=t("../events/semanticEvents"),d=(o={},o.beforeEvent={},o.afterEvent={},o),l=function(t){return"object"===(void 0===t?"undefined":a(t))&&"function"==typeof t.handler&&"string"==typeof t.prop},p=function(){function t(e,n){r(this,t),this.ddStorage=n,this.digitalData=e}return t.prototype.import=function(t){var e=this;t&&Array.isArray(t)&&t.forEach(function(t){l(t)&&e.addEnrichment(t)})},t.prototype.addEnrichment=function(t){void 0===t.beforeEvent&&(t.event||(t.event=u.VIEWED_PAGE),t.beforeEvent=t.event===u.VIEWED_PAGE),this.prepareCollection(t.event,t.beforeEvent).addEnrichment(t)},t.prototype.enrichDigitalData=function(t,e,n){e.name&&!e.stopPropagation&&this.prepareCollection(e.name,n).enrich(t,[e])},t.prototype.prepareCollection=function(t,e){return e?(d.beforeEvent[t]||(d.beforeEvent[t]=this.newCollection(t,e)),d.beforeEvent[t]):(d.afterEvent[t]||(d.afterEvent[t]=this.newCollection(t,e)),d.afterEvent[t])},t.prototype.newCollection=function(t,e){var n=new c.default(t,e);return n.setDigitalData(this.digitalData),n.setDDStorage(this.ddStorage),n},t.prototype.reset=function(){d.beforeEvent={},d.afterEvent={}},t}();n.default=p},{"../events/semanticEvents":158,"./CustomEnrichmentsCollection":153}],153:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=t("./CustomEnrichment"),o=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function(){function t(e,n){r(this,t),this.event=e,this.beforeEvent=n,this.enrichments=[],this.enrichmentsIndex={}}return t.prototype.setDigitalData=function(t){this.digitalData=t},t.prototype.getDigitalData=function(){return this.digitalData},t.prototype.setDDStorage=function(t){this.ddStorage=t},t.prototype.getDDStorage=function(){return this.ddStorage},t.prototype.addEnrichment=function(t){var e=t.prop,n=new o.default(t,this);this.enrichments.push(n),this.enrichmentsIndex[e]=n},t.prototype.getEnrichment=function(t){return this.enrichmentsIndex[t]},t.prototype.reset=function(){this.enrichments.forEach(function(t){t.reset()})},t.prototype.enrich=function(t,e){this.reset(),this.enrichments.forEach(function(n){n.enrich(t,e)})},t}();n.default=a},{"./CustomEnrichment":151}],154:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var o=t("@segmentstream/utils/htmlGlobals"),a=r(o),s=t("@segmentstream/utils/semver"),c=r(s),u=t("@segmentstream/utils/getQueryParam"),d=r(u),l=t("@segmentstream/utils/cleanObject"),p=r(l),f=t("@segmentstream/utils/dotProp"),g=t("@segmentstream/utils/safeConsole"),m=t("ua-parser-js"),h=r(m),y=t("js-cookie"),v=r(y),E=t("../events/semanticEvents"),w=t("../constants"),_=function(){function t(e,n,r,o){i(this,t),this.digitalData=e,this.ddListener=n,this.ddStorage=r,this.options=Object.assign({sessionLength:3600},o),this.listenToEvents()}return t.prototype.setDigitalData=function(t){this.digitalData=t},t.prototype.setDDListener=function(t){this.ddListener=t},t.prototype.setDDStorage=function(t){this.ddStorage=t},t.prototype.setOption=function(t,e){this.options[t]=e},t.prototype.enrichDigitalData=function(){this.enrichStructure(),this.enrichContextData(),this.enrichPageData(),this.enrichLegacyVersions(),this.fireSessionStarted(),this.persistUserData(),this.enrichDDStorageData(),this.enrichDefaultUserData(),this.enrichIsReturningStatus(),this.ddStorage.setLastEventTimestamp(Date.now())},t.prototype.listenToEvents=function(){var t=this;this.ddListener.push(["on","event",function(e){if(t.enrichIsReturningStatus(),t.ddStorage.setLastEventTimestamp(Date.now()),e.name===E.SUBSCRIBED){var n=(0,f.getProp)(e,"user.email");t.enrichHasSubscribed(n)}else e.name===E.COMPLETED_TRANSACTION?(t.enrichHasTransacted(),!1!==t.options.unpersistContextCampaignOnTransaction&&t.ddStorage.unpersist("context.campaign")):e.name===E.UPDATED_CART&&c.default.cmp(t.digitalData.version,"1.1.3")>=0&&(t.fireAddRemoveProduct(e),t.digitalData.changes.push(["cart",e.cart,w.SDK_CHANGE_SOURCE]))}])},t.prototype.fireAddRemoveProduct=function(t){var e=this,n=(0,f.getProp)(t,"cart.lineItems")||[],r=(0,f.getProp)(this.digitalData,"cart.lineItems")||[],i={},o={},a=function(t,e){return t&&e?[t,e].join("_"):t},s=function(t){return function(e){return!t.some(function(t){return a((0,f.getProp)(e,"product.id"),(0,f.getProp)(e,"product.skuCode"))===a((0,f.getProp)(t,"product.id"),(0,f.getProp)(t,"product.skuCode"))})}},c=function(t,e){return function(n){return t.some(function(t){var r=a((0,f.getProp)(n,"product.id"),(0,f.getProp)(n,"product.skuCode")),i=a((0,f.getProp)(t,"product.id"),(0,f.getProp)(t,"product.skuCode")),o=(0,f.getProp)(n,"quantity"),s=(0,f.getProp)(t,"quantity");return r===i&&o>s&&(e[r]=o-s,!0)})}},u=function(t,n){return function(r){var i=(0,f.getProp)(r,"product.id"),o=(0,f.getProp)(r,"product.skuCode");e.digitalData.events.push({name:t,category:"Ecommerce",product:r.product,quantity:n[a(i,o)]||r.quantity,source:w.SDK_EVENT_SOURCE})}},d=n.filter(s(r)),l=r.filter(s(n)),p=n.filter(c(r,i)),g=r.filter(c(n,o));d.concat(p).forEach(u(E.ADDED_PRODUCT,i)),l.concat(g).forEach(u(E.REMOVED_PRODUCT,o))},t.prototype.fireSessionStarted=function(){var t=this.ddStorage.getLastEventTimestamp();(!t||Date.now()-t>1e3*this.options.sessionLength)&&this.digitalData.events.push({name:E.SESSION_STARTED,source:w.SDK_EVENT_SOURCE,includeIntegrations:[]})},t.prototype.enrichDefaultUserData=function(){var t=this.digitalData.user;void 0===t.isReturning&&(t.isReturning=!1),void 0!==t.isLoggedIn&&void 0===t.everLoggedIn&&(t.everLoggedIn=!1),t.anonymousId=v.default.get(w.ANONYMOUS_ID_COOOKIE_NAME)||window.localStorage.getItem(w.ANONYMOUS_ID_COOOKIE_NAME)},t.prototype.persistUserData=function(){var t=this.digitalData.user;t.isLoggedIn&&!t.everLoggedIn&&(t.everLoggedIn=!0,this.ddStorage.persist("user.everLoggedIn")),t.email&&this.ddStorage.persist("user.email"),t.isSubscribed&&this.ddStorage.persist("user.isSubscribed"),t.hasTransacted&&this.ddStorage.persist("user.hasTransacted"),t.lastTransactionDate&&this.ddStorage.persist("user.lastTransactionDate")},t.prototype.enrichIsReturningStatus=function(){var t=this.ddStorage.getLastEventTimestamp();!this.digitalData.user.isReturning&&t&&Date.now()-t>1e3*this.options.sessionLength&&(this.digitalData.user.isReturning=!0,this.ddStorage.persist("user.isReturning"))},t.prototype.enrichHasSubscribed=function(t){var e=this.digitalData.user;e.isSubscribed||(e.isSubscribed=!0,this.ddStorage.persist("user.isSubscribed")),!e.email&&t&&(e.email=t,this.ddStorage.persist("user.email"))},t.prototype.enrichHasTransacted=function(){var t=this.digitalData.user;t.hasTransacted||(t.hasTransacted=!0,this.ddStorage.persist("user.hasTransacted")),t.lastTransactionDate||(t.lastTransactionDate=(new Date).toISOString(),this.ddStorage.persist("user.lastTransactionDate"))},t.prototype.enrichStructure=function(){this.digitalData.website=this.digitalData.website||{},this.digitalData.page=this.digitalData.page||{},this.digitalData.user=this.digitalData.user||{},this.digitalData.context=this.digitalData.context||{},this.digitalData.page.type&&"confirmation"===this.digitalData.page.type&&(this.digitalData.transaction=this.digitalData.transaction||{}),this.digitalData.cart=this.digitalData.cart||{lineItems:[],subtotal:0,total:0},this.digitalData.events=this.digitalData.events||[],this.digitalData.changes=this.digitalData.changes||[]},t.prototype.enrichPageData=function(){var t=this.digitalData.page,e=this.getHtmlGlobals().getDocument(),n=this.getHtmlGlobals().getLocation(),r=e.title,i=n.pathname,o=n.search,a=n.href,s=n.hash,c=e.referrer;try{i=decodeURIComponent(i)}catch(t){(0,g.warn)(t)}try{c=decodeURI(c)}catch(t){(0,g.warn)(t)}try{o=decodeURIComponent(o)}catch(t){(0,g.warn)(t)}try{a=decodeURI(a)}catch(t){(0,g.warn)(t)}try{s=decodeURIComponent(s)}catch(t){(0,g.warn)(t)}t.path=t.path||i,t.referrer=t.referrer||c,t.queryString=t.queryString||o,t.title=t.title||r,t.url=t.url||a,t.hash=t.hash||s},t.prototype.enrichContextData=function(){var t=this.digitalData.context,e=this.getHtmlGlobals().getNavigator(),n=e.userAgent;t.userAgent=n;var r=new h.default;if(t.browser=r.getBrowser(),t.device=Object.assign({type:"desktop"},(0,p.default)(r.getDevice())),t.os=r.getOS(),!t.campaign){var i=(0,d.default)("gclid"),o=(0,d.default)("yclid"),a=(0,d.default)("ymclid"),s=(0,d.default)("utm_campaign"),c=(0,d.default)("utm_source"),u=(0,d.default)("utm_medium"),l=(0,d.default)("utm_term"),f=(0,d.default)("utm_content");c=i?c||"google":c,c=o?c||"yandex":c,c=a?c||"yandex_market":c,u=i||o||a?u||"cpc":u,(c||u||s)&&(t.campaign=(0,p.default)({name:s,source:c,medium:u,term:l,content:f}),this.ddStorage.persist("context.campaign",7776e3))}},t.prototype.enrichDDStorageData=function(){var t=this;this.ddStorage.getPersistedKeys().forEach(function(e){var n=t.ddStorage.get(e);void 0!==n&&void 0===(0,f.getProp)(t.digitalData,e)&&(0,f.setProp)(t.digitalData,e,n)})},t.prototype.enrichLegacyVersions=function(){if(this.digitalData.version&&c.default.cmp(this.digitalData.version,"1.1.1")<0){var t=this.digitalData.listing;t&&t.listName&&!t.listId&&(t.listId=t.listName);var e=this.digitalData.recommendation||[];Array.isArray(e)||(e=[e]),e.forEach(function(t){t&&t.listName&&!t.listId&&(t.listId=t.listName)})}if(this.digitalData.version&&c.default.cmp(this.digitalData.version,"1.1.0")<0){var n=this.digitalData.page;if("category"===n.type&&n.categoryId){(this.digitalData.listing=this.digitalData.listing||{}).categoryId=n.categoryId}}},t.prototype.getHtmlGlobals=function(){return a.default},t}();n.default=_},{"../constants":149,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/htmlGlobals":17,"@segmentstream/utils/safeConsole":33,"@segmentstream/utils/semver":35,"js-cookie":102,"ua-parser-js":130}],155:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var a="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":o(t)},s=t("@segmentstream/utils/dotProp"),c=r(s),u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("../DDHelper"),p=r(l),f=t("../events/semanticEvents"),g=t("./IntegrationEnrichment"),m=r(g),h=function(){function t(){i(this,t)}return t.enrichCommonData=function(e,n){return["product","listItem","listItems","campaign","campaigns"].forEach(function(r){if(e[r]){var i=t[r],o=e[r];e[r]=i(o,n)}}),e.name===f.VIEWED_PRODUCT_DETAIL&&!e.product&&n.product?e.product=p.default.get("product",n):e.name===f.COMPLETED_TRANSACTION&&!e.transaction&&n.transaction&&(e.transaction=p.default.get("transaction",n)),!e.version&&n.version&&(e.version=n.version),e},t.enrichIntegrationData=function(e,n,r){if(r.getEnrichableEventProps(e).forEach(function(t){if(t&&!c.default.getProp(e,t)&&n){var r=t;t.endsWith(".length")&&(r=t.replace(/\.length$/,""));var i=p.default.get(r,n);void 0!==i&&c.default.setProp(e,r,i)}}),r.getEventOverrideFunction()&&r.getEventOverrideFunction()(e),r.getProductOverrideFunction()){var i=r.getProductOverrideFunction();e=t.enrichEventProducts(e,i)}return r.getEventEnrichments().filter(function(t){return!(t.scope&&"event"!==t.scope||t.event&&t.event!==e.name)}).forEach(function(t){new m.default(t.prop,t.handler,n).enrich(e)}),r.getEventEnrichments().filter(function(n){return"product"===n.scope&&t.hasProductFields(e)}).forEach(function(r){var i=new m.default(r.prop,r.handler,n);t.enrichEventProducts(e,i.enrich.bind(i))}),e},t.hasProductFields=function(t){return t.product||t.listing&&t.listing.items||t.cart&&t.cart.lineItems||t.transaction&&t.transaction.lineItems||t.listItem||t.listItems},t.enrichEventProducts=function(t,e){return t.product?e(t.product):t.listing&&t.listing.items?t.listing.items.forEach(function(t){e(t)}):t.cart&&t.cart.lineItems?t.cart.lineItems.forEach(function(t){e(t.product)}):t.transaction&&t.transaction.lineItems?t.transaction.lineItems.forEach(function(t){e(t.product)}):(t.listItem||t.listItems)&&(t.listItem?e(t.listItem.product):t.listItems&&t.listItems.forEach(function(t){e(t.product)})),t},t.product=function(t,e){var n=void 0;if("object"===(void 0===t?"undefined":a(t))?n=t.id:(n=t,t={id:n}),n){var r=p.default.getProduct(n,t.skuCode,e)||{};r&&(t=Object.assign(r,t))}return t},t.listItem=function(t,e){var n=void 0;if(t.listId||(0,d.default)(t,"listId"),"object"===a(t.product)?n=t.product.id:(n=t.product,t.product={id:n}),n){var r=p.default.getListItem(n,e,t.listId);r&&(t.product=Object.assign(r.product,t.product),t=Object.assign(r,t))}return t},t.listItems=function(e,n){var r=[];return e.forEach(function(e){var i=t.listItem(e,n);r.push(i)}),r},t.campaign=function(t,e){var n=void 0;if("object"===(void 0===t?"undefined":a(t))?n=t.id:(n=t,t={id:n}),n){var r=p.default.getCampaign(n,e)||{};r&&(t=Object.assign(r,t))}return t},t.campaigns=function(e,n){var r=[];return e.forEach(function(e){r.push(t.campaign(e,n))}),r},t}();n.default=h},{"../DDHelper":137,"../events/semanticEvents":158,"./IntegrationEnrichment":156,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],156:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var o=t("@segmentstream/utils/safeConsole"),a=t("@segmentstream/utils/dotProp"),s=t("@segmentstream/utils/isPromise"),c=r(s),u=t("../Handler"),d=r(u),l=function(){function t(e,n,r){i(this,t),this.prop=e,this.handler=n,this.digitalData=r,this.done=!1}return t.prototype.enrich=function(t){var e=new d.default(this.handler,this.digitalData,[t]);try{var n=e.run();(0,c.default)(n)?(0,o.error)("Async integration enrichments are not supported"):void 0!==n&&(0,a.setProp)(t,this.prop,n)}catch(t){(0,o.error)(t)}},t}();n.default=l},{"../Handler":142,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/isPromise":22,"@segmentstream/utils/safeConsole":33}],157:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var a="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":o(t)},s=t("@segmentstream/utils/safeConsole"),c=t("@segmentstream/utils/isPromise"),u=r(c),d=t("../trackers/trackImpression"),l=r(d),p=t("../trackers/trackLink"),f=r(p),g=t("../trackers/trackScroll"),m=r(g),h=t("../trackers/trackTimeOnPage"),y=r(h),v=t("../trackers/trackTimeOnSite"),E=r(v),w=t("../Handler"),_=r(w),b=t("../constants"),I=t("../trackers/trackChange"),P=r(I),T=function(){function t(e,n,r,o,a,s){i(this,t),this.name=e,this.trigger=n,this.settings=r||{},this.handler=o,this.digitalData=a,this.eventManager=s}return t.prototype.getTracker=function(){var t;return(t={},t.event=this.trackEvent.bind(this),t.click=this.trackClick.bind(this),t.change=this.trackChange.bind(this),t.impression=this.trackImpression.bind(this),t.scroll=this.trackScroll.bind(this),t.activeTimeOnSite=this.trackActiveTimeOnSite.bind(this),t.activeTimeOnPage=this.trackActiveTimeOnPage.bind(this),t.timeOnSite=this.trackTimeOnSite.bind(this),t.timeOnPage=this.trackTimeOnPage.bind(this),t)[this.trigger]},t.prototype.track=function(){var t=this.getTracker();if(!t)return void(0,s.error)('Tracker for trigger "'+this.trigger+'" is not defined');t()},t.prototype.newHandler=function(t){return new _.default(this.handler,this.digitalData,t)},t.prototype.resolveHandlerAndFireEvent=function(t){var e=this,n=this.newHandler(t);try{var r=n.run();r&&((0,u.default)(r)?r.then(function(t){e.fireEvent(t)}):this.fireEvent(r))}catch(t){t.message='DDManager Custom Event "'+this.name+'" Error\n\n '+t.message,(0,s.error)(t)}},t.prototype.trackEvent=function(){var t=this;this.settings.event&&this.eventManager.addCallback(["on","event",function(e){e.name!==t.settings.event||e.stopPropagation||t.resolveHandlerAndFireEvent([e])}])},t.prototype.trackImpression=function(){var t=this;this.settings.selector&&(0,l.default)(this.settings.selector,function(e){t.resolveHandlerAndFireEvent([e])})},t.prototype.trackClick=function(){var t=this;this.settings.selector&&(0,f.default)(this.settings.selector,function(e){t.resolveHandlerAndFireEvent([e])},this.settings.followLink)},t.prototype.trackChange=function(){var t=this;this.settings.selector&&(0,P.default)(this.settings.selector,function(e){t.resolveHandlerAndFireEvent([e])})},t.prototype.trackScroll=function(){var t=this;this.settings.scrollDepth&&(0,m.default)(this.settings.scrollDepth,function(e){t.resolveHandlerAndFireEvent([e])})},t.prototype.trackActiveTimeOnSite=function(){var t=this;this.settings.seconds&&(0,E.default)(this.settings.seconds,function(e){t.resolveHandlerAndFireEvent([e])},this.name,!0)},t.prototype.trackActiveTimeOnPage=function(){var t=this;this.settings.seconds&&(0,y.default)(this.settings.seconds,function(e){t.resolveHandlerAndFireEvent([e])},!0)},t.prototype.trackTimeOnSite=function(){var t=this;this.settings.seconds&&(0,E.default)(this.settings.seconds,function(e){t.resolveHandlerAndFireEvent([e])},this.name)},t.prototype.trackTimeOnPage=function(){var t=this;this.settings.seconds&&(0,y.default)(this.settings.seconds,function(e){t.resolveHandlerAndFireEvent([e])})},t.prototype.fireEvent=function(t){if(t){if("object"!==(void 0===t?"undefined":a(t)))return void(0,s.error)('Custom Event "'+this.name+'" was disabled: returned event should be object');if(!t.name)return void(0,s.error)('Custom Event "'+this.name+'" was disabled: returned event name is undefined');if("event"===this.trigger&&t.name===this.settings.event&&!t.stopPropagation)return void(0,s.error)('Custom Event "'+this.name+'" was disabled: recursion error');t.source||(t.source=b.CUSTOM_EVENT_SOURCE),this.digitalData.events.push(t)}},t}();n.default=T},{"../Handler":142,"../constants":149,"../trackers/trackChange":225,"../trackers/trackImpression":226,"../trackers/trackLink":227,"../trackers/trackScroll":228,"../trackers/trackTimeOnPage":229,"../trackers/trackTimeOnSite":230,"@segmentstream/utils/isPromise":22,"@segmentstream/utils/safeConsole":33}],158:[function(t,e,n){"use strict";function r(t){return u[t]?u[t]:t}n.__esModule=!0;var i;n.mapEvent=r;var o=(n.VIEWED_PAGE="Viewed Page",n.VIEWED_PRODUCT_DETAIL="Viewed Product Detail",n.VIEWED_PRODUCT_LISTING="Viewed Product Listing"),a=n.SEARCHED_PRODUCTS="Searched Products",s=(n.VIEWED_CART="Viewed Cart",n.COMPLETED_TRANSACTION="Completed Transaction",n.UPDATED_TRANSACTION="Updated Transaction",n.VIEWED_CHECKOUT_STEP="Viewed Checkout Step",n.COMPLETED_CHECKOUT_STEP="Completed Checkout Step",n.REFUNDED_TRANSACTION="Refunded Transaction",n.VIEWED_PRODUCT="Viewed Product",n.CLICKED_PRODUCT="Clicked Product",n.ADDED_PRODUCT="Added Product",n.REMOVED_PRODUCT="Removed Product",n.VIEWED_CAMPAIGN="Viewed Campaign",n.CLICKED_CAMPAIGN="Clicked Campaign",n.LEAD="Lead",n.SUBSCRIBED="Subscribed",n.REGISTERED="Registered",n.LOGGED_IN="Logged In",n.UPDATED_PROFILE_INFO="Updated Profile Info",n.VIEWED_EXPERIMENT="Viewed Experiment",n.ACHIEVED_EXPERIMENT_GOAL="Achieved Experiment Goal",n.ADDED_PRODUCT_TO_WISHLIST="Added Product to Wishlist",n.REMOVED_PRODUCT_FROM_WISHLIST="Removed Product from Wishlist",n.EXCEPTION="Exception",n.SESSION_STARTED="Session Started",n.STARTED_ORDER="Started Order",n.ADDED_PAYMENT_INFO="Added Payment Info",n.INTEGRATION_VALIDATION_FAILED="Integration Validation Failed",n.ALLOWED_PUSH_NOTIFICATIONS="Allowed Push Notifications",n.BLOCKED_PUSH_NOTIFICATIONS="Blocked Push Notifications",n.CLOSED_PUSH_NOTIFICATIONS_PROMPT="Closed Push Notifications Prompt",n.UPDATED_CART="Updated Cart",n.VIEWED_PRODUCT_CATEGORY="Viewed Product Category"),c=n.SEARCHED="Searched",u=(i={},i[c]=a,i[s]=o,i)},{}],159:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0,n.validate=void 0;var i=t("@segmentstream/utils/loadScript"),o=r(i),a=t("@segmentstream/utils/safeConsole"),s=t("@segmentstream/utils/dotProp"),c=t("../testMode"),u=t("../integrations/utils/AsyncQueue"),d=r(u),l=function(){return!!window.Ajv},p=new d.default(l),f=!1,g=void 0,m=function(t,e,n){var r=g.compile(t),i=n?(0,s.getProp)(e,n):e,o=r(i),c=void 0;c=i&&i.name&&i.timestamp?'"'+i.name+'" event':"window.digitalData"+(n?"."+n:""),o?(0,a.log)("%c "+c+" is valid!","color: green"):((0,a.group)(c+" validation errors:"),r.errors.forEach(function(t){return(0,a.log)(["%c",t.dataPath,t.message].join(" "),"color: red")}),(0,a.groupEnd)())};n.validate=function(t,e,n){if((0,c.isTestMode)()){if(!t)throw new Error('validate() helper requires "schema" as a first argument with object or boolean value');var r=void 0,i=void 0;f||(p.init(),r=window.require,i=window.define,window.require=void 0,window.define=void 0,(0,o.default)({src:"https://cdnjs.cloudflare.com/ajax/libs/ajv/6.8.1/ajv.min.js"}),f=!0),p.push(function(){g||(g=new window.Ajv({allErrors:!0}),window.require=r,window.define=i,r=void 0,i=void 0),m(t,e,n)})}}},{"../integrations/utils/AsyncQueue":215,"../testMode":222,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/loadScript":27,"@segmentstream/utils/safeConsole":33}],160:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}t("./polyfill");var i=t("./ddManager"),o=r(i),a=t("./availableIntegrations"),s=r(a),c=window.ddManager||window.segmentstream,u=c||{},d=u.SNIPPET_VERSION;o.default.SNIPPET_VERSION=d,window.ddManager=o.default,window.segmentstream=o.default,o.default.setAvailableIntegrations(s.default),o.default.processEarlyStubCalls(c)},{"./availableIntegrations":148,"./ddManager":150,"./polyfill":219}],161:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){t.deduplication&&(t.utmSource&&(t.utmSource=(0,E.default)(t.utmSource)),t.deduplicationUtmMedium&&(t.deduplicationUtmMedium=t.deduplicationUtmMedium.map(E.default)))}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/cleanObject"),d=r(u),l=t("js-cookie"),p=r(l),f=t("@segmentstream/utils/getQueryParam"),g=r(f),m=t("@segmentstream/utils/topDomain"),h=r(m),y=t("@segmentstream/utils/dotProp"),v=t("@segmentstream/utils/normalizeString"),E=r(v),w=t("../Integration"),_=r(w),b=t("../events/semanticEvents"),I="actionpay",P=function(t){function e(n,r){i(this,e),s(r);var a=Object.assign({defaultGoalId:"",cookieName:I,cookieTracking:!0,cookieDomain:(0,h.default)(window.location.href),cookieTtl:90,deduplication:!1,utmSource:"actionpay",deduplicationUtmMedium:[],aprt:!1,aprtPartnerId:""},r),c=o(this,t.call(this,n,a));return c._isLoaded=!1,c.addTag("trackingPixel",{type:"img",attr:{src:"//apypp.com/ok/{{ goalId }}.png?actionpay={{ partnerId }}&apid={{ actionId }}&price={{ total }}"}}),r.aprtPartnerId&&c.addTag("aprt",{type:"script",attr:{src:"//aprtx.com/code/"+r.aprtPartnerId+"/"}}),c}return a(e,t),e.prototype.initialize=function(){this._isLoaded=!0,this.getOption("cookieTracking")&&this.addAffiliateCookie()},e.prototype.trackAPRT=function(t){window.APRT_SEND?window.APRT_SEND((0,d.default)(t)):(window.APRT_DATA=(0,d.default)(t),this.load("aprt")),this.pageTracked=!0},e.prototype.trackAPRTCurrentProduct=function(t,e){this.trackAPRT({pageType:t,currentProduct:{id:e.id,name:e.name,price:e.unitSalePrice}})},e.prototype.addAffiliateCookie=function(){if(window.self===window.top){var t=(0,g.default)("actionpay");t&&p.default.set(this.getOption("cookieName"),t,{expires:this.getOption("cookieTtl"),domain:this.getOption("cookieDomain")})}},e.prototype.getSemanticEvents=function(){return this.getOption("aprt")?[b.VIEWED_PAGE,b.VIEWED_PRODUCT_LISTING,b.VIEWED_PRODUCT_DETAIL,b.VIEWED_CART,b.COMPLETED_TRANSACTION,b.VIEWED_CHECKOUT_STEP,b.ADDED_PRODUCT,b.REMOVED_PRODUCT,b.ADDED_PRODUCT_TO_WISHLIST,b.REMOVED_PRODUCT_FROM_WISHLIST,b.REGISTERED]:[b.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case b.VIEWED_PAGE:return["page.type"];case b.VIEWED_PRODUCT_LISTING:return["listing.category","listing.categoryId"];case b.VIEWED_PRODUCT_DETAIL:return["product"];case b.VIEWED_CART:case b.VIEWED_CHECKOUT_STEP:return["cart"];case b.COMPLETED_TRANSACTION:return["transaction","context.campaign"];case b.REGISTERED:return["user.userId"];default:return[]}},e.prototype.getEventValidationConfig=function(t){switch(t.name){case b.VIEWED_PAGE:return{fields:["page.type"]};case b.VIEWED_PRODUCT_LISTING:return{fields:["listing.categoryId","listing.category"]};case b.VIEWED_PRODUCT_DETAIL:case b.ADDED_PRODUCT:case b.REMOVED_PRODUCT:case b.ADDED_PRODUCT_TO_WISHLIST:case b.REMOVED_PRODUCT_FROM_WISHLIST:return{fields:["product.id","product.category","product.categoryId","product.name","product.unitSalePrice"]};case b.VIEWED_CART:case b.VIEWED_CHECKOUT_STEP:return{fields:["cart.lineItems[].product.id","cart.lineItems[].product.name","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity"]};case b.REGISTERED:return{fields:["user.userId"]};case b.COMPLETED_TRANSACTION:return{fields:["transaction.orderId","transaction.total","context.campaign.source","context.campaign.medium","integrations.actionpay.goalId"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]}}};default:return}},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.getBasketProducts=function(t){return(t.lineItems||[]).map(function(t){return{id:(0,y.getProp)(t,"product.id"),name:(0,y.getProp)(t,"product.name"),price:(0,y.getProp)(t,"product.unitSalePrice"),quantity:t.quantity||1}})},e.prototype.trackEvent=function(t){if(this.getOption("aprt")){var e,n=(e={},e[b.VIEWED_PAGE]="onViewedPage",e[b.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[b.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[b.VIEWED_CHECKOUT_STEP]="onViewedCheckoutStep",e[b.VIEWED_CART]="onViewedCart",e[b.ADDED_PRODUCT]="onAddedProduct",e[b.REMOVED_PRODUCT]="onRemovedProduct",e[b.ADDED_PRODUCT_TO_WISHLIST]="onAddedProductToWishlist",e[b.REMOVED_PRODUCT_FROM_WISHLIST]="onRemovedProductFromWishlist",e[b.REGISTERED]="onRegistered",e[b.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)}var i=p.default.get(this.getOption("cookieName"));i&&(this.isDeduplication(t)||t.name===b.COMPLETED_TRANSACTION&&this.trackSale(t,i))},e.prototype.onViewedPage=function(t){var e=this;"home"===(t.page||{}).type?this.onViewedHome(t):setTimeout(function(){e.pageTracked||e.trackAPRT({pageType:0})},100)},e.prototype.onViewedHome=function(){this.trackAPRT({pageType:1})},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.categoryId,r=void 0;Array.isArray(e.category)&&e.category.length&&(r=e.category[e.category.length-1]),this.trackAPRT({pageType:3,currentCategory:{id:n,name:r}})},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=void 0;Array.isArray(e.category)&&e.category.length&&(n=e.category[e.category.length-1]),this.trackAPRT({pageType:2,currentProduct:{id:e.id,name:e.name,price:e.unitSalePrice},currentCategory:{id:e.categoryId,name:n}})},e.prototype.onViewedCart=function(t){var e=t.cart||{};this.trackAPRT({pageType:4,basketProducts:this.getBasketProducts(e)})},e.prototype.onViewedCheckoutStep=function(t){var e=t.cart||{};this.trackAPRT({pageType:5,basketProducts:this.getBasketProducts(e)})},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{};this.trackAPRT({pageType:6,purchasedProducts:this.getBasketProducts(e),orderInfo:{id:e.orderId,totalPrice:e.total}})},e.prototype.onAddedProduct=function(t){var e=t.product||{};this.trackAPRTCurrentProduct(8,e)},e.prototype.onRemovedProduct=function(t){var e=t.product||{};this.trackAPRTCurrentProduct(9,e)},e.prototype.onAddedProductToWishlist=function(t){var e=t.product||{};this.trackAPRTCurrentProduct(10,e)},e.prototype.onRemovedProductFromWishlist=function(t){var e=t.product||{};this.trackAPRTCurrentProduct(11,e)},e.prototype.onRegistered=function(t){var e=t.user||{};this.trackAPRT({pageType:13,userInfo:{id:e.userId}})},e.prototype.isDeduplication=function(t){if(this.getOption("deduplication")){var e=(0,y.getProp)(t,"context.campaign.source");if(!e||e.toLowerCase()!==this.getOption("utmSource")){var n=this.getOption("deduplicationUtmMedium")||[];if(!n||0===n.length)return!0;var r=(0,y.getProp)(t,"context.campaign.medium");if(n.indexOf(r.toLowerCase())>=0)return!0}}return!1},e.prototype.trackSale=function(t,e){var n=t.transaction;if(n&&n.orderId&&n.total){var r=(0,y.getProp)(t,"integrations.actionpay.goalId")||this.getOption("defaultGoalId"),i=n.orderId,o=n.shippingCost||0,a=n.total-o;this.load("trackingPixel",{goalId:r,actionId:i,partnerId:e,total:a})}},e}(_.default);n.default=P},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/topDomain":37,"js-cookie":102}],162:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return t=t||[],t.map(function(t){var e=t.product||{};return e.category=e.category||[],(0,d.default)({pid:e.id,pname:e.name,cid:e.categoryId,cname:e.category[e.category.length-1],price:e.unitSalePrice,quantity:t.quantity||1,currency:e.currency,variant_id:e.skuCode})})}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/cleanObject"),d=r(u),l=t("@segmentstream/utils/dotProp"),p=t("@segmentstream/utils/ipToLong"),f=r(p),g=t("@segmentstream/utils/normalizeString"),m=r(g),h=t("crypto-js/md5"),y=r(h),v=t("../Integration"),E=r(v),w=t("../events/semanticEvents"),_=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:""},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//track.adspire.io/code/"+r.siteId+"/"}}),s}return a(e,t),e.prototype.getEnrichableEventProps=function(t){switch(t.name){case w.VIEWED_PAGE:return["page.type"];case w.VIEWED_PRODUCT_DETAIL:return["product"];case w.COMPLETED_TRANSACTION:return["transaction","user.email","user.firstName","user.lastName"];case w.VIEWED_PRODUCT_LISTING:return["listing.categoryId","listing.category"];case w.VIEWED_CART:return["cart"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[w.VIEWED_PAGE]={fields:["page.type"],validations:{errors:["required"],warnings:["string"]}},e[w.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.name","product.categoryId","product.category","product.unitSalePrice","product.currency","product.url","product.imageUrl"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.categoryId":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},"product.unitSalePrice":{warnings:["required","numeric"]},"product.currency":{warnings:["required","string"]},"product.url":{warnings:["required","string"]},"product.imageUrl":{warnings:["required","string"]}}},e[w.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId","listing.category"],validations:{"listing.categoryId":{warnings:["required","string"]},"listing.category":{warnings:["required","array"]}}},e[w.VIEWED_CART]={fields:["cart.lineItems[].product.id","cart.lineItems[].product.name","cart.lineItems[].product.categoryId","cart.lineItems[].product.category","cart.lineItems[].product.unitSalePrice","cart.lineItems[].product.currency","cart.lineItems[].quantity"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]},"cart.lineItems[].product.name":{warnings:["required","string"]},"cart.lineItems[].product.categoryId":{warnings:["required","string"]},"cart.lineItems[].product.category":{warnings:["required","array"]},"cart.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"cart.lineItems[].product.currency":{warnings:["required","string"]},"cart.lineItems[].quantity":{warnings:["required","numeric"]}}},e[w.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","transaction.isFirst","transaction.vouchers","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.categoryId","transaction.lineItems[].product.category","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].product.currency","transaction.lineItems[].quantity","user.email","user.firstName","user.lastName"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{warnings:["required","numeric"]},"transaction.lineItems[].product.id":{warnings:["required","string"]},"transaction.lineItems[].product.name":{warnings:["required","string"]},"transaction.lineItems[].product.categoryId":{warnings:["required","string"]},"transaction.lineItems[].product.category":{warnings:["required","array"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"transaction.lineItems[].product.currency":{warnings:["required","string"]},"transaction.lineItems[].quantity":{warnings:["required","numeric"]},"transaction.isFirst":{warnings:["boolean"]},"transaction.vouchers":{warning:["array"]}}},e)[t.name]},e.prototype.getSemanticEvents=function(){return[w.VIEWED_PAGE,w.VIEWED_PRODUCT_DETAIL,w.VIEWED_PRODUCT_LISTING,w.COMPLETED_TRANSACTION,w.VIEWED_CART]},e.prototype.initialize=function(){window.adspire_track=window.adspire_track||[]},e.prototype.isLoaded=function(){return!!window.adspire_code_loaded},e.prototype.getEmailMd5=function(t){var e=(0,l.getProp)(t,"user.email");if(e){var n=(0,m.default)(e);return(0,y.default)(n).toString()}},e.prototype.trackEvent=function(t){var e,n=(e={},e[w.VIEWED_PAGE]="onViewedPage",e[w.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[w.COMPLETED_TRANSACTION]="onCompletedTransaction",e[w.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[w.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1;var n=t.page,r=(0,l.getProp)(t,"context.ip");r&&(window.adspire_ip=(0,f.default)(r)),n&&"home"===n.type&&this.onViewedHome(),this.pageTracked||setTimeout(function(){e.pageTracked||e.onViewedOther()},100)},e.prototype.onViewedHome=function(){window.adspire_track.push({TypeOfPage:"general"}),this.pageTracked=!0},e.prototype.onViewedOther=function(){window.adspire_track.push({TypeOfPage:"other"}),this.pageTracked=!0},e.prototype.onViewedProductListing=function(t){var e=(0,l.getProp)(t,"listing.categoryId"),n=void 0,r=(0,l.getProp)(t,"listing.category");r&&Array.isArray(r)&&(n=r[r.length-1]),window.adspire_track.push((0,d.default)({TypeOfPage:"category",Category:{cid:e,cname:n}})),this.pageTracked=!0},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=e.categoryId,r=e.category||[],i=r[r.length-1];window.adspire_track.push((0,d.default)({TypeOfPage:"product",Category:{cid:n,cname:i},Product:{pid:e.id,pname:e.name,url:e.url,picture:e.imageUrl,price:e.unitSalePrice,currency:e.currency,variant_id:e.skuCode}})),this.pageTracked=!0},e.prototype.onViewedCart=function(t){var e=t.cart||{};window.adspire_track.push({TypeOfPage:"basket",Basket:s(e.lineItems)}),this.pageTracked=!0},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=t.user||{};e.vouchers=e.vouchers||[],window.adspire_track.push({TypeOfPage:"confirm",Order:(0,d.default)({id:e.orderId,totalprice:e.total,coupon:e.vouchers.join(","),usermail:e.isFirst?"new":"old",name:n.firstName,lastname:n.lastName,email:this.getEmailMd5(t)}),OrderItems:s(e.lineItems)}),this.pageTracked=!0},e}(E.default);n.default=_},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/ipToLong":18,"@segmentstream/utils/normalizeString":30,"crypto-js/md5":100}],163:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return window.screen.width+"x"+window.screen.height}function c(t){t.deduplication&&(t.utmSource&&(t.utmSource=(0,w.default)(t.utmSource)),t.deduplicationUtmMedium&&(t.deduplicationUtmMedium=t.deduplicationUtmMedium.map(w.default)))}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/cleanObject"),f=r(p),g=t("@segmentstream/utils/getQueryParam"),m=r(g),h=t("@segmentstream/utils/topDomain"),y=r(h),v=t("@segmentstream/utils/dotProp"),E=t("@segmentstream/utils/normalizeString"),w=r(E),_=t("js-cookie"),b=r(_),I=t("../events/semanticEvents"),P=t("../Integration"),T=r(P),D=t("./utils/affiliate"),O="sale",C="admitad_uid",S=function(t){function e(n,r){i(this,e),c(r);var a=Object.assign({campaignCode:"",paymentType:O,defaultActionCode:"1",cookieName:C,cookieTracking:!0,cookieDomain:(0,y.default)(window.location.href),cookieTtl:90,deduplication:!1,apiVersion:"pixel",utmSource:"admitad",deduplicationUtmMedium:[],crossDeviceTrackingId:"none",reTag:!1,reTagCode:""},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[I.COMPLETED_TRANSACTION],s.getOption("reTag")&&s.SEMANTIC_EVENTS.push(I.VIEWED_PAGE,I.VIEWED_PRODUCT_LISTING,I.VIEWED_PRODUCT_DETAIL,I.VIEWED_CART),s._pixelAPI="pixel"===s.getOption("apiVersion"),s._pixelAPI?(s.addTag("trackingPixel",{type:"script",attr:{id:"_admitad-pixel-dd",src:"//cdn.asbmit.com/static/js/ddpixel.js?r="+Date.now()}}),s._isLoaded=!1):s.addTag({type:"script",attr:{src:"https://www.artfut.com/static/tagtag.min.js?campaign_code="+s.getOption("campaignCode"),onerror:'var self = this;window.ADMITAD=window.ADMITAD||{},ADMITAD.Helpers=ADMITAD.Helpers||{},ADMITAD.Helpers.generateDomains=function(){for(var e=new Date,n=Math.floor(new Date(2020,e.getMonth(),e.getDate()).setUTCHours(0,0,0,0)/1e3),t=parseInt(1e12*(Math.sin(n)+1)).toString(30),i=["de"],o=[],a=0;a<i.length;++a)o.push({domain:t+"."+i[a],name:t});return o},ADMITAD.Helpers.findTodaysDomain=function(e){function n(){var o=new XMLHttpRequest,a=i[t].domain,D="https://"+a+"/";o.open("HEAD",D,!0),o.onload=function(){setTimeout(e,0,i[t])},o.onerror=function(){++t<i.length?setTimeout(n,0):setTimeout(e,0,void 0)},o.send()}var t=0,i=ADMITAD.Helpers.generateDomains();n()},window.ADMITAD=window.ADMITAD||{},ADMITAD.Helpers.findTodaysDomain(function(e){if(window.ADMITAD.dynamic=e,window.ADMITAD.dynamic){var n=function(){return function(){return self.src?self:""}}(),t=n(),i=(/campaign_code=([^&]+)/.exec(t.src)||[])[1]||"";t.parentNode.removeChild(t);var o=document.getElementsByTagName("head")[0],a=document.createElement("script");a.src="https://www."+window.ADMITAD.dynamic.domain+"/static/"+window.ADMITAD.dynamic.name.slice(1)+window.ADMITAD.dynamic.name.slice(0,1)+".min.js?campaign_code="+i,o.appendChild(a)}})'}}),s.addTag("reTag",{type:"script",attr:{src:"//cdn.admitad.com/static/js/retag.js"}}),s}return a(e,t),e.prototype.initialize=function(){this._pixelAPI&&(this._isLoaded=!0),this.getOption("reTag")&&(window._retag=window._retag||[]),this.getOption("cookieTracking")&&this.addAffiliateCookie()},e.prototype.addAffiliateCookie=function(){if(window.self===window.top){var t=(0,m.default)("admitad_uid");t&&b.default.set(this.getOption("cookieName"),t,{expires:this.getOption("cookieTtl"),domain:this.getOption("cookieDomain")})}},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){return t.name===I.VIEWED_PAGE?["page"]:t.name===I.VIEWED_PRODUCT_LISTING?["listing.categoryId"]:t.name===I.VIEWED_PRODUCT_DETAIL?["product"]:t.name===I.VIEWED_CART?["cart"]:t.name===I.COMPLETED_TRANSACTION?["transaction","user.userId","website.currency","context.campaign"]:[]},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[I.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.unitSalePrice","context.campaign.source","context.campaign.medium","integrations.admitad.actionCode"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.reset=function(){(0,l.default)(window,"_admitadPixel"),(0,l.default)(window,"_admitadPositions"),(0,l.default)(window,"_retag"),(0,l.default)(window,"ad_category"),(0,l.default)(window,"ad_product"),(0,l.default)(window,"ad_products"),(0,l.default)(window,"ad_order"),(0,l.default)(window,"ad_amount")},e.prototype.trackSale=function(t){if(this._pixelAPI){var e=b.default.get(this.getOption("cookieName"));if(!e||!this.getOption("campaignCode"))return;t.name===I.COMPLETED_TRANSACTION&&this.getOption("paymentType")===O?this.trackSaleWithPixel(t,e):t.name===I.LEAD&&"lead"===this.getOption("paymentType")&&this.trackLead(t,e)}else t.name===I.COMPLETED_TRANSACTION&&this.getOption("paymentType")===O&&this.trackSaleWithTagtag(t)},e.prototype.trackEvent=function(t){if(this.getOption("reTag")){var e,n=(e={},e[I.VIEWED_PAGE]="onViewedPage",e[I.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[I.COMPLETED_TRANSACTION]="onCompletedTransaction",e[I.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[I.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)}var i=(0,v.getProp)(t,"context.campaign"),o=this.getOption("utmSource"),a=this.getOption("deduplication"),s=this.getOption("deduplicationUtmMedium");this._pixelAPI&&a&&(0,D.isDeduplication)(i,o,s)||this.trackSale(t)},e.prototype.trackSaleWithTagtag=function(t){var e=t.transaction;if(e&&e.lineItems&&e.lineItems.length){var n=e.lineItems,r=!!window.ADMITAD;window.ADMITAD=window.ADMITAD||{},window.ADMITAD.Invoice=window.ADMITAD.Invoice||{};var i=(0,v.getProp)(t,"context.campaign"),o=this.getOption("utmSource"),a=void 0;a=i&&i.source===o?"adm":i&&i.source?i.source:"na",window.ADMITAD.Invoice.broker=a,window.ADMITAD.Invoice.category=(0,v.getProp)(t,"integrations.admitad.actionCode")||this.getOption("defaultActionCode")||"1";var s=[];n.forEach(function(e){s.push((0,f.default)({Product:{productID:(0,v.getProp)(e,"product.id"),category:(0,v.getProp)(e,"admitad.tariffCode")||"1",price:(0,v.getProp)(e,"product.unitSalePrice")||(0,v.getProp)(e,"product.unitPrice"),priceCurrency:(0,v.getProp)(e,"product.currency")||(0,v.getProp)(t,"website.currency")},orderQuantity:e.quantity||1,additionalType:"sale"}))});var c=(0,f.default)({orderNumber:e.orderId,discountCode:(e.vouchers||[]).join(","),orderedItem:s});window.ADMITAD.Invoice.referencesOrder=window.ADMITAD.Invoice.referencesOrder||[],window.ADMITAD.Invoice.referencesOrder.push(c);var u=this.getOption("crossDeviceTrackingId");if(u&&"none"!==u){var d=(0,v.getProp)(t,"user."+u);d&&(window.ADMITAD.Invoice.accountId=d)}r&&window.ADMITAD.Tracking.processPositions()}},e.prototype.trackSaleWithPixel=function(t,e){var n=t.transaction;if(n&&n.lineItems&&n.lineItems.length){this.setupPixel(t);var r=n.lineItems,i=1;r.forEach(function(o){window._admitadPositionsDD.push((0,f.default)({uid:e,order_id:n.orderId,position_id:i,client_id:(0,v.getProp)(t,"user.userId"),tariff_code:(0,v.getProp)(o,"admitad.tariffCode")||"1",currency_code:(0,v.getProp)(o,"product.currency")||(0,v.getProp)(t,"website.currency"),position_count:r.length,price:(0,v.getProp)(o,"product.unitSalePrice")||(0,v.getProp)(o,"product.unitPrice"),quantity:o.quantity||1,product_id:(0,v.getProp)(o,"product.id"),screen:s(),old_customer:!1===n.isFirst?1:0,coupon:n.vouchers&&n.vouchers.length?1:0,payment_type:O})),i+=1}),this.load("trackingPixel")}},e.prototype.setupPixel=function(t){window._admitadPixelDD={response_type:this.getOption("responseType"),action_code:(0,v.getProp)(t,"integrations.admitad.actionCode")||this.getOption("defaultActionCode"),campaign_code:this.getOption("campaignCode")},window._admitadPositionsDD=window._admitadPositionsDD||[]},e.prototype.trackLead=function(t,e){t.lead&&t.lead.id&&(this.setupPixel(t),window._admitadPositionsDD.push((0,f.default)({uid:e,order_id:(0,v.getProp)(t,"lead.id"),client_id:(0,v.getProp)(t,"user.userId"),tariff_code:(0,v.getProp)(t,"admitad.tariffCode")||"1",screen:s(),payment_type:"lead"})),this.load("trackingPixel"))},e.prototype.reTagPush=function(t){this.pageTracked||(window._retag.push({code:this.getOption("reTagCode"),level:t}),this.load("reTag"),this.pageTracked=!0)},e.prototype.onViewedPage=function(t){"home"===(t.page||{}).type&&this.reTagPush(0)},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.categoryId;if(n){window.ad_category=n;this.reTagPush(1)}},e.prototype.onViewedProductDetail=function(t){var e=t.product||{};window.ad_product=(0,f.default)({id:e.id,vendor:e.manufacturer||e.brand,price:e.unitSalePrice,url:e.url,picture:e.imageUrl,name:e.name,category:e.categoryId});this.reTagPush(2)},e.prototype.onViewedCart=function(t){var e=t.cart||{},n=e.lineItems||[];window.ad_products=n.map(function(t){return{id:(0,v.getProp)(t,"product.id"),number:t.quantity||1}});this.reTagPush(3)},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[],r=e.orderId,i=e.total;window.ad_order=r,window.ad_amount=i,window.ad_products=n.map(function(t){return{id:(0,v.getProp)(t,"product.id"),number:t.quantity||1}});this.reTagPush(4)},e}(T.default);n.default=S},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/topDomain":37,"js-cookie":102}],164:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/cleanObject"),u=r(c),d=t("../Integration"),l=r(d),p=t("../events/semanticEvents"),f=function(t){return(0,u.default)({id:t.id,name:t.name,brand:t.manufacturer||t.brand,category:Array.isArray(t.category)?t.category.join("/"):t.category,variant:t.variant,currency:t.currency,price:t.unitSalePrice})},g=function(t){function e(n,r){i(this,e);var a=o(this,t.call(this,n,r));return a.addTag({type:"script",attr:{src:"https://shopnetic.com/js/embed/loader.js"}}),a}return a(e,t),e.prototype.getEnrichableEventProps=function(t){switch(t.name){case p.VIEWED_PRODUCT_DETAIL:return["product"];case p.COMPLETED_TRANSACTION:return["transaction"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e,n=["product.id","product.name","product.manufacturer","product.category","product.variant","product.currency","product.unitSalePrice"];return(e={},e[p.VIEWED_PRODUCT_DETAIL]={fields:n},e[p.ADDED_PRODUCT]={fields:n},e[p.COMPLETED_TRANSACTION]={fields:["transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.manufacturer","transaction.lineItems[].product.category","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].product.currency","transaction.lineItems[].product.variant"]},e)[t.name]},e.prototype.getSemanticEvents=function(){return[p.VIEWED_PRODUCT_DETAIL,p.ADDED_PRODUCT,p.COMPLETED_TRANSACTION]},e.prototype.initialize=function(){!function(t,e,n){t[e]||(t[e]={}),t[e].run||(t[e].run=function(){t[e].q||(t[e].q=[]),t[e].q.push(arguments)})}(window,"antc")},e.prototype.isLoaded=function(){return!1},e.prototype.trackEvent=function(t){var e,n=(e={},e[p.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[p.ADDED_PRODUCT]="onAddedProduct",e[p.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedProductDetail=function(t){var e=t.product||{};window.antc.run("antc.track.ecommerce","detail",f(e))},e.prototype.onAddedProduct=function(t){var e=t.product||{};window.antc.run("antc.track.ecommerce","add",f(e))},e.prototype.onCompletedTransaction=function(t){((t.transaction||{}).lineItems||[]).forEach(function(t){var e=t.product||{};window.antc.run("antc.track.ecommerce","purchase",f(e))})},e}(l.default);n.default=g},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3}],165:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":p(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":p(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return t=t||[],t.map(function(t){var e=t.product||{};return e.category=e.category||[],(0,g.default)({id:e.id,name:e.name,price:e.unitSalePrice,quantity:t.quantity||1,categoryId:e.categoryId,categoryName:e.category[e.category.length-1],brand:e.manufacturer})})}function c(t){return t=t||[],t.map(function(t){return{id:t.id,name:t.name,price:t.unitSalePrice}})}function u(t){var e=t.categoryId,n=void 0;return n=Array.isArray(t.category)?t.category[t.category.length-1]:t.category,(0,g.default)({id:e,name:n})}function d(t){return{id:t.id,name:t.name,price:t.unitSalePrice,brand:t.manufacturer}}function l(t){if(t.email)return{email:t.email}}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var f=t("@segmentstream/utils/cleanObject"),g=r(f),m=t("@segmentstream/utils/noop"),h=r(m),y=t("@segmentstream/utils/topDomain"),v=r(y),E=t("@segmentstream/utils/normalizeString"),w=r(E),_=t("uuid/v1"),b=r(_),I=t("@segmentstream/utils/dotProp"),P=t("@segmentstream/utils/getQueryParam"),T=r(P),D=t("./utils/affiliate"),O=t("../events/semanticEvents"),C=t("../Integration"),S=r(C),A="advcake_trackid",k="advcake_url",R=function(t){function e(n,r){i(this,e),(0,D.normalizeOptions)(r);var a=Object.assign({trackIdCookieName:A,urlCookieName:k,cookieTracking:!0,cookieDomain:(0,v.default)(window.location.href),cookieTtl:90,deduplication:!1,utmSource:"advcake",deduplicationUtmMedium:[]},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{id:"advcakeAsync",src:"//code.acstat.com"}}),s}return a(e,t),e.prototype.getEnrichableEventProps=function(t){switch(t.name){case O.VIEWED_PAGE:return["page.type","cart","user.email","context.campaign"];case O.VIEWED_PRODUCT_DETAIL:return["product"];case O.COMPLETED_TRANSACTION:return["transaction","user.email"];case O.VIEWED_PRODUCT_LISTING:return["listing"];case O.VIEWED_CART:return["cart"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[O.VIEWED_PAGE]={fields:["page.type","user.email","cart.lineItems[].product.id","cart.lineItems[].product.name","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity","context.campaign.medium","context.campaign.source"],validations:{"page.type":{errors:["required","string"]}}},e[O.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.name","product.categoryId","product.category","product.unitSalePrice"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.categoryId":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},"product.unitSalePrice":{warnings:["required","numeric"]}}},e[O.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId","listing.category","listing.items[].id","listing.items[].name"],validations:{"listing.categoryId":{warnings:["required","string"]},"listing.category":{warnings:["required","array"]}}},e[O.COMPLETED_TRANSACTION]={fields:["user.email","transaction.orderId","transaction.total","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{warnings:["required","numeric"]},"transaction.lineItems[].product.id":{warnings:["required","string"]},"transaction.lineItems[].product.name":{warnings:["required","string"]},"transaction.lineItems[].product.categoryId":{warnings:["required","string"]},"transaction.lineItems[].product.category":{warnings:["required","array"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"transaction.lineItems[].quantity":{warnings:["required","numeric"]}}},e)[t.name]},e.prototype.getSemanticEvents=function(){return[O.VIEWED_PAGE,O.VIEWED_PRODUCT_DETAIL,O.VIEWED_PRODUCT_LISTING,O.COMPLETED_TRANSACTION,O.VIEWED_CART]},e.prototype.initialize=function(){window.advcake_push_data=window.advcake_push_data||h.default,window.advcake_order=window.advcake_order||function(t,e){window.advcake_order_id=t,window.advcake_order_price=e},this.addAffiliateCookies()},e.prototype.isLoaded=function(){return!!window.advcake_int},e.prototype.trackEvent=function(t){var e,n=(e={},e[O.VIEWED_PAGE]="onViewedPage",e[O.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[O.COMPLETED_TRANSACTION]="onCompletedTransaction",e[O.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[O.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.addAffiliateCookies=function(){if(this.getOption("cookieTracking")){var t=(0,w.default)(this.getOption("utmSource")),e=this.getOption("trackIdCookieName");if((0,T.default)("utm_source")===t){var n=this.getOption("urlCookieName"),r=this.getOption("cookieDomain"),i=this.getOption("cookieTtl"),o=(0,b.default)().replace(/-/g,"");(0,D.addAffiliateCookie)(e,o,i,r),(0,D.addAffiliateCookie)(n,window.location.href,i,r)}}},e.prototype.removeAffiliateCookies=function(){var t=this.getOption("cookieDomain"),e=this.getOption("urlCookieName"),n=this.getOption("trackIdCookieName");(0,D.removeAffiliateCookie)(n,t),(0,D.removeAffiliateCookie)(e,t)},e.prototype.onViewedPage=function(t){var e=t.page||{},n=(0,I.getProp)(t,"context.campaign")||{},r=n.source;this.cart=t.cart||{},this.user=t.user||{};var i=this.getOption("trackIdCookieName"),o=(0,w.default)(this.getOption("utmSource"));if(r&&r!==o&&(0,D.getAffiliateCookie)(i)){var a=this.getOption("deduplicationUtmMedium");(0,D.isDeduplication)(n,o,a)&&this.removeAffiliateCookies()}"home"===e.type?this.onViewedHome():"checkout"===e.type&&this.onViewedCheckoutPage()},e.prototype.onViewedHome=function(){window.advcake_data={pageType:1,user:l(this.user),basketProducts:s(this.cart.lineItems)},window.advcake_push_data(window.advcake_data)},e.prototype.onViewedProductDetail=function(t){window.advcake_data={pageType:2,user:l(this.user),currentCategory:u(t.product),currentProduct:d(t.product),basketProducts:s(this.cart.lineItems)},window.advcake_push_data(window.advcake_data)},e.prototype.onViewedProductListing=function(t){var e=t.listing||{};window.advcake_data={pageType:3,user:l(this.user),currentCategory:u(e),products:c(e.items),basketProducts:s(this.cart.lineItems)},window.advcake_push_data(window.advcake_data)},e.prototype.onViewedCart=function(){window.advcake_data={pageType:4,user:l(this.user),basketProducts:s(this.cart.lineItems)},window.advcake_push_data(window.advcake_data)},e.prototype.onViewedCheckoutPage=function(){window.advcake_data={pageType:5,user:l(this.user),basketProducts:s(this.cart.lineItems)},window.advcake_push_data(window.advcake_data)},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=(t.transaction.vouchers||[]).join(","),r={true:"new",false:"old"};window.advcake_data=(0,g.default)({pageType:6,user:l(t.user||this.user),basketProducts:s(e.lineItems),orderInfo:{id:e.orderId,totalPrice:e.total,promocodeName:n,promocodeValue:e.voucherDiscount,userType:r[e.isFirst]}}),window.advcake_push_data(window.advcake_data),window.advcake_order(e.orderId,e.total)},e}(S.default);n.default=R},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/noop":29,"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/topDomain":37,"uuid/v1":133}],166:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("../Integration"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=function(t){function e(n,o){r(this,e);var a=Object.assign({eventPixels:{}},o),s=i(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=Object.keys(s.getOption("eventPixels")),s._isLoaded=!1,s.addTag({type:"script",attr:{src:"//x01.aidata.io/pixel.js?pixel={{ pixelId }}&v="+Date.now()}}),s}return o(e,t),e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.reset=function(){},e.prototype.trackEvent=function(t){var e=this.getOption("eventPixels"),n=e[t.name];n&&this.load({pixelId:n})},e}(c.default);n.default=u},{"../Integration":143}],167:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("@segmentstream/utils/cleanObject"),d=r(u),l=t("../Integration"),p=r(l),f=t("./utils/AsyncQueue"),g=r(f),m=t("../events/semanticEvents"),h=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:""},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//cdn.diginetica.net/"+r.siteId+"/client.js?ts="+Date.now()}}),s}return a(e,t),e.prototype.getEnrichableEventProps=function(t){var e=["user.userId","user.anonymousId","website.type","website.regionId"];return t.name===m.VIEWED_PRODUCT_DETAIL?e.push("product"):t.name===m.VIEWED_PRODUCT_LISTING||t.name===m.SEARCHED_PRODUCTS?e.push("listing"):t.name===m.VIEWED_CART||t.name===m.STARTED_ORDER?e.push("cart"):t.name===m.COMPLETED_TRANSACTION&&e.push("cart","transaction"),e},e.prototype.getSemanticEvents=function(){return[m.VIEWED_PRODUCT_DETAIL,m.ADDED_PRODUCT,m.VIEWED_PRODUCT_LISTING,m.SEARCHED_PRODUCTS,m.VIEWED_CART,m.STARTED_ORDER,m.COMPLETED_TRANSACTION]},e.prototype.initialize=function(){this.asyncQueue=new g.default(this.isLoaded)},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.isLoaded=function(){return!(!window.Digi||!window.divolte)},e.prototype.trackEvent=function(t){var e,n=(e={},e[m.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[m.ADDED_PRODUCT]="onAddedProduct",e[m.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[m.SEARCHED_PRODUCTS]="onSearchedProducts",e[m.VIEWED_CART]="onViewedCart",e[m.STARTED_ORDER]="onStartedOrder",e[m.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.commonProps=function(t){return(0,d.default)({sessionId:(0,c.getProp)(t,"user.anonymousId"),userId:(0,c.getProp)(t,"user.userId"),regionId:(0,c.getProp)(t,"website.regionId"),channel:(0,c.getProp)(t,"website.type")})},e.prototype.productProps=function(t,e){return(0,d.default)({productId:t.id,productName:t.name,productBrand:t.manufacturer||t.brand,productDescription:t.description,breadcrumbs:t.category,availability:t.stock,sku:t.skuCode,price:t.unitPrice,salePrice:t.unitSalePrice,quantity:e})},e.prototype.cartProps=function(t,e){var n=this;return(0,d.default)({cartId:e,subtotal:t.subtotal,shippingCost:t.shippingCost,total:t.total,cartItems:t.lineItems.map(function(t){return n.productProps(t.product,t.quantity)})})},e.prototype.digiTrack=function(t,e,n){this.asyncQueue.push(function(){window.Digi.tracking.sendEvent(Object.assign({eventType:t},n,e))})},e.prototype.onViewedProductDetail=function(t){var e=t.product||{};this.digiTrack("PRODUCT_VIEW",this.productProps(e),this.commonProps(t))},e.prototype.onAddedProduct=function(t){var e=t.product||{};this.digiTrack("CART_ADD_EVENT",this.productProps(e,t.quantity),this.commonProps(t))},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.items||[];this.digiTrack("CATEGORY_VIEW",(0,d.default)({breadcrumbs:e.category,pageProducts:n.map(function(t){return t.id}),sorting:e.sortBy,count:n.length}),this.commonProps(t))},e.prototype.onSearchedProducts=function(t){var e=t.listing||{},n=e.items||[];this.digiTrack("SEARCH_EVENT",(0,d.default)({searchTerm:e.query,pageProducts:n.map(function(t){return t.id}),sorting:e.sortBy,count:n.length}),this.commonProps(t))},e.prototype.onViewedCart=function(t){var e=t.cart||{},n=t.user||{};this.digiTrack("CART_VIEW",this.cartProps(e,n.anonymousId),this.commonProps(t))},e.prototype.onStartedOrder=function(t){var e=t.cart||{},n=t.user||{},r=e.id||n.anonymousId;this.digiTrack("ORDER_VIEW",this.cartProps(e,r),this.commonProps(t))},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=t.cart||{},r=t.user||{},i=e.cartId||n.id||r.anonymousId;this.digiTrack("ORDER_SUCCESS",this.cartProps(e,i),this.commonProps(t))},e}(p.default);n.default=h},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7}],168:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("../IntegrationUtils"),l=t("@segmentstream/utils/dotProp"),p=t("@segmentstream/utils/size"),f=r(p),g=t("@segmentstream/utils/cleanObject"),m=r(g),h=t("../Integration"),y=r(h),v=t("./utils/AsyncQueue"),E=r(v),w=t("../events/semanticEvents"),_=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:"",customParams:void 0},r),s=o(this,t.call(this,n,a)),c=s.getOption("siteId");return s.addTag({type:"script",attr:{src:"//mod.calltouch.ru/init.js?id="+c,async:!0}}),s}return a(e,t),e.prototype.initialize=function(){var t=this;this.asyncQueue=new E.default(function(){return t.isLoaded()})},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.isLoaded=function(){return!!(0,l.getProp)(window,"ct_set_attrs")},e.prototype.reset=function(){(0,u.default)(window,"ct_set_attrs"),this.pageTracked=!1},e.prototype.getSemanticEvents=function(){return[w.VIEWED_PAGE]},e.prototype.getEnrichableEventProps=function(){return(0,d.getEnrichableVariableMappingProps)(this.getOption("customParams"))},e.prototype.getCustomParams=function(t){return(0,d.extractVariableMappingValues)(t,this.getOption("customParams"))},e.prototype.trackEvent=function(t){var e,n=(e={},e[w.VIEWED_PAGE]="onViewedPage",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.asyncQueue.push(function(){if(!e.pageTracked){var n=(0,m.default)(e.getCustomParams(t));(0,f.default)(n)&&window.ct_set_attrs(JSON.stringify(n)),e.pageTracked=!0}})},e}(y.default);n.default=_},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/size":36}],169:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){t.deduplication&&(t.utmSource&&(t.utmSource=(0,h.default)(t.utmSource)),t.deduplicationUtmMedium&&(t.deduplicationUtmMedium=t.deduplicationUtmMedium.map(h.default)))}function c(t){return t=t||[],t.map(function(t){var e=(0,g.getProp)(t,"product.category")||[],n=e[e.length-1];return{pid:(0,g.getProp)(t,"product.id"),pn:(0,g.getProp)(t,"product.name"),up:(0,g.getProp)(t,"product.unitSalePrice"),pc:n,qty:t.quantity,pd:t.totalDiscount}})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/getQueryParam"),l=r(d),p=t("@segmentstream/utils/topDomain"),f=r(p),g=t("@segmentstream/utils/dotProp"),m=t("@segmentstream/utils/normalizeString"),h=r(m),y=t("js-cookie"),v=r(y),E=t("../events/semanticEvents"),w=t("../Integration"),_=r(w),b="cityads_click_id",I=function(t){function e(n,r){i(this,e),s(r);var a=Object.assign({defaultTargetName:"",partnerId:"",clickIdCookieName:b,cookieTracking:!0,cookieDomain:(0,f.default)(window.location.href),cookieTtl:90,deduplication:!1,utmSource:"cityads",deduplicationUtmMedium:[]},r),c=o(this,t.call(this,n,a));return c._isLoaded=!1,c.addTag({type:"script",attr:{src:"https://cityadstrack.com/tr/js/{{ orderId }}/ct/{{ targetName }}/c/"+r.partnerId+"?click_id={{ clickId }}&customer_type={{ customerType }}&customer_id={{ customerId }}&payment_method={{ paymentMethod }}&order_total={{ orderTotal }}&currency={{ currency }}&coupon={{ coupon }}&discount={{ discount }}&basket={{ basket }}&md=2"}}),c}return a(e,t),e.prototype.initialize=function(){if(this._isLoaded=!0,this.getOption("cookieTracking")){var t=(0,h.default)(this.getOption("utmSource"));(0,l.default)("utm_source")===t&&this.addAffiliateCookie()}},e.prototype.addAffiliateCookie=function(){if(window.self===window.top){var t=(0,l.default)("click_id",null,!1),e=this.getOption("cookieTtl"),n=this.getOption("cookieDomain");t&&v.default.set(this.getOption("clickIdCookieName"),t,{expires:e,domain:n})}},e.prototype.getSemanticEvents=function(){return[E.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){return t.name===E.COMPLETED_TRANSACTION?["transaction","user.userId","website.currency","context.campaign"]:[]},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[E.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.category","transaction.lineItems[].product.unitSalePrice","context.campaign.source","context.campaign.medium","integrations.cityads.targetName"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{warnings:["required","string"]},"transaction.lineItems[].product.name":{warnings:["required","string"]},"transaction.lineItems[].product.category":{warnings:["required","array"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e=v.default.get(this.getOption("clickIdCookieName"));e&&(this.isDeduplication(t)||t.name===E.COMPLETED_TRANSACTION&&this.onCompletedTransaction(t,e))},e.prototype.isDeduplication=function(t){if(this.getOption("deduplication")){var e=(0,g.getProp)(t,"context.campaign.source");if(!e||e.toLowerCase()!==this.getOption("utmSource")){var n=this.getOption("deduplicationUtmMedium")||[];if(!n||0===n.length)return!0;var r=(0,g.getProp)(t,"context.campaign.medium");if(n.indexOf(r.toLowerCase())>=0)return!0}}return!1},e.prototype.onCompletedTransaction=function(t,e){var n=t.transaction;if(n&&n.orderId){var r=n.orderId,i=(0,g.getProp)(t,"targetName")||this.getOption("defaultTargetName"),o=n.isFirst?"new":"returned",a=n.paymentMethod,s=n.vouchers||[],u=s.join(","),d=n.vouchersDiscount,l=(0,g.getProp)(t,"user.userId"),p=n.shippingCost||0,f=n.total-p,m=n.currency;"RUB"===m&&(m="RUR");var h=n.lineItems||[],y=encodeURI(JSON.stringify(c(h)));this.load({orderId:r,clickId:e,orderTotal:f,targetName:i,customerType:o,paymentMethod:a,coupon:u,discount:d,currency:m,customerId:l,basket:y})}},e}(_.default);n.default=I},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/topDomain":37,"js-cookie":102}],170:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){return t.filter(function(t){return!!t.product&&!!t.product.id&&t.product.unitSalePrice>0}).map(function(t){return{id:e?t.product.skuCode:t.product.id,price:t.product.unitSalePrice,quantity:t.quantity||1}})}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/dotProp"),p=t("@segmentstream/utils/cleanObject"),f=r(p),g=t("@segmentstream/utils/semver"),m=r(g),h=t("@segmentstream/utils/normalizeString"),y=r(h),v=t("crypto-js/md5"),E=r(v),w=t("../Integration"),_=r(w),b=t("../events/semanticEvents"),I=[b.VIEWED_PAGE,b.VIEWED_PRODUCT_DETAIL,b.VIEWED_PRODUCT_LISTING,b.SEARCHED_PRODUCTS,b.VIEWED_CART,b.COMPLETED_TRANSACTION,b.SUBSCRIBED],P=function(t){function e(n,r){i(this,e);var a=Object.assign({account:"",customDeduplication:!1,userSegmentVar:void 0,feedWithGroupedProducts:!1,multiCurrency:!1},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//static.criteo.net/js/ld/ld.js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return I},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case b.VIEWED_PAGE:e=["website.type","user.email","user.emailHash","page.type"];break;case b.VIEWED_PRODUCT_DETAIL:e=["product"];break;case b.VIEWED_PRODUCT_LISTING:case b.SEARCHED_PRODUCTS:e=["listing.items"];break;case b.VIEWED_CART:e=["cart"];break;case b.COMPLETED_TRANSACTION:e=["context.campaign","transaction"]}var n=this.getOption("userSegmentVar");return n&&e.push(n),e},e.prototype.getEventValidationConfig=function(t){for(var e,n={},r=[],i=(0,l.getProp)(t,"listing.items.length")||0,o=0;o<Math.min(i,4);o+=1){var a=["listing.items",o,"id"].join(".");r.push(a),n[a]={errors:["required"],warnings:["string"]}}return(e={},e[b.VIEWED_PAGE]={fields:["website.type","page.type","user.email","user.emailHash"],validations:{"website.type":{warnings:["string"]},"page.type":{errors:["required","string"]},"user.email":{errors:["string"]},"user.emailHash":{errors:["string"]}}},e[b.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.skuCode"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[b.VIEWED_PRODUCT_LISTING]={fields:r,validations:n},e[b.SEARCHED_PRODUCTS]={fields:r,validations:n},e[b.VIEWED_CART]={fields:["cart.lineItems[].product.id","cart.lineItems[].product.skuCode","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]},"cart.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].quantity":{warnings:["required","numeric"]}}},e[b.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.skuCode","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity","transaction.isFirst","context.campaign.source"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].quantity":{warnings:["required","numeric"]},"transaction.isFirst":{warnings:["boolean"]},"context.campaign.source":{warnings:["string"]}}},e)[t.name]},e.prototype.getUserSegment=function(t){var e=this.getOption("userSegmentVar"),n=void 0;return e&&(n=(0,l.getProp)(t,e)),n},e.prototype.pushCriteoQueue=function(t,e){t&&(void 0!==e&&(t.user_segment=e),this.criteo_q.push((0,f.default)(t))),1===this.criteo_q.length?window.criteo_q.push(this.criteo_q[0]):window.criteo_q.push(this.criteo_q),this.criteo_q=[],this.pageTracked=!0},e.prototype.initialize=function(){window.criteo_q=window.criteo_q||[],this.criteo_q=[]},e.prototype.isLoaded=function(){return!(!window.criteo_q||Array.isArray(window.criteo_q))},e.prototype.reset=function(){(0,d.default)(window,"criteo_q")},e.prototype.getDeviceType=function(t){var e=void 0;if(t&&"adaptive"!==t&&"responsive"!==t)t&&(t=t.toLocaleLowerCase()),["desktop","tablet","mobile"].indexOf(t)<0&&(t="desktop"),e=t.charAt(0);else{var n=/iPad/.test(navigator.userAgent),r=/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent);e=n?"t":r?"m":"d"}return e},e.prototype.trackEvent=function(t){var e,n=(e={},e[b.VIEWED_PAGE]="onViewedPage",e[b.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[b.COMPLETED_TRANSACTION]="onCompletedTransaction",e[b.SEARCHED_PRODUCTS]="onViewedProductListing",e[b.VIEWED_CART]="onViewedCart",e[b.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[b.SUBSCRIBED]="onSubscribed",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1;var n=t.page,r=void 0;if(t.version&&n&&m.default.cmp(t.version,"1.1.0")<0?r=n.siteType:t.website&&(r=t.website.type),this.criteo_q.push({event:"setAccount",account:this.getOption("account")}),this.criteo_q.push({event:"setSiteType",type:this.getDeviceType(r)}),t.user){var i=void 0;if(t.user.emailHash)i=t.user.emailHash;else if(t.user.email){var o=(0,y.default)(t.user.email);i=(0,E.default)(o).toString()}this.criteo_q.push({event:"setEmail",email:i})}else this.criteo_q.push({event:"setEmail",email:""});this.pageTracked||setTimeout(function(){if(!e.pageTracked){var n={event:"viewHome"};e.pushCriteoQueue(n,e.getUserSegment(t))}},100)},e.prototype.onViewedProductListing=function(t){var e=t.listing;if(e&&e.items&&e.items.length){var n=e.items,r=[],i=3;n.length<3&&(i=n.length);for(var o=this.getOption("feedWithGroupedProducts"),a=0;a<i;a+=1){var s=o?n[a].skuCode:n[a].id;s&&r.push(s)}r.length>0&&this.pushCriteoQueue({event:"viewList",item:r},this.getUserSegment(t))}},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts")?e.skuCode:e.id;n&&this.pushCriteoQueue({event:"viewItem",item:n},this.getUserSegment(t))},e.prototype.onViewedCart=function(t){var e=t.cart;if(e&&e.lineItems&&e.lineItems.length>0){var n=s(e.lineItems,this.getOption("feedWithGroupedProducts"));n.length>0&&this.pushCriteoQueue({event:"viewBasket",currency:this.getOption("multiCurrency")?e.currency:void 0,item:n},this.getUserSegment(t))}},e.prototype.onCompletedTransaction=function(t){var e=t.transaction;if(e&&e.lineItems&&e.lineItems.length>0){var n=s(e.lineItems,this.getOption("feedWithGroupedProducts"));if(n.length>0){var r=this.getOption("customDeduplication"),i={event:"trackTransaction",id:e.orderId,currency:this.getOption("multiCurrency")?e.currency:void 0,new_customer:e.isFirst?1:0,item:n};if(r){var o=t.context;o&&o.campaign&&o.campaign.source&&o.campaign.source.toLocaleLowerCase().indexOf("criteo")>=0?i.deduplication=1:i.deduplication=0}this.pushCriteoQueue(i,this.getUserSegment(t))}}},e.prototype.onSubscribed=function(t){var e=t.user;if(e&&e.email){var n=(0,y.default)(e.email),r=(0,E.default)(n).toString();window.criteo_q.push({event:"setEmail",email:r})}},e}(_.default);n.default=P},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/semver":35,"crypto-js/md5":100}],171:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("crypto-js/sha256"),u=r(c),d=t("@segmentstream/utils/utmParams"),l=r(d),p=t("@segmentstream/utils/getQueryParam"),f=r(p),g=t("@segmentstream/utils/htmlGlobals"),m=r(g),h=t("@segmentstream/utils/cleanObject"),y=r(h),v=t("@segmentstream/utils/arrayMerge"),E=r(v),w=t("@segmentstream/utils/size"),_=r(w),b=t("@segmentstream/utils/isCrawler"),I=r(b),P=t("@segmentstream/utils/each"),T=r(P),D=t("@segmentstream/utils/safeConsole"),O=t("@segmentstream/utils/utmParamsFromReferrer"),C=r(O),S=t("./utils/isBeaconSupported"),A=t("uuid/v1"),k=r(A),R=t("ua-parser-js"),V=r(R),N=t("../Integration"),L=r(N),M=t("./DDManagerStreaming/Filters"),j=r(M),x=t("../variableTypes"),U=t("../events/semanticEvents"),q=function(t){function e(n,r){i(this,e);var a=Object.assign({projectId:"",projectName:"",buildNumber:1,trackingUrl:"https://track.segmentstream.com/collect",dimensions:{},metrics:{},internal:!1,streamingEndpoints:[]},r),s=o(this,t.call(this,n,a));return s.website={},s.dimensions={},s.metrics={},s.productDimensions={},s.productMetrics={},s.customEnrichableProps=[],s.viewedPageCounter=0,(0,T.default)(a.dimensions,function(t,e){e.type===x.PRODUCT_VAR?s.productDimensions[t]=e.value:(e.type===x.DIGITALDATA_VAR&&s.customEnrichableProps.push(e.value),s.dimensions[t]=e.value)}),(0,T.default)(a.metrics,function(t,e){e.type===x.PRODUCT_VAR?s.productMetrics[t]=e.value:(e.type===x.DIGITALDATA_VAR&&s.customEnrichableProps.push(e.value),s.metrics[t]=e.value)}),s.filters=new j.default(s.dimensions,s.metrics,s.productDimensions,s.productMetrics),s.setupStreamingEndpoints(),s}return a(e,t),e.prototype.setupStreamingEndpoints=function(){var t=this.getOption("streamingEndpoints")||[],e=this.getOption("trackingUrl");e&&t.unshift(e),this.streamingEndpoints=t.filter(function(t){return t.match(/^(https?):\/\/[^ "]+$/)})},e.prototype.initialize=function(){return this._isLoaded=!0,!(0,I.default)(m.default.getNavigator().userAgent)},e.prototype.getIgnoredEvents=function(){return this.getOption("internal")?[U.VIEWED_PRODUCT,U.CLICKED_PRODUCT,U.INTEGRATION_VALIDATION_FAILED,U.EXCEPTION]:[]},e.prototype.getEnrichableEventProps=function(t){var e,n=(e={},e[U.VIEWED_PAGE]=["page","user.userId","user.anonymousId","user.email","website"],e[U.VIEWED_CART]=["cart"],e[U.COMPLETED_TRANSACTION]=["transaction"],e[U.VIEWED_PRODUCT_DETAIL]=["product"],e[U.VIEWED_PRODUCT_LISTING]=["listing"],e[U.SEARCHED_PRODUCTS]=["listing"],e),r=n[t.name]||[];return(0,E.default)(r,this.customEnrichableProps),r},e.prototype.getValidationFields=function(){for(var t={website:M.websiteProps,page:M.pageProps,cart:[].concat(M.cartProps,["vouchers"]),listing:M.listingProps,transaction:[].concat(M.transactionProps,["vouchers"]),product:M.productProps,campaign:M.campaignProps,listItem:M.listItemProps,experiment:["id","name","variationId","variationName"]},e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=Array.isArray(n)?n.reduce(function(e,n){return t[n].forEach(function(t){e.push([n,t].join(".")),"campaign"===n?e.push(["campaigns[]",t].join(".")):"listItem"===n&&e.push(["listItems[]",t].join("."))}),e},[]):[];return(0,E.default)(i,this.customEnrichableProps),(0,E.default)(i,["category","label"]),i},e.prototype.getEventValidationConfig=function(t){var e,n=this,r=function(){return n.getValidationFields("product")},i=(e={},e[U.VIEWED_PAGE]={fields:this.getValidationFields("page","website")},e[U.VIEWED_CART]={fields:this.getValidationFields("cart")},e[U.COMPLETED_TRANSACTION]={fields:this.getValidationFields("transaction")},e[U.VIEWED_PRODUCT_DETAIL]={fields:r},e[U.ADDED_PRODUCT]={fields:r},e[U.REMOVED_PRODUCT]={fields:r},e[U.ADDED_PRODUCT_TO_WISHLIST]={fields:r},e[U.REMOVED_PRODUCT_FROM_WISHLIST]={fields:r},e[U.VIEWED_PRODUCT_LISTING]={fields:this.getValidationFields("listing")},e[U.SEARCHED_PRODUCTS]={fields:this.getValidationFields("listing")},e[U.VIEWED_CAMPAIGN]={fields:this.getValidationFields("campaign")},e[U.CLICKED_CAMPAIGN]={fields:this.getValidationFields("campaign")},e[U.VIEWED_PRODUCT]={fields:this.getValidationFields("listItem")},e[U.CLICKED_PRODUCT]={fields:this.getValidationFields("listItem")},e[U.VIEWED_EXPERIMENT]={fields:this.getValidationFields("experiment")},e),o=i[t.name]||{};return"function"==typeof o.fields?o.fields=o.fields():o.fields=o.fields||this.getValidationFields(),o},e.prototype.allowCustomEvents=function(){return!0},e.prototype.getCampaign=function(t,e){var n=(0,l.default)(e),r=(0,f.default)("gclid"),i=(0,f.default)("yclid"),o=(0,f.default)("ymclid");return(0,_.default)(n)||(r&&(n.source="google"),i&&(n.source="yandex"),o&&(n.source="yandex_market"),(r||i||o)&&(n.medium="cpc")),(0,_.default)(n)||(n=(0,C.default)(t)),n},e.prototype.normalize=function(t){var e=(0,k.default)(),n=this.viewedPageCounter<2?m.default.getDocument():{},r=n.referrer,i=m.default.getLocation(),o=i.search,a=i.href,s=i.hash,c=i.pathname,u=this.getCampaign(r,o);try{c=c?decodeURIComponent(c):void 0}catch(t){(0,D.warn)(t)}try{r=r?decodeURI(r):void 0}catch(t){(0,D.warn)(t)}try{o=o?decodeURIComponent(o):void 0}catch(t){(0,D.warn)(t)}try{a=a?decodeURI(a):void 0}catch(t){(0,D.warn)(t)}try{s=s?decodeURIComponent(s):void 0}catch(t){(0,D.warn)(t)}var d=m.default.getDocument(),l=d.title,p=new V.default,f=p.getBrowser(),g=Object.assign({type:"desktop"},(0,y.default)(p.getDevice())),h=(0,y.default)({hitId:e,projectId:this.getOption("projectId"),projectName:this.getOption("projectName"),anonymousId:this.getAnonymousId(),userId:this.getUserId(),emailHash:this.getEmailHash(),context:{campaign:(0,_.default)(u)?u:void 0,library:this.library,page:{path:c,referrer:r,search:o,title:l,url:a,hash:s},userAgent:m.default.getNavigator().userAgent,browser:f,device:g,screenWidth:window.screen?window.screen.width:void 0,screenHeight:window.screen?window.screen.height:void 0},sentAt:(new Date).toISOString(),version:this.getOption("buildNumber")});return Object.assign(t,h)},e.prototype.setAnonymousId=function(t){this.anonymousId=t},e.prototype.getAnonymousId=function(){return this.anonymousId},e.prototype.getUserId=function(){return this.userId},e.prototype.setUserId=function(t){this.userId=t},e.prototype.getEmailHash=function(){return this.emailHash},e.prototype.setEmailHash=function(t){this.emailHash=t},e.prototype.trackEvent=function(t){if((0,_.default)(t.user)){var e=t.user||{};e.email&&this.setEmailHash((0,u.default)(e.email.trim()).toString()),e.anonymousId&&this.setAnonymousId(e.anonymousId),e.userId&&this.setUserId(String(e.userId))}t.name===U.VIEWED_PAGE&&t.website&&(this.website=this.filters.filterWebsite(t.website)),t.name===U.VIEWED_PAGE&&(this.viewedPageCounter+=1),this.sendEventHit(t)},e.prototype.sendEventHit=function(t){var e=this.normalize({event:this.filters.filterEventHit(t),website:this.website,type:"event"});this.send(e)},e.prototype.getCacheKey=function(){return["ddm","stream",this.projectId].join(":")},e.prototype.send=function(t){this.streamingEndpoints.forEach(function(e){(0,S.isBeaconSupported)(window.navigator)?navigator.sendBeacon(e,JSON.stringify(t)):window.fetch(e,{method:"post",credentials:"include",mode:"cors",body:JSON.stringify(t)}).then(function(t){}).catch(function(t){(0,D.warn)(t)})})},e}(L.default);n.default=q},{"../Integration":143,"../events/semanticEvents":158,"../variableTypes":231,"./DDManagerStreaming/Filters":172,"./utils/isBeaconSupported":217,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/each":8,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/htmlGlobals":17,"@segmentstream/utils/isCrawler":19,"@segmentstream/utils/safeConsole":33,"@segmentstream/utils/size":36,"@segmentstream/utils/utmParams":39,"@segmentstream/utils/utmParamsFromReferrer":40,"crypto-js/sha256":101,"ua-parser-js":130,"uuid/v1":133}],172:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,n){var r=[];return(0,p.default)(e,function(e,i){var o=(0,d.getProp)(t,i);void 0!==o&&null!==o&&(n===m&&"number"!=typeof o?o=Number(o):n===h&&"string"!=typeof o&&(o=o.toString()),r.push({name:e,value:o}))}),r}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.listItemProps=n.campaignProps=n.transactionProps=n.cartProps=n.listingProps=n.productProps=n.websiteProps=n.pageProps=n.CUSTOM_TYPE_STRING=n.CUSTOM_TYPE_NUMERIC=void 0;var s="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(t){return void 0===t?"undefined":a(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":a(t)};n.extractCustoms=o;var c=t("@segmentstream/utils/cleanObject"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("@segmentstream/utils/each"),p=r(l),f=t("@segmentstream/utils/safeConsole"),g=t("../../events/semanticEvents"),m=n.CUSTOM_TYPE_NUMERIC="number",h=n.CUSTOM_TYPE_STRING="string",y=n.pageProps=["name","category","type","breadcrumb","url","path","queryString","title","hash"],v=n.websiteProps=["type","region","regionId","language","currency","environment"],E=n.productProps=["id","name","currency","unitSalePrice","unitPrice","category","categoryId","url","imageUrl","thumbnailUrl","manufacturer","skuCode","stock","voucher","color","size","customDimensions","customMetrics"],w=n.listingProps=["listId","listName","categoryId","category","query","resultCount","pagesCount","currentPage","sortBy","layout"],_=[].concat(E.map(function(t){return["product",t].join(".")}),["quantity","subtotal"]),b=n.cartProps=[].concat(_.map(function(t){return["lineItems[]",t].join(".")}),["id","total","subtotal","currency","voucher","voucherDiscount","shippingCost","paymentMethod"]),I=n.transactionProps=[].concat(_.map(function(t){return["lineItems[]",t].join(".")}),["total","subtotal","currency","voucher","status","voucherDiscount","shippingCost","paymentMethod","orderId","isFirst"]),P=n.campaignProps=["id","name","category","subcategory","design","position"],T=(n.listItemProps=[].concat(E.map(function(t){return["product",t].join(".")}),["position","listId"]),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={};return e.forEach(function(e){void 0!==t[e]&&n.indexOf(e)<0&&(r[e]=t[e])}),r}),D=function(){function t(e,n,r,o){i(this,t),this.dimensions=e,this.metrics=n,this.productDimensions=r,this.productMetrics=o}return t.prototype.filterEventHit=function(t){var e,n=(e={},e[g.VIEWED_PAGE]=this.filterViewedPage.bind(this),e[g.VIEWED_PRODUCT_DETAIL]=this.filterViewedProductDetail.bind(this),e[g.ADDED_PRODUCT]=this.filterAddedProduct.bind(this),e[g.REMOVED_PRODUCT]=this.filterRemovedProduct.bind(this),e[g.ADDED_PRODUCT_TO_WISHLIST]=this.filterAddedProductToWishlist.bind(this),e[g.REMOVED_PRODUCT_FROM_WISHLIST]=this.filterRemovedProductFromWishlist.bind(this),e[g.VIEWED_CART]=this.filterViewedCart.bind(this),e[g.COMPLETED_TRANSACTION]=this.filterCompletedTransaction.bind(this),e[g.UPDATED_TRANSACTION]=this.filterUpdatedTransaction.bind(this),e[g.REFUNDED_TRANSACTION]=this.filterRefundedTransaction.bind(this),e[g.VIEWED_CHECKOUT_STEP]=this.filterViewedCheckoutStep.bind(this),e[g.COMPLETED_CHECKOUT_STEP]=this.filterCompeltedCheckoutStep.bind(this),e[g.VIEWED_PRODUCT_LISTING]=this.filterViewedProductListing.bind(this),e[g.SEARCHED_PRODUCTS]=this.filterSearchedProducts.bind(this),e[g.VIEWED_CAMPAIGN]=this.filterViewedCampaign.bind(this),e[g.CLICKED_CAMPAIGN]=this.filterClickedCampaign.bind(this),e[g.VIEWED_PRODUCT]=this.filterViewedProduct.bind(this),e[g.CLICKED_PRODUCT]=this.filterClickedProduct.bind(this),e[g.VIEWED_EXPERIMENT]=this.filterViewedExperiment.bind(this),e);return t.name&&n[t.name]?n[t.name](t):this.filterCommonEvent(t)},t.prototype.filterProduct=function(t){if(t){var e=o(t,this.productDimensions,h),n=o(t,this.productMetrics,m),r=t.category;return r&&(r=Array.isArray(r)?r.join("/"):"object"===(void 0===r?"undefined":s(r))?Object.keys(r).map(function(t){return r[t]}).join("/"):String(r)),T(Object.assign({},t,{id:t.id?String(t.id):void 0,skuCode:t.skuCode?String(t.skuCode):void 0,categoryId:t.categoryId?String(t.categoryId):void 0,category:r,size:t.size?String(t.size):void 0,unitPrice:t.unitPrice?Number(t.unitPrice):void 0,unitSalePrice:t.unitSalePrice?Number(t.unitSalePrice):void 0,manufacturer:t.manufacturer?t.manufacturer:t.brand,imageUrl:"string"==typeof t.imageUrl?t.imageUrl:void 0,url:"string"==typeof t.url?t.url:void 0,customDimensions:e,customMetrics:n}),E)}},t.prototype.filterListing=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(Object.assign({},t,{query:t.query?String(t.query):void 0,categoryId:t.categoryId?String(t.categoryId):void 0,category:t.category&&Array.isArray(t.category)?t.category.join("/"):String(t.category)}),w)},t.prototype.filterLineItems=function(){var t=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return(0,u.default)({product:t.filterProduct(e.product),quantity:isNaN(Number(e.quantity))?1:Number(e.quantity),subtotal:isNaN(Number(e.subtotal))?void 0:Number(e.subtotal)})})},t.prototype.filterListItems=function(){var t=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return(0,u.default)({product:t.filterProduct(e.product),position:void 0!==e.position?Number(e.position):void 0,listId:e.listId?String(e.listId):void 0})})},t.prototype.filterCampaigns=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){return T(Object.assign({},t,{position:void 0!==t.position?String(t.position):void 0}),P)})},t.prototype.filterCart=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(Object.assign({},t,{id:t.id?String(t.id):void 0,voucher:Array.isArray(t.vouchers)?t.vouchers.toString():void 0}),b)},t.prototype.filterTransaction=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(Object.assign({},t,{isFirst:"boolean"==typeof t.isFirst?t.isFirst:void 0,orderId:t.orderId?String(t.orderId):void 0,voucher:Array.isArray(t.vouchers)?t.vouchers.toString():void 0,status:t.status?String(t.status):void 0}),I)},t.prototype.filterPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.url,n=t.queryString;try{e=e?decodeURI(e):void 0}catch(t){(0,f.warn)(t)}try{n=n?decodeURI(n):void 0}catch(t){(0,f.warn)(t)}return T({type:t.type?String(t.type):void 0,name:t.name?String(t.name):void 0,category:t.category?String(t.category):void 0,breadcrumb:t.breadcrumb&&Array.isArray(t.breadcrumb)?t.breadcrumb.join("/"):t.breadcrumb,url:e,path:t.path?String(t.path):void 0,queryString:n,hash:t.hash?t.hash:void 0,title:t.title?t.title:void 0},y)},t.prototype.filterWebsite=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(Object.assign({},t,{regionId:t.regionId?String(t.regionId):void 0}),v)},t.prototype.filterExperiment=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.default)({id:t.id,name:t.name,variantId:void 0!==t.variationId?String(t.variationId):void 0,variantName:t.variationName})},t.prototype.filterViewedPage=function(t){var e=this.filterCommonEvent(t);return Object.assign({},e,{page:this.filterPage(t.page)})},t.prototype.filterViewedProductDetail=function(t){var e=this.filterCommonEvent(t),n=this.filterProduct(t.product);return Object.assign({},e,{product:n})},t.prototype.filterAddedProduct=function(t){var e=this.filterCommonEvent(t),n=Number(t.quantity);return Object.assign({},e,{product:this.filterProduct(t.product),quantity:isNaN(n)?1:n})},t.prototype.filterRemovedProduct=function(t){return this.filterAddedProduct(t)},t.prototype.filterAddedProductToWishlist=function(t){var e=this.filterCommonEvent(t);return Object.assign({},e,{product:this.filterProduct(t.product)})},t.prototype.filterRemovedProductFromWishlist=function(t){return this.filterAddedProductToWishlist(t)},t.prototype.filterViewedCheckoutStep=function(t){var e=this.filterCommonEvent(t),n=Number(t.step);return Object.assign({},e,{step:isNaN(n)?void 0:n})},t.prototype.filterCompeltedCheckoutStep=function(t){return this.filterViewedCheckoutStep(t)},t.prototype.filterViewedCart=function(t){var e=this.filterCommonEvent(t),n=this.filterCart(t.cart);return n.lineItems=this.filterLineItems((0,d.getProp)(t,"cart.lineItems")),Object.assign({},e,{cart:n})},t.prototype.filterCompletedTransaction=function(t){var e=this.filterCommonEvent(t),n=this.filterTransaction(t.transaction);return n.lineItems=this.filterLineItems((0,d.getProp)(t,"transaction.lineItems")),Object.assign({},e,{transaction:n})},t.prototype.filterUpdatedTransaction=function(t){return this.filterCompletedTransaction(t)},t.prototype.filterRefundedTransaction=function(t){return this.filterCompletedTransaction(t)},t.prototype.filterViewedProductListing=function(t){var e=this.filterCommonEvent(t),n=this.filterListing(t.listing);return Object.assign({},e,{listing:n})},t.prototype.filterSearchedProducts=function(t){return this.filterViewedProductListing(t)},t.prototype.filterViewedCampaign=function(t){var e=this.filterCommonEvent(t),n=void 0;return t.campaign?n=[t.campaign]:t.campaigns&&(n=t.campaigns),n?Object.assign({},e,{campaigns:this.filterCampaigns(n)}):e},t.prototype.filterViewedProduct=function(t){var e=this.filterCommonEvent(t),n=void 0;return t.listItem?n=[t.listItem]:t.listItems&&(n=t.listItems),n?Object.assign({},e,{listItems:this.filterListItems(n)}):e},t.prototype.filterClickedProduct=function(t){return this.filterViewedProduct(t)},t.prototype.filterClickedCampaign=function(t){return this.filterViewedCampaign(t)},t.prototype.filterViewedExperiment=function(t){var e=this.filterCommonEvent(t),n=this.filterExperiment(t.experiment);return Object.assign({},e,{experiment:n})},t.prototype.filterCommonEvent=function(t){var e=o(t,this.dimensions,h),n=o(t,this.metrics,m);return e.length&&(t.customDimensions=e),n.length&&(t.customMetrics=n),(0,u.default)({name:t.name?String(t.name):void 0,nonInteraction:"boolean"==typeof t.nonInteraction?t.nonInteraction:void 0,category:t.category?String(t.category):void 0,label:t.label?String(t.label):void 0,customDimensions:t.customDimensions,customMetrics:t.customMetrics})},t}();n.default=D},{"../../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8,"@segmentstream/utils/safeConsole":33}],173:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/cleanObject"),u=r(c),d=t("../IntegrationUtils"),l=t("../Integration"),p=r(l),f=function(t){function e(n,r){i(this,e);var a=Object.assign({events:[]},r),s=o(this,t.call(this,n,a));return s.enrichableEventProps=[],s.SEMANTIC_EVENTS=[],s.getOption("events").forEach(function(t){var e=t.event,n=t.customVars;if(e){var r=(0,d.getEnrichableVariableMappingProps)(n).filter(function(t,e,n){return n.indexOf(t)===e});s.enrichableEventProps[e]=(s.enrichableEventProps[e]||[]).concat(r),s.SEMANTIC_EVENTS.push(e)}}),s.addTag({type:"script",attr:{src:"https://www.googletagmanager.com/gtag/js"}}),s}return a(e,t),e.prototype.initialize=function(){window.dataLayer=window.dataLayer||[],window.gtag||(window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date)),this.getOption("events").map(function(t){return t.floodlightConfigID}).filter(function(t,e,n){return n.indexOf(t)===e}).forEach(function(t){window.gtag("config","DC-"+t)})},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){return this.enrichableEventProps[t.name]||[]},e.prototype.trackEvent=function(t){var e=this;this.getOption("events").filter(function(e){return e.event===t.name}).forEach(function(n){var r=n.floodlightConfigID,i=n.activityGroupTagString,o=n.activityTagString,a=n.countingMethod,s=n.customVars,c=(0,d.extractVariableMappingValues)(t,s),u={allow_custom_scripts:!0,send_to:"DC-"+r+"/"+i+"/"+o+"+"+a},l=u,p="conversion";"transactions"===a&&(l=Object.assign(u,e.getPurchaseTagParams(t.transaction)),p="purchase"),l=Object.assign(l,c),window.gtag("event",p,l)})},e.prototype.getPurchaseTagParams=function(t){if(t)return(0,u.default)({transaction_id:t.orderId,value:t.total||t.subtotal})},e}(p.default);n.default=f},{"../Integration":143,"../IntegrationUtils":144,"@segmentstream/utils/cleanObject":3}],174:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){if("object"!==(void 0===t?"undefined":u(t))){if(t)return{id:t}}else if(t.id)return t}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u="function"==typeof Symbol&&"symbol"===c(Symbol.iterator)?function(t){return void 0===t?"undefined":c(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":c(t)},d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/noop"),f=r(p),g=t("../Integration"),m=r(g),h=t("../events/semanticEvents"),y=function(t){function e(n,r){i(this,e);var a=Object.assign({websiteToken:""},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[h.VIEWED_PAGE,h.VIEWED_EXPERIMENT,h.ACHIEVED_EXPERIMENT_GOAL],s.addTag({type:"script",attr:{id:"driveback-sdk",src:"//cdn.driveback.ru/js/loader.js"}}),s}return a(e,t),e.prototype.getEventValidationConfig=function(t){var e,n=void 0,r=void 0;return"string"==typeof t.experiment?(n=["experiment"],r={experiment:{errors:["required","string"]}}):(n=["experiment.id","experiment.variationId"],r={"experiment.id":{errors:["required","string"]},"experiment.variationId":{errors:["numeric"]}}),(e={},e[h.VIEWED_EXPERIMENT]={fields:n,validations:r},e[h.ACHIEVED_EXPERIMENT_GOAL]={fields:n,validations:r},e)[t.name]},e.prototype.initialize=function(){var t=this;window.DrivebackNamespace="Driveback",window.Driveback=window.Driveback||{},window.DrivebackOnLoad=window.DrivebackOnLoad||[],window.Driveback.initStubCalled=!1,window.Driveback.init=function(){window.Driveback.initStubCalled=!0},window.DrivebackLoaderAsyncInit=function(){window.Driveback.Loader.init(t.getOption("websiteToken"))},window.DrivebackAsyncInit=f.default},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.trackEvent=function(t){if(t.name===h.VIEWED_PAGE)this.onViewedPage();else if(t.name===h.VIEWED_EXPERIMENT){var e=s(t.experiment);if(!e)return;void 0!==e.variationId&&window.DrivebackOnLoad.push(function(){window.dbex("setVariation",e.id,e.variationId)}),window.DrivebackOnLoad.push(function(){window.dbex("trackSession",e.id)})}else if(t.name===h.ACHIEVED_EXPERIMENT_GOAL){var n=s(t.experiment);if(!n)return;window.DrivebackOnLoad.push(function(){window.dbex("trackConversion",n.id,t.value)})}},e.prototype.onViewedPage=function(){window.Driveback.initInvoked?window.DriveBack.newPage?window.DriveBack.newPage():window.DriveBack.reactivateCampaigns():window.Driveback.init()},e.prototype.isLoaded=function(){return!(!window.Driveback||!window.Driveback.Loader)},e.prototype.reset=function(){(0,l.default)(window,"Driveback"),(0,l.default)(window,"DriveBack"),(0,l.default)(window,"DrivebackNamespace"),(0,l.default)(window,"DrivebackOnLoad"),(0,l.default)(window,"DrivebackLoaderAsyncInit"),(0,l.default)(window,"DrivebackAsyncInit"),(0,l.default)(window,"dbex")},e}(m.default);n.default=y},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/noop":29}],175:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.CART_PAGE_TYPE=n.LISTING_PAGE_TYPE=n.PRODUCT_PAGE_TYPE=n.OTHER_PAGE_TYPE=n.HOME_PAGE_TYPE=void 0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("crypto-js/sha256"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("@segmentstream/utils/cleanObject"),g=r(f),m=t("../Integration"),h=r(m),y=t("../events/semanticEvents"),v=t("./utils/AsyncQueue"),E=r(v),w=n.HOME_PAGE_TYPE="HOMEPAGE",_=n.OTHER_PAGE_TYPE="OTHER",b=n.PRODUCT_PAGE_TYPE="PRODUCT",I=n.LISTING_PAGE_TYPE="CATEGORY",P=n.CART_PAGE_TYPE="CART",T=[y.VIEWED_PAGE,y.VIEWED_PRODUCT_DETAIL,y.VIEWED_PRODUCT_LISTING,y.VIEWED_CART,y.ADDED_PRODUCT,y.COMPLETED_TRANSACTION,y.LOGGED_IN,y.REGISTERED,y.SUBSCRIBED],D=function(t){function e(n,r){i(this,e);var a=Object.assign({accountId:"",feedWithGroupedProducts:!1},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{async:!0,src:"//cdn.dynamicyield.com/api/"+r.accountId+"/api_dynamic.js"}}),s.addTag("staticScript",{type:"script",attr:{async:!0,src:"//cdn.dynamicyield.com/api/"+r.accountId+"/api_static.js"}}),s}return a(e,t),e.prototype.initialize=function(){var t=this;window.DY=window.DY||{},this.asyncQueue=new E.default(function(){return t.isLoaded()})},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.isLoaded=function(){return!!(0,p.getProp)(window,"DY.API")},e.prototype.reset=function(){(0,u.default)(window,"DY")},e.prototype.trackPage=function(t){window.DY.recommendationContext||(window.DY.recommendationContext=t,this.load("staticScript"),this.pageTracked=!0)},e.prototype.getSemanticEvents=function(){return T},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case y.VIEWED_PAGE:return["page.type"];case y.VIEWED_PRODUCT_DETAIL:return["page.type","product"];case y.VIEWED_PRODUCT_LISTING:return["page.type","listing.category"];case y.VIEWED_CART:return["page.type","cart.lineItems"];case y.ADDED_PRODUCT:return["product","cart"];case y.COMPLETED_TRANSACTION:return["transaction"];case y.LOGGED_IN:case y.REGISTERED:return["user.userId","user.email"];case y.SUBSCRIBED:return["user.email"];default:return[]}},e.prototype.getProductId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getOption("feedWithGroupedProducts")?t.skuCode:t.id},e.prototype.getLineItemIds=function(t){var e=this;return t.map(function(t){return e.getProductId(t.product)})},e.prototype.getLineItems=function(t){var e=this;return t.map(function(t){return(0,g.default)({productId:e.getProductId(t.product),quantity:t.quantity,itemPrice:(0,p.getProp)(t,"product.unitSalePrice"),size:(0,p.getProp)(t,"product.size")})})},e.prototype.getRecommendationContext=function(t){return(0,g.default)({type:this.getContextType(t),data:this.getContextData(t)})},e.prototype.getContextType=function(t){var e;return(e={},e[y.VIEWED_PAGE]="home"===(0,p.getProp)(t,"page.type")?w:_,e[y.VIEWED_PRODUCT_DETAIL]=b,e[y.VIEWED_PRODUCT_LISTING]=I,e[y.VIEWED_CART]=P,e)[t.name]},e.prototype.getContextData=function(t){var e;return(e={},e[y.VIEWED_PRODUCT_DETAIL]=[this.getProductId((0,p.getProp)(t,"product"))],e[y.VIEWED_PRODUCT_LISTING]=(0,p.getProp)(t,"listing.category"),e[y.VIEWED_CART]=this.getLineItemIds((0,p.getProp)(t,"cart.lineItems")||[]),e)[t.name]},e.prototype.trackEvent=function(t){var e,n=(e={},e[y.VIEWED_PAGE]="onViewedPage",e[y.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[y.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[y.VIEWED_CART]="onViewedCart",e[y.ADDED_PRODUCT]="onAddedProduct",e[y.COMPLETED_TRANSACTION]="onCompletedTransaction",e[y.LOGGED_IN]="onLoggedIn",e[y.REGISTERED]="onRegistered",e[y.SUBSCRIBED]="onSubscribed",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;setTimeout(function(){e.pageTracked||e.trackPage(e.getRecommendationContext(t))},100)},e.prototype.onViewedProductDetail=function(t){var e=this.getRecommendationContext(t);this.trackPage(e)},e.prototype.onViewedProductListing=function(t){var e=this.getRecommendationContext(t);this.trackPage(e)},e.prototype.onViewedCart=function(t){var e=this.getRecommendationContext(t);this.trackPage(e)},e.prototype.onAddedProduct=function(t){var e=this;this.asyncQueue.push(function(){window.DY.API("event",{name:"Add to Cart",properties:{dyType:"add-to-cart-v1",value:(0,p.getProp)(t,"cart.total"),currency:(0,p.getProp)(t,"cart.currency"),productId:(0,p.getProp)(t,"product.id"),quantity:(0,p.getProp)(t,"quantity"),cart:e.getLineItems((0,p.getProp)(t,"cart.lineItems")||[])}})})},e.prototype.onCompletedTransaction=function(t){var e=this;this.asyncQueue.push(function(){window.DY.API("event",{name:"Purchase",properties:{dyType:"purchase-v1",uniqueTransactionId:(0,p.getProp)(t,"transaction.orderId"),value:(0,p.getProp)(t,"transaction.total"),currency:(0,p.getProp)(t,"transaction.currency"),cart:e.getLineItems((0,p.getProp)(t,"transaction.lineItems"))}})})},e.prototype.onLoggedIn=function(t){this.asyncQueue.push(function(){window.DY.API("event",{name:"Login",properties:{dyType:"login-v1",hashedEmail:(0,l.default)((0,p.getProp)(t,"user.email")).toString(),cuid:(0,p.getProp)(t,"user.userId"),cuidType:"userId"}})})},e.prototype.onRegistered=function(t){this.asyncQueue.push(function(){window.DY.API("event",{name:"Signup",properties:{dyType:"signup-v1",hashedEmail:(0,l.default)((0,p.getProp)(t,"user.email")).toString(),cuid:(0,p.getProp)(t,"user.userId"),cuidType:"userId"}})})},e.prototype.onSubscribed=function(t){this.asyncQueue.push(function(){window.DY.API("event",{name:"Newsletter Subscription",properties:{dyType:"newsletter-subscription-v1",hashedEmail:(0,l.default)((0,p.getProp)(t,"user.email")).toString()}})})},e}(h.default);n.default=D},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"crypto-js/sha256":101}],176:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=t.product;return(e.unitSalePrice||e.unitPrice||0)*(t.quantity||1)}function c(t){return t.map(function(t){var e=t.product,n=t.subtotal||s(t);return{item:e.id||e.skuCode,price:n,quantity:t.quantity||1}})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("../Integration"),g=r(f),m=t("../events/semanticEvents"),h=[m.VIEWED_PAGE,m.VIEWED_PRODUCT_DETAIL,m.VIEWED_PRODUCT_LISTING,m.SEARCHED_PRODUCTS,m.COMPLETED_TRANSACTION],y=function(t){function e(n,r){i(this,e);var a=Object.assign({merchantId:"",categorySeparator:" > "},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{id:"scarab-js-api",src:"//recommender.scarabresearch.com/js/"+r.merchantId+"/scarab-v2.js"}}),s}return a(e,t),e.prototype.initialize=function(){window.ScarabQueue=window.ScarabQueue||[]},e.prototype.getSemanticEvents=function(){return h},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case m.VIEWED_PAGE:e=["page.type","user.email","user.userId","cart"];break;case m.VIEWED_PRODUCT_DETAIL:e=["product.id","product.skuCode"];break;case m.VIEWED_PRODUCT_LISTING:e=["listing.category"];break;case m.SEARCHED_PRODUCTS:e=["listing.query"];break;case m.COMPLETED_TRANSACTION:e=["transaction"]}return e},e.prototype.getEventValidationConfig=function(t){var e,n={"page.type":{errors:["required","string"]},"user.email":{errors:["string"]},"user.userId":{warnings:["string"]}},r=(0,p.getProp)(t,"cart.lineItems");return r&&r.length&&(n=Object.assign(n,{"cart.lineItems[].product.id":{warnings:["required","string"]},"cart.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"cart.lineItems[].qantity":{warnings:["required","numeric"]}})),(e={},e[m.VIEWED_PAGE]={fields:["page.type","user.email","user.userId","cart.lineItems","cart.lineItems[].product.id","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity"],validations:n},e[m.VIEWED_PRODUCT_LISTING]={fields:["listing.category"],validations:{"listing.category":{errors:["required"],warnings:["array"]}}},e[m.SEARCHED_PRODUCTS]={fields:["listing.query"],validations:{"listing.query":{errors:["required","string"]}}},e[m.VIEWED_PRODUCT_DETAIL]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[m.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].qantity"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"transaction.lineItems[].qantity":{warnings:["required","numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return!(!window.ScarabQueue||Array.isArray(window.ScarabQueue))},e.prototype.reset=function(){(0,l.default)(window,"ScarabQueue"),this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.enrichDigitalData=function(){},e.prototype.go=function(){window.ScarabQueue.push(["go"]),this.pageTracked=!0},e.prototype.trackEvent=function(t){var e,n=(e={},e[m.VIEWED_PAGE]="onViewedPage",e[m.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[m.SEARCHED_PRODUCTS]="onSearchedProducts",e[m.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[m.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];this.getOption("merchantId")&&(r?this[r](t):this.trackCustomEvent(t))},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1;var n=t.user||{},r=t.cart||{};n.email?window.ScarabQueue.push(["setEmail",n.email]):n.userId&&window.ScarabQueue.push(["setCustomerId",n.userId]),r.lineItems&&r.lineItems.length>0?window.ScarabQueue.push(["cart",c(r.lineItems)]):window.ScarabQueue.push(["cart",[]]),this.pageTracked||(this.timeoutHandle=setTimeout(function(){e.pageTracked||e.go()},100))},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.category;n&&(Array.isArray(n)&&(n=n.join(this.getOption("categorySeparator"))),window.ScarabQueue.push(["category",n])),this.go()},e.prototype.onViewedProductDetail=function(t){var e=t.product||{};(e.id||e.skuCode)&&window.ScarabQueue.push(["view",e.id||e.skuCode]),this.go()},e.prototype.onSearchedProducts=function(t){var e=t.listing||{};e.query&&window.ScarabQueue.push(["searchTerm",e.query]),this.go()},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{};e.orderId&&e.lineItems&&window.ScarabQueue.push(["purchase",{orderId:e.orderId,items:c(e.lineItems)}]),this.go()},e}(g.default);n.default=y},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],177:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=t.category;return Array.isArray(e)?e=e.join("/"):e&&t.subcategory&&(e=e+"/"+t.subcategory),e}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/cleanObject"),p=r(l),f=t("@segmentstream/utils/arrayMerge"),g=r(f),m=t("@segmentstream/utils/dotProp"),h=t("../Integration"),y=r(h),v=t("../events/semanticEvents"),E=t("../IntegrationUtils"),w=["ViewContent","Search","AddToCart","AddToWishlist","InitiateCheckout","AddPaymentInfo","Purchase","Lead","CompleteRegistration"],_=function(t){function e(n,r){i(this,e);var a=Object.assign({pixelId:"",usePriceAsEventValue:!1,feedWithGroupedProducts:!1,customEvents:{},eventParameters:{}},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[v.VIEWED_PAGE,v.VIEWED_PRODUCT_DETAIL,v.ADDED_PRODUCT,v.ADDED_PRODUCT_TO_WISHLIST,v.SEARCHED_PRODUCTS,v.STARTED_ORDER,v.COMPLETED_TRANSACTION],s.customEvents=Object.keys(s.getOption("customEvents")||{}),s.customEvents.forEach(function(t){s.SEMANTIC_EVENTS.indexOf(t)<0&&s.SEMANTIC_EVENTS.push(t)}),s.addTag({type:"script",attr:{src:"//connect.facebook.net/en_US/fbevents.js"}}),s}return a(e,t),e.prototype.initialize=function(){var t=this.getOption("pixelId");t&&!window.fbq&&(window.fbq=window._fbq=function(){if(window.fbq.callMethod){var t;(t=window.fbq).callMethod.apply(t,arguments)}else window.fbq.queue.push(arguments)},window.fbq.push=window.fbq,window.fbq.loaded=!0,window.fbq.version="2.0",window.fbq.queue=[],t.split(",").forEach(function(t){window.fbq("init",t)}))},e.prototype.getPixelIds=function(){return this.getOption("pixelId").split(",")},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=(0,E.getEnrichableVariableMappingProps)(this.getOption("eventParameters"));switch(t.name){case v.VIEWED_PRODUCT_DETAIL:(0,g.default)(e,["product"]);break;case v.SEARCHED_PRODUCTS:(0,g.default)(e,["listing.query"]);break;case v.STARTED_ORDER:(0,g.default)(e,["cart"]);break;case v.COMPLETED_TRANSACTION:(0,g.default)(e,["website.currency","transaction"])}return e},e.prototype.getEventValidationConfig=function(t){var e,n=["product.id","product.name","product.category"],r={"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]}};return(e={},e[v.VIEWED_PRODUCT_DETAIL]={fields:n,validations:r},e[v.ADDED_PRODUCT]={fields:n,validations:r},e[v.ADDED_PRODUCT_TO_WISHLIST]={fields:n,validations:r},e[v.SEARCHED_PRODUCTS]={fields:["listing.query"],validations:{"listing.query":{errors:["required"]}}},e[v.STARTED_ORDER]={fields:["cart.total","cart.currency","cart.lineItems[].product.id","cart.lineItems[].product.skuCode"],validations:{"cart.total":{errors:["numeric"]},"cart.currency":{errors:["string"]},"cart.lineItems[].product.id":{warnings:["string"]},"cart.lineItems[].product.skuCode":{warnings:["string"]}}},e[v.COMPLETED_TRANSACTION]={fields:["transaction.total","transaction.currency","transaction.lineItems[].product.id","transaction.lineItems[].product.skuCode"],validations:{"transaction.total":{errors:["required","numeric"]},"transaction.currency":{errors:["required","string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.skuCode":{warnings:["string"]}}},e)[t.name]},e.prototype.isLoaded=function(){return!(!window.fbq||!window.fbq.callMethod)},e.prototype.reset=function(){(0,d.default)(window,"fbq")},e.prototype.trackEvent=function(t){t.name===v.VIEWED_PAGE?this.onViewedPage():t.name===v.VIEWED_PRODUCT_DETAIL?this.onViewedProductDetail(t):t.name===v.ADDED_PRODUCT?this.onAddedProduct(t):t.name===v.ADDED_PRODUCT_TO_WISHLIST?this.onAddedProductToWishlist(t):t.name===v.SEARCHED_PRODUCTS?this.onSearchedProducts(t):t.name===v.STARTED_ORDER?this.onStartedOrder(t):t.name===v.COMPLETED_TRANSACTION?this.onCompletedTransaction(t):this.onCustomEvent(t)},e.prototype.getEventParams=function(t){return(0,E.extractVariableMappingValues)(t,this.getOption("eventParameters"))},e.prototype.getProductParams=function(t){var e=t.product||{},n=s(e),r=this.getOption("feedWithGroupedProducts"),i=this.getOption("usePriceAsEventValue")?e.unitSalePrice:t.value,o=this.getOption("usePriceAsEventValue")?e.currency:void 0;return(0,p.default)({content_ids:[e.id||""],content_type:r?"product_group":"product",content_name:e.name||"",content_category:n||"",value:i,currency:o})},e.prototype.trackSingle=function(t,e){this.getPixelIds().forEach(function(n){return window.fbq("trackSingle",n,t,e)})},e.prototype.trackSingleCustom=function(t,e){this.getPixelIds().forEach(function(n){return window.fbq("trackSingleCustom",n,t,e)})},e.prototype.onViewedPage=function(){this.trackSingle("PageView")},e.prototype.onViewedProductDetail=function(t){var e=this.getProductParams(t),n=this.getEventParams(t);this.trackSingle("ViewContent",Object.assign(e,n))},e.prototype.onAddedProduct=function(t){var e=this.getProductParams(t),n=this.getEventParams(t);this.trackSingle("AddToCart",Object.assign(e,n))},e.prototype.onAddedProductToWishlist=function(t){var e=this.getProductParams(t),n=this.getEventParams(t);this.trackSingle("AddToWishlist",Object.assign(e,n))},e.prototype.onSearchedProducts=function(t){var e=t.listing||{},n=(0,p.default)({search_string:e.query}),r=this.getEventParams(t);this.trackSingle("Search",Object.assign(n,r))},e.prototype.onStartedOrder=function(t){var e=t.cart||{},n=e.lineItems||[],r=this.getOption("feedWithGroupedProducts"),i=this.getOption("usePriceAsEventValue")?e.total:t.value,o=r?"product.skuCode":"product.id",a=n.length?n.map(function(t){return(0,m.getProp)(t,o)}):void 0,s=(0,p.default)({content_ids:a,content_type:"product",currency:e.currency,value:i}),c=this.getEventParams(t);this.trackSingle("InitiateCheckout",Object.assign(s,c))},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[],r=this.getOption("feedWithGroupedProducts"),i=r?"product.skuCode":"product.id",o=n.length?e.lineItems.map(function(t){return(0,m.getProp)(t,i)}):void 0,a=(0,p.default)({content_ids:o,content_type:"product",currency:e.currency,value:e.total}),s=this.getEventParams(t);this.trackSingle("Purchase",Object.assign(a,s))},e.prototype.onCustomEvent=function(t){var e=this.getOption("customEvents"),n=e[t.name],r=this.getEventParams(t);n&&(w.indexOf(n)<0?this.trackSingleCustom(n,r):this.trackSingle(n,r))},e}(y.default);n.default=_},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],178:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("@segmentstream/utils/cleanObject"),p=r(l),f=t("../Integration"),g=r(f),m=t("../events/semanticEvents"),h=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:"",preCheckout:!1,postCheckout:!0,exchange:!1,exchangeTriggerEvent:["Completed Transaction"]},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[],s.pageTracked=!1,s.addTag({type:"script",attr:{src:"https://api.flocktory.com/v2/loader.js?site_id="+r.siteId}}),s}return a(e,t),e.prototype.initialize=function(){window.flocktory=window.flocktory||[]},e.prototype.allowCustomEvents=function(){return!0},e.prototype.getExchangeTriggerEvents=function(){var t=this.getOption("exchangeTriggerEvent");return"string"==typeof t?[t]:t},e.prototype.getSemanticEvents=function(){var t=this,e=this.getExchangeTriggerEvents();if(this.getOption("preCheckout")){var n;(n=this.SEMANTIC_EVENTS).push.apply(n,[m.VIEWED_PAGE,m.VIEWED_PRODUCT_DETAIL,m.VIEWED_PRODUCT_LISTING,m.ADDED_PRODUCT,m.REMOVED_PRODUCT,m.COMPLETED_TRANSACTION])}else this.getOption("postCheckout")&&this.SEMANTIC_EVENTS.push(m.COMPLETED_TRANSACTION);return this.getOption("exchange")&&e.forEach(function(e){t.SEMANTIC_EVENTS.indexOf(e)<0&&t.SEMANTIC_EVENTS.push(e)}),this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=this.getExchangeTriggerEvents(),n=[];switch(t.name){case m.VIEWED_PAGE:n.push.apply(n,["user.email","user.isLoggedIn","user.firstName","user.lastName","user.fullName","cart"]);break;case m.VIEWED_PRODUCT_DETAIL:n.push.apply(n,["product"]);break;case m.VIEWED_PRODUCT_LISTING:n.push.apply(n,["listing.categoryId"]);break;case m.ADDED_PRODUCT:case m.REMOVED_PRODUCT:n.push.apply(n,["product"]);break;case m.COMPLETED_TRANSACTION:n.push.apply(n,["user.email","user.firstName","user.lastName","user.fullName","transaction"])}return this.getOption("exchange")&&e.indexOf(t.name)>-1&&n.push.apply(n,["user.email","user.firstName","user.lastName","user.fullName"]),n},e.prototype.isLoaded=function(){return window.flocktory&&window.flocktory.loaded},e.prototype.reset=function(){(0,u.default)(window,"flocktory")},e.prototype.getUserName=function(t){var e=(0,d.getProp)(t,"user.fullName");if(e)return e;var n=(0,d.getProp)(t,"user.firstName"),r=(0,d.getProp)(t,"user.lastName");return n&&r?[n,r].join(" "):n},e.prototype.getUserEmail=function(t){var e=(0,d.getProp)(t,"user.email");if(e)return e;var n=(0,d.getProp)(t,"user.phone");if(n&&(n=n.replace(/\D/g,"")),n)return n+"@unknown.email";var r=(0,d.getProp)(t,"user.userId");return r?r+"@unknown.email":void 0},e.prototype.trackEvent=function(t){var e,n=(e={},e[m.VIEWED_PAGE]=this.onViewedPage.bind(this),e[m.ADDED_PRODUCT]=this.onAddedProduct.bind(this),e[m.REMOVED_PRODUCT]=this.onRemovedProduct.bind(this),e[m.VIEWED_PRODUCT_DETAIL]=this.onViewedProductDetail.bind(this),e[m.VIEWED_PRODUCT_LISTING]=this.onViewedProductListing.bind(this),e[m.COMPLETED_TRANSACTION]=this.onCompletedTransaction.bind(this),e),r=this.getExchangeTriggerEvents();this.getOption("exchange")&&r.indexOf(t.name)>-1&&this.onExchangeTriggerEvent(t),n[t.name]&&n[t.name](t)},e.prototype.onViewedPage=function(t){this.pageTracked&&window.flocktory&&"function"==typeof window.flocktory.reInit&&window.flocktory.reInit()&&window.flocktory.reInit(),this.pageTracked=!0,((0,d.getProp)(t,"user.isLoggedIn")||!1)&&window.flocktory.push(["addData",{user:(0,p.default)({email:this.getUserEmail(t),name:this.getUserName(t)})}]);var e=t.cart;e&&e.lineItems&&Array.isArray(e.lineItems)&&window.flocktory.push(["updateCart",{cart:{items:e.lineItems.map(function(t){return{id:(0,d.getProp)(t,"product.id"),price:(0,d.getProp)(t,"product.unitSalePrice"),count:t.quantity}})}}])},e.prototype.onViewedProductListing=function(t){window.flocktory.push(["trackCategoryView",{category:{id:String((0,d.getProp)(t,"listing.categoryId"))}}])},e.prototype.onViewedProductDetail=function(t){window.flocktory.push(["trackItemView",{item:{id:String((0,d.getProp)(t,"product.id"))}}])},e.prototype.onAddedProduct=function(t){window.flocktory.push(["addToCart",(0,p.default)({item:{id:String((0,d.getProp)(t,"product.id")),price:(0,d.getProp)(t,"product.unitSalePrice"),count:(0,d.getProp)(t,"quantity")||1,brand:(0,d.getProp)(t,"product.manufacturer"),categoryId:(0,d.getProp)(t,"product.categoryId")}})])},e.prototype.onRemovedProduct=function(t){window.flocktory.push(["removeFromCart",{item:{id:String((0,d.getProp)(t,"product.id")),count:(0,d.getProp)(t,"quantity")||1}}])},e.prototype.onCompletedTransaction=function(t){if(this.getOption("postCheckout")){var e=(0,d.getProp)(t,"transaction.lineItems")||[];window.flocktory.push(["postcheckout",(0,p.default)({user:{name:this.getUserName(t),email:this.getUserEmail(t)},order:{id:String((0,d.getProp)(t,"transaction.orderId")),price:(0,d.getProp)(t,"transaction.total"),items:e.map(function(t){return(0,p.default)({id:String((0,d.getProp)(t,"product.id")),title:(0,d.getProp)(t,"product.name"),price:(0,d.getProp)(t,"product.unitSalePrice"),image:(0,d.getProp)(t,"product.imageUrl"),count:(0,d.getProp)(t,"quantity")})})},spot:(0,d.getProp)(t,"spot")})])}},e.prototype.onExchangeTriggerEvent=function(t){window.flocktory.push(["exchange",(0,p.default)({user:{name:this.getUserName(t),email:this.getUserEmail(t)},spot:(0,d.getProp)(t,"spot"),params:{}})])},e}(g.default);n.default=h},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],179:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/getQueryParam"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("../Integration"),p=r(l),f=t("./utils/affiliate"),g=t("../events/semanticEvents"),m="gdeslon",h="gdeslon_ref",y="gdeslon_aid",v=[g.VIEWED_PAGE,g.VIEWED_PRODUCT_DETAIL,g.VIEWED_PRODUCT_LISTING,g.SEARCHED_PRODUCTS,g.COMPLETED_TRANSACTION,g.VIEWED_CART],E=function(t){function e(n,r){i(this,e);var a=Object.assign({merchantId:"",defaultCode:"",clickRefCookieName:h,aidCookieName:y,cookieTracking:!0,cookieDomain:"",deduplication:!1,utmSource:m,deduplicationUtmMedium:[],isRetargetingEnabled:!1,feedWithGroupedProducts:!1},r),s=o(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag("trackingPixel",{type:"script",attr:{src:"https://www.gdeslon.ru/thanks.js?codes={{ productCodes }}{{ code }}:{{ total }}&order_id={{ orderId }}&merchant_id="+r.merchantId}}),s.addTag("thanks",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?codes={{ productCodes }}&order_id={{ orderId }}&mid="+r.merchantId+"&mode=thanks"}}),s.addTag("other",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?mid="+r.merchantId+"&mode=other"}}),s.addTag("main",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?mid="+r.merchantId+"&mode=main"}}),s.addTag("card",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?codes={{ productCodes }}&mid="+r.merchantId+"&mode=card"}}),s.addTag("basket",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?codes={{ productCodes }}&mid="+r.merchantId+"&mode=basket"}}),s.addTag("search list",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?codes={{ productCodes }}&mid="+r.merchantId+"&mode=list"}}),s.addTag("category",{type:"script",attr:{src:"https://www.gdeslon.ru/landing.js?codes={{ productCodes }}&cat_id={{ categoryId }}&mid="+r.merchantId+"&mode=list"}}),s}return a(e,t),e.prototype.initialize=function(){if(this._isLoaded=!0,this.getOption("cookieTracking")){var t=(0,u.default)("_gs_ref"),e=(0,u.default)("gsaid"),n=Number((0,u.default)("_gs_cttl")),r=this.getOption("cookieDomain");if(t){var i=this.getOption("clickRefCookieName");(0,f.addAffiliateCookie)(i,t,n,r)}if(e){var o=this.getOption("aidCookieName");(0,f.addAffiliateCookie)(o,e,n,r)}}},e.prototype.getSemanticEvents=function(){return this.getOption("isRetargetingEnabled")?v:[g.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case g.VIEWED_PAGE:e=["page.type"];break;case g.VIEWED_PRODUCT_DETAIL:e=["product"];break;case g.VIEWED_PRODUCT_LISTING:case g.SEARCHED_PRODUCTS:e=["listing.items","listing.categoryId"];break;case g.VIEWED_CART:e=["cart"];break;case g.COMPLETED_TRANSACTION:e=["transaction","context.campaign"];break;default:e=[]}return e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[g.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","context.campaign.source","context.campaign.medium","integrations.gdeslon.code"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e,n=(e={},e[g.VIEWED_PAGE]="onViewedPage",e[g.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[g.COMPLETED_TRANSACTION]="onCompletedTransaction",e[g.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[g.SEARCHED_PRODUCTS]="onSearchedProducts",e[g.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;if(this.getOption("isRetargetingEnabled")){var n=t.page;n&&"home"===n.type&&this.onViewedHome(),setTimeout(function(){e.pageTracked||e.onViewedOther()},100)}},e.prototype.onViewedOther=function(){this.load("other"),this.pageTracked=!0},e.prototype.onViewedHome=function(){this.load("main"),this.pageTracked=!0},e.prototype.onViewedProductDetail=function(t){var e=t.product,n=this.formatProductCodes([{product:e}]);this.load("card",{productCodes:n}),this.pageTracked=!0},e.prototype.onViewedCart=function(t){var e=t.cart.lineItems,n=this.formatProductCodes(e);this.load("basket",{productCodes:n}),this.pageTracked=!0},e.prototype.onSearchedProducts=function(t){var e=this.formatProductCodes((0,d.getProp)(t,"listing.items"));this.load("search list",{productCodes:e}),this.pageTracked=!0},e.prototype.onViewedProductListing=function(t){var e=this.formatProductCodes((0,d.getProp)(t,"listing.items")),n=t.listing.categoryId;this.load("category",{productCodes:e,categoryId:n}),this.pageTracked=!0},e.prototype.onCompletedTransaction=function(t){if(this.trackCompletedTransactionRetargeting(t),this.pageTracked=!0,(0,f.getAffiliateCookie)(this.getOption("clickRefCookieName"))){var e=(0,d.getProp)(t,"context.campaign"),n=this.getOption("utmSource"),r=this.getOption("deduplicationUtmMedium");(0,f.isDeduplication)(e,n,r)||this.trackSale(t)}},e.prototype.formatProductCodes=function(t){var e="",n=this.getOption("feedWithGroupedProducts");return Array.isArray(t)&&(e=t.reduce(function(t,e){var r=e.product||e||{},i=e.quantity||1,o=n?r.skuCode:r.id,a=[o,r.unitSalePrice].join(":");return i>1&&(a=Array(i).fill(a).join(",")),t?[t,a].join(","):a},"")),e},e.prototype.getCode=function(t){return(0,d.getProp)(t,"integrations.gdeslon.code")||this.getOption("defaultCode")},e.prototype.trackCompletedTransactionRetargeting=function(t){if(this.getOption("isRetargetingEnabled")){var e=t.transaction;if(e&&e.orderId&&e.total){var n=e.orderId,r=this.formatProductCodes(e.lineItems);this.getOption("isRetargetingEnabled")&&this.load("thanks",{productCodes:r,orderId:n})}}},e.prototype.trackSale=function(t){var e=t.transaction;if(e&&e.orderId&&e.total){var n=e.orderId,r=e.total,i=this.formatProductCodes(e.lineItems);i&&(i+=",");var o=this.getCode(t);this.load("trackingPixel",{productCodes:i,code:o,orderId:n,total:r})}},e}(p.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12}],180:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("@segmentstream/utils/queryString"),p=t("@segmentstream/utils/cleanObject"),f=r(p),g=t("../Integration"),m=r(g),h=t("../events/semanticEvents"),y=function(t){function e(n,r){i(this,e);var a=Object.assign({shopId:"",bannerId:""},r),s=o(this,t.call(this,n,a));return s.addTag("wrapper",{type:"script",attr:{src:"https://get4click.ru/wrapper.php?method=main&jsc=iPromoCpnObj&{{ params }}"}}),s}return a(e,t),e.prototype.initialize=function(){window._iPromoBannerObj=function(){this.htmlElementId="promocode-element-container",this.gc=function(){return document.getElementById(this.htmlElementId)}},window.iPromoCpnObj=new window._iPromoBannerObj,this._isLoaded=!0},e.prototype.getSemanticEvents=function(){return[h.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case h.COMPLETED_TRANSACTION:return["user.email","user.firstName","user.lastName","user.phone","user.gender","transaction"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[h.COMPLETED_TRANSACTION]={fields:["user.email","user.firstName","user.lastName","transaction.orderId","transaction.total","transaction.vouchers"],validations:{"user.email":{warnings:["required","string"]},"user.firstName":{errors:["string"]},"user.lastName":{errors:["string"]},"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.reset=function(){(0,u.default)(window,"iPromoCpnObj"),(0,u.default)(window,"_iPromoBannerObj")},e.prototype.trackEvent=function(t){var e,n=(e={},e[h.COMPLETED_TRANSACTION]=this.onCompletedTransaction.bind(this),e);n[t.name]&&n[t.name](t)},e.prototype.onCompletedTransaction=function(t){var e=(0,d.getProp)(t,"transaction.vouchers"),n=(0,f.default)({_shopId:this.getOption("shopId"),_bannerId:this.getOption("bannerId"),_customerFirstName:(0,d.getProp)(t,"user.firstName"),_customerLastName:(0,d.getProp)(t,"user.lastName"),_customerEmail:(0,d.getProp)(t,"user.email"),_customerPhone:(0,d.getProp)(t,"user.phone"),_customerGender:(0,d.getProp)(t,"user.gender"),_orderId:(0,d.getProp)(t,"transaction.orderId"),_orderValue:(0,d.getProp)(t,"transaction.total"),_orderCurrency:(0,d.getProp)(t,"transaction.currency"),_usedPromoCode:Array.isArray(e)?e.toString():e});this.load("wrapper",{params:(0,l.stringify)(n)})},e}(m.default);n.default=y},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/queryString":32}],181:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("@segmentstream/utils/dotProp"),c=t("../Integration"),u=function(t){return t&&t.__esModule?t:{default:t}}(c),d=t("../events/semanticEvents"),l=function(t){function e(n,o){r(this,e);var a=Object.assign({siteId:"",feedWithGroupedProducts:!1},o),s=i(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"https://px.adhigh.net/p.js"}}),s}return o(e,t),e.prototype.initialize=function(){window.__GetI=window.__GetI||[]},e.prototype.getSemanticEvents=function(){return[d.VIEWED_PAGE,d.VIEWED_PRODUCT_DETAIL,d.ADDED_PRODUCT,d.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case[d.VIEWED_PRODUCT_DETAIL]:return["product"];case[d.COMPLETED_TRANSACTION]:return["transaction"];default:return[]}},e.prototype.trackEvent=function(t){var e,n=(e={},e[d.VIEWED_PAGE]="onViewedPage",e[d.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[d.ADDED_PRODUCT]="onAddedProduct",e[d.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.trackGetIntentAction=function(t){window.__GetI.push(t),this.pageTracked=!0},e.prototype.onViewedPage=function(){var t=this;this.pageTracked=!1,setTimeout(function(){t.pageTracked||t.trackGetIntentAction({type:"VIEW",site_id:t.getOption("siteId")})},100)},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts");this.trackGetIntentAction({type:"VIEW",site_id:this.getOption("siteId"),category_id:e.categoryId,product_id:n?e.skuCode:e.id,product_price:e.unitSalePrice})},e.prototype.onAddedProduct=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts");this.trackGetIntentAction({type:"CART_ADD",site_id:this.getOption("siteId"),order:[{id:n?e.skuCode:e.id,price:e.unitSalePrice,quantity:t.quantity||1}]})},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[],r=this.getOption("feedWithGroupedProducts");this.trackGetIntentAction({type:"CONVERSION",site_id:this.getOption("siteId"),order:n.map(function(t){return t=t||{},{id:r?(0,s.getProp)(t,"product.skuCode"):(0,s.getProp)(t,"product.id"),price:(0,s.getProp)(t,"product.unitSalePrice"),quantity:t.quantity||1}}),transaction_id:e.orderId,revenue:e.total})},e}(u.default);n.default=l},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7}],182:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=t.category;return Array.isArray(e)?e=e.join("/"):e&&t.subcategory&&(e=e+"/"+t.subcategory),e}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/cleanObject"),p=r(l),f=t("@segmentstream/utils/dotProp"),g=t("../Integration"),m=r(g),h=t("../events/semanticEvents"),y=function(t){function e(n,r){i(this,e);var a=Object.assign({apiKey:"",siteDomain:void 0,feedWithGroupedProducts:!1},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[h.VIEWED_PAGE,h.VIEWED_PRODUCT_DETAIL,h.VIEWED_PRODUCT_LISTING,h.ADDED_PRODUCT,h.COMPLETED_TRANSACTION],s.addTag({type:"script",attr:{src:"https://www.glami.ru/js/compiled/pt.js"}}),s}return a(e,t),e.prototype.initialize=function(){var t=this.getOption("apiKey"),e=this.getOption("siteDomain");window.glami=window.glami||function(){(window.glami.q=window.glami.q||[]).push(arguments)},window.glami("create",t,e)},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case h.VIEWED_PRODUCT_DETAIL:e=["product"];break;case h.VIEWED_PRODUCT_LISTING:e=["listing"];break;case h.COMPLETED_TRANSACTION:e=["website.currency","transaction"]}return e},e.prototype.getEventValidationConfig=function(t){var e,n=["product.id","product.name","product.category"],r={"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]}};return(e={},e[h.VIEWED_PRODUCT_DETAIL]={fields:n,validations:r},e[h.ADDED_PRODUCT]={fields:n,validations:r},e[h.COMPLETED_TRANSACTION]={fields:["transaction.total","transaction.currency","transaction.lineItems[].product.id","transaction.lineItems[].product.skuCode"],validations:{"transaction.total":{errors:["required","numeric"]},"transaction.currency":{errors:["required","string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.skuCode":{warnings:["string"]}}},e)[t.name]},e.prototype.isLoaded=function(){return!(!window.glami||window.glami.q)},e.prototype.reset=function(){(0,d.default)(window,"glami")},e.prototype.trackEvent=function(t){t.name===h.VIEWED_PAGE?this.onViewedPage():t.name===h.VIEWED_PRODUCT_DETAIL?this.onViewedProductDetail(t):t.name===h.VIEWED_PRODUCT_LISTING?this.onViewedProductListing(t):t.name===h.ADDED_PRODUCT?this.onAddedProduct(t):t.name===h.COMPLETED_TRANSACTION&&this.onCompletedTransaction(t)},e.prototype.onViewedPage=function(){window.glami("track","PageView")},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts"),r=n?e.skuCode:e.id;window.glami("track","ViewContent",{content_type:"product",item_ids:[r||""],product_names:[e.name||""]})},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.items||[],r=s(e),i=e.categoryId;if(r||i){var o=this.getOption("feedWithGroupedProducts");window.glami("track","ViewContent",(0,p.default)({content_type:"category",item_ids:n.slice(0,10).map(function(t){return o?t.skuCode:t.id}),product_names:n.slice(0,10).map(function(t){return t.name}),category_id:i,category_text:r}))}},e.prototype.onAddedProduct=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts");window.glami("track","AddToCart",(0,p.default)({item_ids:n?[e.skuCode||""]:[e.id||""],product_names:[e.name||""],value:e.unitSalePrice,currency:e.currency}))},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[],r=this.getOption("feedWithGroupedProducts"),i=r?"product.skuCode":"product.id",o=n.length?e.lineItems.map(function(t){return(0,f.getProp)(t,i)}):void 0,a=n.length?e.lineItems.map(function(t){return(0,f.getProp)(t,"product.name")}):void 0;window.glami("track","Purchase",(0,p.default)({item_ids:o,product_names:a,value:e.total,currency:e.currency,transaction_id:e.orderId}))},e}(m.default);n.default=y},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],183:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){return t=t||[],t.map(function(t){return e?t.product.skuCode:t.product.id}).filter(function(t){return!!t})}function c(t,e){return t=t||[],t.map(function(t){return e?t.skuCode:t.id}).filter(function(t){return!!t})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/cleanObject"),l=r(d),p=t("@segmentstream/utils/deleteProperty"),f=r(p),g=t("../Integration"),m=r(g),h=t("./utils/AsyncQueue"),y=r(h),v=t("../events/semanticEvents"),E=[v.VIEWED_PAGE,v.VIEWED_PRODUCT_DETAIL,v.VIEWED_PRODUCT_LISTING,v.SEARCHED_PRODUCTS,v.STARTED_ORDER,v.VIEWED_CART,v.COMPLETED_TRANSACTION],w="retail",_=function(t){function e(n,r){i(this,e);var a=Object.assign({conversionId:"",apiVersion:"",businessType:w,feedWithGroupedProducts:!1},r),s=o(this,t.call(this,n,a));return s.isLoaded=s.isLoaded.bind(s),s.isGtag()?(s.addTag({type:"script",attr:{async:!0,src:"//www.googletagmanager.com/gtag/js?id="+s.getConversionId()}}),s.load()):s.addTag({type:"script",attr:{src:"//www.googleadservices.com/pagead/conversion_async.js"}}),s}return a(e,t),e.prototype.isGtag=function(){return"gtag.js"===this.getOption("apiVersion")},e.prototype.getConversionId=function(){var t=this.getOption("conversionId");return this.isGtag()&&-1===t.indexOf("AW-")?"AW-"+t:t},e.prototype.getSemanticEvents=function(){return E},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case v.VIEWED_PAGE:e=["page.type"];break;case v.VIEWED_PRODUCT_DETAIL:e=["product"];break;case v.VIEWED_PRODUCT_LISTING:e=this.getOption("businessType")===w?["listing.category"]:["listing.items"];break;case v.SEARCHED_PRODUCTS:e=["listing.items"];break;case v.VIEWED_CART:case v.STARTED_ORDER:e=["cart"];break;case v.COMPLETED_TRANSACTION:e=["transaction"]}return e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[v.VIEWED_PAGE]={fields:["page.type"],validations:{"page.type":{errors:["required","string"]}}},e[v.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.skuCode","product.unitSalePrice","product.category"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.unitSalePrice":{warnings:["required","numeric"]},"product.category":{warnings:["required","array"]}}},e[v.VIEWED_PRODUCT_LISTING]=function(t){return t===w?{fields:["listing.category"],validations:{"listing.category":{errors:["required"],warnings:["array"]}}}:{}}(this.getOption("businessType")),e[v.STARTED_ORDER]={fields:["cart.subtotal","cart.lineItems[].product.id","cart.lineItems[].product.skuCode"],validations:{"cart.subtotal":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[v.VIEWED_CART]={fields:["cart.subtotal","cart.lineItems[].product.id","cart.lineItems[].product.skuCode"],validations:{"cart.subtotal":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[v.COMPLETED_TRANSACTION]={fields:["transaction.subtotal","transaction.lineItems[].product.id","transaction.lineItems[].product.skuCode"],validations:{"transaction.subtotal":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e)[t.name]},e.prototype.initialize=function(){if(this.isGtag()){if(window.dataLayer=window.dataLayer||[],!window.gtag){var t=function(){window.dataLayer.push(arguments)};t("js",new Date),window.gtag=t}window.gtag("config",this.getConversionId(),{send_page_view:!1})}else this.asyncQueue=new y.default(this.isLoaded)},e.prototype.allowNoConflictInitialization=function(){return!0},e.prototype.onLoadInitiated=function(){this.isGtag()||this.asyncQueue.init()},e.prototype.isLoaded=function(){return this.isGtag()?!!window.gtag:!!window.google_trackConversion},e.prototype.reset=function(){this.isGtag()?(0,f.default)(window,"gtag"):(0,f.default)(window,"google_trackConversion")},e.prototype.trackEvent=function(t){var e,n=(e={},e[v.VIEWED_PAGE]="onViewedPage",e[v.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[v.SEARCHED_PRODUCTS]="onSearchedProducts",e[v.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[v.COMPLETED_TRANSACTION]="onCompletedTransaction",e[v.STARTED_ORDER]="onStartedOrder",e[v.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this.getConversionId()&&this[r](t)},e.prototype.trackGtag=function(t,e){e.send_to=this.getConversionId(),window.gtag("event",t,(0,l.default)(e))},e.prototype.trackConversion=function(t){var e=(0,l.default)({google_conversion_id:this.getConversionId(),google_custom_params:t,google_remarketing_only:!0});this.isLoaded()?window.google_trackConversion(e):this.asyncQueue.push(function(){window.google_trackConversion(e)})},e.prototype.getViewedCartParams=function(t,e){var n,r="custom"===this.getOption("businessType")?"conversionintent":"cart";return n={},n[this.getPrefix()+"_prodid"]=t,n[this.getPrefix()+"_totalvalue"]=e,n[this.getPrefix()+"_pagetype"]=r,n},e.prototype.getOrderStartParams=function(t,e){var n;return n={},n[this.getPrefix()+"_itemid"]=t,n[this.getPrefix()+"_pagetype"]="conversionintent",n[this.getPrefix()+"_totalvalue"]=e,n},e.prototype.getPrefix=function(){switch(this.getOption("businessType")){case"custom":return"dynx";default:return"ecomm"}},e.prototype.getViewedPageParams=function(t){var e;return e={},e[this.getPrefix()+"_pagetype"]="home"===t?"home":"other",e},e.prototype.getViewedProductDetailParams=function(t,e,n,r){var i,o;switch(this.getOption("businessType")){case"custom":return i={},i[this.getPrefix()+"_pagetype"]="offerdetail",i[this.getPrefix()+"_itemid"]=t,i[this.getPrefix()+"_totalvalue"]=r,i;default:return o={},o[this.getPrefix()+"_pagetype"]="product",o[this.getPrefix()+"_prodid"]=t,o[this.getPrefix()+"_totalvalue"]=r,o[this.getPrefix()+"_category"]=e,o.isSaleItem=this.isGtag()?r<n:void 0,o}},e.prototype.getViewedProductListingParams=function(t,e){var n,r;switch(this.getOption("businessType")){case"custom":return n={},n[this.getPrefix()+"_pagetype"]="searchresults",n[this.getPrefix()+"_prodid"]=t,n;default:return r={},r[this.getPrefix()+"_prodid"]=this.isGtag()?t:void 0,r[this.getPrefix()+"_pagetype"]="category",r[this.getPrefix()+"_category"]=e,r}},e.prototype.getSearchedProductsParams=function(t){var e,n;switch(this.getOption("businessType")){case"custom":return e={},e[this.getPrefix()+"_pagetype"]="searchresults",e[this.getPrefix()+"_itemid"]=t,e;default:return n={},n[this.getPrefix()+"_prodid"]=this.isGtag()?t:void 0,n[this.getPrefix()+"_pagetype"]="searchresults",n}},e.prototype.getCompletedTransactionParams=function(t,e){var n,r;switch(this.getOption("businessType")){case"custom":return n={},n[this.getPrefix()+"_pagetype"]="conversion",n[this.getPrefix()+"_itemid"]=t,n[this.getPrefix()+"_totalvalue"]=e,n;default:return r={},r[this.getPrefix()+"_pagetype"]="purchase",r[this.getPrefix()+"_prodid"]=t,r[this.getPrefix()+"_totalvalue"]=e,r}},e.prototype.onViewedPage=function(t){var e=this,n=t.page;this.pageTracked=!1,setTimeout(function(){if(!e.pageTracked){var t=e.getViewedPageParams(n.type);e.isGtag()?e.trackGtag("page_view",t):e.trackConversion(t)}},100)},e.prototype.onViewedProductDetail=function(t){var e=t.product;if(e){var n=e.category;Array.isArray(n)?n=n.join("/"):n&&e.subcategory&&(n=n+"/"+e.subcategory);var r=this.getOption("feedWithGroupedProducts"),i=r?e.skuCode:e.id,o=e.unitSalePrice||0,a=this.getViewedProductDetailParams(i,n,e.unitPrice,o);this.isGtag()?this.trackGtag("page_view",a):this.trackConversion(a),this.pageTracked=!0}},e.prototype.onSearchedProducts=function(t){var e=t.listing||[],n=c(e.items),r=this.getSearchedProductsParams(n);this.isGtag()?this.trackGtag("page_view",r):this.trackConversion(r),this.pageTracked=!0},e.prototype.onViewedProductListing=function(t){var e=t.listing,n={};if(e){var r=e.category;Array.isArray(r)&&(r=r.join("/"));var i=c(e.items);n=this.getViewedProductListingParams(i,r)}this.isGtag()?this.trackGtag("page_view",n):this.trackConversion(n),this.pageTracked=!0},e.prototype.onViewedCart=function(t){var e=t.cart,n=this.getOption("businessType");if(e&&(this.isGtag()||!n||n===w)){var r=this.getOption("feedWithGroupedProducts"),i=s(e.lineItems,r),o=this.getViewedCartParams(i,e.subtotal||e.total||0);this.isGtag()?this.trackGtag("page_view",o):this.trackConversion(o),this.pageTracked=!0}},e.prototype.onStartedOrder=function(t){var e=t.cart,n=this.getOption("businessType");if(e&&n&&n!==w){var r=this.getOption("feedWithGroupedProducts"),i=s(e.lineItems,r),o=e.subtotal||e.total||0,a=this.getOrderStartParams(i,o);this.isGtag()?this.trackGtag("page_view",a):this.trackConversion(a),this.pageTracked=!0}},e.prototype.onCompletedTransaction=function(t){var e=t.transaction;if(e){var n=this.getOption("feedWithGroupedProducts"),r=s(e.lineItems,n),i=e.subtotal||e.total||0,o=this.getCompletedTransactionParams(r,i);this.isGtag()?this.trackGtag("page_view",o):this.trackConversion(o),this.pageTracked=!0}},e}(m.default);n.default=_},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5}],184:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return Array.isArray(t.vouchers)?t.vouchers[0]:t.voucher}function c(t,e){var n=e,r=[];return n.forEach(function(e){var n=(0,p.getProp)(t,e);n&&r.push(n)}),r.join(", ")}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("@segmentstream/utils/cleanObject"),g=r(f),m=t("@segmentstream/utils/each"),h=r(m),y=t("@segmentstream/utils/size"),v=r(y),E=t("js-cookie"),w=r(E),_=t("@segmentstream/utils/arrayMerge"),b=r(_),I=t("../Integration"),P=r(I),T=t("./utils/transliterate"),D=r(T),O=t("../events/semanticEvents"),C=t("../variableTypes"),S=[O.VIEWED_PAGE,O.COMPLETED_TRANSACTION],A=[O.VIEWED_PAGE,O.VIEWED_PRODUCT_DETAIL,O.COMPLETED_TRANSACTION,O.REFUNDED_TRANSACTION,O.VIEWED_CHECKOUT_STEP,O.COMPLETED_CHECKOUT_STEP,O.VIEWED_PRODUCT,O.CLICKED_PRODUCT,O.ADDED_PRODUCT,O.REMOVED_PRODUCT,O.VIEWED_CAMPAIGN,O.CLICKED_CAMPAIGN,O.EXCEPTION],k=function(t){function e(n,r){i(this,e);var a=Object.assign({trackingId:"",alternativeTrackingId:"",optimizeContainerId:"",enhancedLinkAttribution:!1,enhancedEcommerce:!1,sendUserId:!1,anonymizeIp:!1,domain:"auto",crossDomainTracking:!1,linkedDomains:[],siteSpeedSampleRate:1,defaultCurrency:"USD",fields:{},metrics:{},dimensions:{},contentGroupings:{},contentGroups:{},productDimensions:{},productMetrics:{},namespace:void 0,alternativeNamespace:void 0,noConflict:!1,checkoutOptions:["option","paymentMethod","shippingMethod"],clientIdCustomDimension:void 0,transliteration:!1},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"https://www.google-analytics.com/analytics.js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return this.getOption("enhancedEcommerce")?A:S},e.prototype.getIgnoredEvents=function(){return[O.SESSION_STARTED,O.VIEWED_PRODUCT_LISTING,O.SEARCHED_PRODUCTS]},e.prototype.allowCustomEvents=function(){return!0},e.prototype.allowNoConflictInitialization=function(){return!0},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case O.VIEWED_PAGE:e=["user.userId","website.currency","page"];break;case O.VIEWED_PRODUCT_DETAIL:e=["product"];break;case O.VIEWED_CHECKOUT_STEP:e=["cart","transaction"];break;case O.COMPLETED_TRANSACTION:case O.REFUNDED_TRANSACTION:e=["transaction"]}return this.getEnrichableDimensionsProps().forEach(function(t){e.push(t)}),e},e.prototype.getEventValidationConfig=function(t){var e,n=["product.id","product.name","product.category","product.unitSalePrice","product.manufacturer","product.variation","product.voucher","product.currency"],r={"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},"product.unitSalePrice":{warnings:["required","numeric"]},"product.manufacturer":{warnings:["string"]},"product.variant":{warnings:["string"]},"product.currency":{warnings:["required","string"]}},i=function(){return n.concat("quantity")},o=function(){return n.map(function(t){return["listItem",t].join(".")}).concat(["listItem.listName","listItem.position"])},a=function(){return n.map(function(t){return["listItems[]",t].join(".")}).concat(["listItems[].listName","listItems[].position"])},s=function(){return n.map(function(t){return["cart.lineItems[]",t].join(".")}).concat(["cart.lineItems[].quantity"])},c=function(){return n.map(function(t){return["transaction.lineItems[]",t].join(".")}).concat(["transaction.lineItems[].quantity"])},u=function(){var e=t.transaction?c():s();return(0,b.default)(e,["step","option"]),e},d=function(){return Object.assign(r,{quantity:{warnings:["required","numeric"]}})},l=function(){return Object.keys(r).reduce(function(t,e){return t[["listItem",e].join(".")]=r[e],t},{"listItem.listName":{warnings:["string"]},"listItem.position":{warnings:["numeric"]}})},p=function(){return Object.keys(r).reduce(function(t,e){return t[["listItems[]",e].join(".")]=r[e],t},{"listItems[].listName":{warnings:["string"]},"listItems[].position":{warnings:["numeric"]}})},f=function(){return Object.keys(r).reduce(function(t,e){return t[["cart.lineItems[]",e].join(".")]=r[e],t},{"cart.lineItems[].quantity":{warnings:["required","numeric"]}})},g=function(){return Object.keys(r).reduce(function(t,e){return t[["transaction.lineItems[]",e].join(".")]=r[e],t},{"transaction.lineItems[].quantity":{warnings:["required","numeric"]}})},m=function(){var e=t.transaction?g():f();return Object.assign(e,{step:{errors:["required"],warnings:["numeric"]}})},h=["campaign.id","campaign.name","campaign.design","campaign.position"],y=["campaigns[].id","campaigns[].name","campaigns[].design","campaigns[].position"],v={"campaign.id":{errors:["required"],warnings:["string"]},"campaign.name":{warnings:["required","string"]},"campaign.design":{warnings:["string"]},"campaign.position":{warnings:["required","string"]}},E={"campaigns[].id":{errors:["required"],warnings:["string"]},"campaigns[].name":{warnings:["required","string"]},"campaigns[].design":{warnings:["string"]},"campaigns[].position":{warnings:["required","string"]}},w={"page.url":{warnings:["string"]},"page.path":{warnings:["string"]},"page.queryString":{warnings:["string"]},"page.name":{warnings:["string"]},"page.title":{warnings:["string"]}};this.pageCalled||w["page.url"].warnings.push("required");var _=(e={},e[O.VIEWED_PAGE]=function(){return{fields:["page.url","page.path","page.queryString","page.name","page.title"],validations:w}},e[O.VIEWED_PRODUCT_DETAIL]=function(){return{fields:n,validations:r}},e[O.ADDED_PRODUCT]=function(){return{fields:i(),validations:d()}},e[O.REMOVED_PRODUCT]=function(){return{fields:n,validations:r}},e[O.CLICKED_PRODUCT]=function(){return{fields:o(),validations:l()}},e[O.VIEWED_PRODUCT]=function(){return{fields:t.listItem?o():a(),validations:t.listItem?l():p()}},e[O.CLICKED_CAMPAIGN]=function(){return{fields:h,validations:v}},e[O.VIEWED_CAMPAIGN]=function(){return{fields:t.campaign?h:y,validations:t.campaign?v:E}},e[O.VIEWED_CHECKOUT_STEP]=function(){return{fields:u(),validations:m()}},e[O.COMPLETED_CHECKOUT_STEP]=function(){return{fields:["step","option"],validations:{step:{errors:["required"],warnings:["numeric"]},option:{warnings:["required","string"]}}}},e[O.COMPLETED_TRANSACTION]=function(){return{fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.category","transaction.lineItems[].product.unitSalePrice","transaction.total","transaction.affiliation","transaction.tax","transaction.shippingCost","transaction.vouchers"],validations:{"transaction.orderId":{errors:["required"],warning:["string"]},"transaction.lineItems[].product.id":{warnings:["required","string"]},"transaction.lineItems[].product.name":{warnings:["required","string"]},"transaction.lineItems[].product.category":{warnings:["required","array"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"transaction.total":{warnings:["required","numeric"]},"transaction.currency":{warnings:["required","string"]},"transaction.vouchers":{warnings:["array"]},"transaction.tax":{warnings:["numeric"]}}}},e),I=_[t.name];return I=I?I():{fields:["label","action","category","value","nonInteraction"],validations:{label:{warnings:["string"]},action:{warnings:["string"]},category:{warnings:["string"]},value:{warnings:["numeric"]},nonInteraction:{warnings:["boolean"]}}},(0,b.default)(I.fields,this.getAllDimensionsProps()),I},e.prototype.initialize=function(t){this.initVersion=t||this.initVersion,this.initVersion||this.getOption("namespace")||!1===this.getOption("namespace")||this.setOption("namespace","ddl"),this.prepareCustomDimensions(),this.getOption("trackingId")&&(this.pageCalled=!1,window.GoogleAnalyticsObject="ga",window.ga=window.ga||function(){window.ga.q=window.ga.q||[],window.ga.q.push(arguments)},window.ga.l=(new Date).getTime(),"localhost"===window.location.hostname&&this.setOption("domain","none"),this.initializeTracker(this.getOption("trackingId"),this.getOption("namespace")),this.getOption("alternativeTrackingId")&&this.getOption("alternativeNamespace")&&this.initializeTracker(this.getOption("alternativeTrackingId"),this.getOption("alternativeNamespace")),this.sendClientId(),this.getOption("enhancedLinkAttribution")&&this.ga(["require","linkid","linkid.js"],this.getOption("noConflict")),this.getOption("optimizeContainerId")&&this.ga(["require",this.getOption("optimizeContainerId")],this.getOption("noConflict")),this.getOption("enhancedEcommerce")&&this.loadEnhancedEcommerce(),this.getOption("anonymizeIp")&&this.ga(["set","anonymizeIp",!0],this.getOption("noConflict"))),this.enrichDigitalData()},e.prototype.sendClientId=function(){var t=this.getOption("clientIdCustomDimension");t&&this.ga(["set","customTask",function(e){e.set(t,e.get("clientId"))}])},e.prototype.prepareCustomDimensions=function(){var t=this;this.enrichableDimensionsProps=[],this.allDimensionsProps=[],this.productLevelDimensions={},this.hitLevelDimensions={},this.userLevelDimensions={};var e=Object.assign(this.getOption("metrics"),this.getOption("dimensions"),this.getOption("contentGroups"),this.getOption("fields"));if(this.initVersion)(0,h.default)(e,function(e,n){n.type===C.PRODUCT_VAR?t.productLevelDimensions[e]=n.value:n.type===C.DIGITALDATA_VAR?(t.enrichableDimensionsProps.push(n.value),t.allDimensionsProps.push(n.value),t.userLevelDimensions[e]=n.value):n.type===C.EVENT_VAR&&(t.allDimensionsProps.push(n.value),t.hitLevelDimensions[e]=n.value)});else{e=Object.assign(e,this.getOption("contentGroupings")),(0,h.default)(e,function(e,n){t.enrichableDimensionsProps.push(n),t.hitLevelDimensions[e]=n});var n=Object.assign(this.getOption("productMetrics"),this.getOption("productDimensions"));(0,h.default)(n,function(e,n){t.productLevelDimensions[e]=n})}},e.prototype.getEnrichableDimensionsProps=function(){return this.enrichableDimensionsProps||[]},e.prototype.getAllDimensionsProps=function(){return this.allDimensionsProps||[]},e.prototype.getProductLevelDimensions=function(){return this.productLevelDimensions||[]},e.prototype.getHitLevelDimensions=function(){return this.hitLevelDimensions||[]},e.prototype.getUserLevelDimensions=function(){return this.userLevelDimensions||[]},e.prototype.initializeTracker=function(t,e){if(window.ga("create",t,(0,g.default)({cookieDomain:this.getOption("domain"),siteSpeedSampleRate:this.getOption("siteSpeedSampleRate"),allowLinker:!0,name:e||void 0})),this.getOption("crossDomainTracking")){var n=e?e+".":"";window.ga(n+"require","linker"),window.ga(n+"linker:autoLink",this.getOption("linkedDomains")||[])}},e.prototype.hasAlternativeTracker=function(){return this.getOption("alternativeTrackingId")&&this.getOption("alternativeNamespace")},e.prototype.gaWithNamespace=function(t,e){var n=e.slice(0).shift(),r=e.slice(1);if(n){var i,o=[t,n].join("."),a=[o].concat(r);(i=window).ga.apply(i,a)}},e.prototype.gaAlternative=function(t){this.gaWithNamespace(this.getOption("alternativeNamespace"),t)},e.prototype.ga=function(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))if(this.getOption("namespace"))this.gaWithNamespace(this.getOption("namespace"),t);else{var e;(e=window).ga.apply(e,t)}this.hasAlternativeTracker()&&this.gaAlternative(t)},e.prototype.isLoaded=function(){return!!window.gaplugins},e.prototype.reset=function(){(0,l.default)(window,"GoogleAnalyticsObject"),(0,l.default)(window,"ga"),(0,l.default)(window,"gaplugins"),this.pageCalled=!1},e.prototype.getCustomDimensions=function(t,e){var n=void 0;n="product"===e?this.getProductLevelDimensions():"user"===e?this.getUserLevelDimensions():this.getHitLevelDimensions();var r={};return(0,h.default)(n,function(e,n){var i=(0,p.getProp)(t,n);void 0!==i&&("boolean"==typeof i&&(i=i.toString()),r[e]=i)}),r},e.prototype.loadEnhancedEcommerce=function(){var t=this.getOption("noConflict");this.getOption("namespace")&&(t=!1),this.ga(["require","ec"],t),this.enhancedEcommerceLoaded=!0},e.prototype.pushEnhancedEcommerce=function(t,e){var n=this.getCustomDimensions(t,"user");if(this.setUserCustomDimensions(n,e),this.getPageview()){var r=this.getCustomDimensions(t,"hit");this.setUserCustomDimensions(r,e),this.flushPageview()}else{var i=[],o=this.getCustomDimensions(t,"hit"),a=Object.assign({nonInteraction:!!t.nonInteraction},o);["send","event",t.category||"Ecommerce",t.action||t.name||"not defined",t.label,a].forEach(function(t){void 0!==t&&i.push(t)}),this.ga(i,e)}},e.prototype.getGaClientId=function(){var t=w.default.get("_ga");if(t){var e=t.match(/(\d+\.\d+)$/);return e?e[1]:null}},e.prototype.enrichDigitalData=function(){var t=this,e=this.getGaClientId();e&&this.digitalData.changes.push(["user.googleClientId",e,this.getName()+" Integration"]),e||window.ga(function(e){var n=t.getOption("namespace");(e=e||window.ga.getByName(n))&&t.digitalData.changes.push(["user.googleClientId",e.get("clientId"),t.getName()+" Integration"])}),this.onEnrich()},e.prototype.isPageviewDelayed=function(t){if(!this.getOption("enhancedEcommerce"))return!1;var e={product:O.VIEWED_PRODUCT_DETAIL,cart:[O.VIEWED_CHECKOUT_STEP],confirmation:O.COMPLETED_TRANSACTION,checkout:O.VIEWED_CHECKOUT_STEP},n=e[t];return!!n&&(Array.isArray(n)||(n=[n]),!0)},e.prototype.getProductCategory=function(t){var e=t.category;return Array.isArray(e)?e=e.join("/"):e&&t.subcategory&&(e=e+"/"+t.subcategory),this.transliterate(e)},e.prototype.transliterate=function(t){return this.getOption("transliterate")?(this.transliterateObj||(this.transliterateObj=(0,D.default)()),this.transliterateObj.transform(t)):t},e.prototype.trackEvent=function(t){if(t.name===O.VIEWED_PAGE)this.onViewedPage(t);else if(t.name===O.EXCEPTION)this.onException(t);else if(this.getOption("enhancedEcommerce")){var e,n=(e={},e[O.VIEWED_PRODUCT]=this.onViewedProduct,e[O.CLICKED_PRODUCT]=this.onClickedProduct,e[O.VIEWED_PRODUCT_DETAIL]=this.onViewedProductDetail,e[O.ADDED_PRODUCT]=this.onAddedProduct,e[O.REMOVED_PRODUCT]=this.onRemovedProduct,e[O.COMPLETED_TRANSACTION]=this.onCompletedTransactionEnhanced,e[O.REFUNDED_TRANSACTION]=this.onRefundedTransaction,e[O.VIEWED_CAMPAIGN]=this.onViewedCampaign,e[O.CLICKED_CAMPAIGN]=this.onClickedCampaign,e[O.VIEWED_CHECKOUT_STEP]=this.onViewedCheckoutStep,e[O.COMPLETED_CHECKOUT_STEP]=this.onCompletedCheckoutStep,e),r=n[t.name];r?r.bind(this)(t):this.onCustomEvent(t)}else t.name===O.COMPLETED_TRANSACTION?this.onCompletedTransaction(t):[O.VIEWED_PRODUCT_DETAIL,O.VIEWED_PRODUCT_LISTING,O.SEARCHED_PRODUCTS,O.COMPLETED_TRANSACTION,O.VIEWED_PRODUCT,O.CLICKED_PRODUCT,O.ADDED_PRODUCT,O.REMOVED_PRODUCT,O.VIEWED_CHECKOUT_STEP,O.COMPLETED_CHECKOUT_STEP].indexOf(t.name)<0&&this.onCustomEvent(t)},e.prototype.setPageview=function(t){this.pageview=(0,g.default)(t)},e.prototype.getPageview=function(){return this.pageview},e.prototype.flushPageview=function(){this.ga(["send","pageview",this.pageview],this.getOption("noConflict")),this.pageCalled=!0,this.pageview=null},e.prototype.onViewedPage=function(t){var e=this,n=t.page,r=t.nonInteraction,i={},o=n.url,a=n.path;n.queryString&&(a+=n.queryString);var s=this.transliterate(n.name||n.title);i.page=a,i.title=s,i.location=o,i.nonInteraction=r,this.pageCalled&&(0,l.default)(i,"location");var c=this.getCustomDimensions(t,"hit"),u=Object.assign(i,c);if(this.setPageview(u),this.getOption("sendUserId")){var d=(0,p.getProp)(t,"user.userId");d&&this.ga(["set","userId",d],this.getOption("noConflict"))}if(this.getOption("enhancedEcommerce")){var f=(0,p.getProp)(t,"website.currency")||this.getOption("defaultCurrency");this.ga(["set","&cu",f],this.getOption("noConflict"))}this.ga(["set",{page:a,title:s}],this.getOption("noConflict"));var g=this.getCustomDimensions(t,"user");this.setUserCustomDimensions(g,this.getOption("noConflict")),this.isPageviewDelayed(n.type)?setTimeout(function(){e.getPageview()&&e.flushPageview()},100):this.flushPageview()},e.prototype.onViewedProduct=function(t){var e=this;t.nonInteraction=!0;var n=t.listItems;n&&Array.isArray(n)||!t.listItem||(n=[t.listItem]),n.forEach(function(t){var n=t.product;if(n.id||n.skuCode||n.name){var r=e.getCustomDimensions(n,"product"),i=Object.assign({id:n.id||n.skuCode,name:e.transliterate(n.name),list:e.transliterate(t.listName),category:e.getProductCategory(n),brand:e.transliterate(n.brand||n.manufacturer),price:n.unitSalePrice||n.unitPrice,currency:n.currency||e.getOption("defaultCurrency"),variant:e.transliterate(n.variant),position:t.position},r);e.ga(["ec:addImpression",i],e.getOption("noConflict"))}}),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))},e.prototype.onClickedProduct=function(t){t.listItem&&(this.enhancedEcommerceProductAction(t,"click",{list:t.listItem.listName}),this.pushEnhancedEcommerce(t,this.getOption("noConflict")))},e.prototype.onViewedProductDetail=function(t){t.nonInteraction=!0,this.enhancedEcommerceProductAction(t,"detail"),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))},e.prototype.onAddedProduct=function(t){this.enhancedEcommerceProductAction(t,"add"),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))},e.prototype.onRemovedProduct=function(t){this.enhancedEcommerceProductAction(t,"remove"),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction;n&&n.orderId&&(this.ecommerce||(this.ga(["require","ecommerce"],this.getOption("noConflict")),this.ecommerce=!0),this.ga(["ecommerce:addTransaction",{id:n.orderId,affiliation:n.affiliation,shipping:n.shippingCost,tax:n.tax,revenue:n.total||n.subtotal||0,currency:n.currency}],this.getOption("noConflict")),(0,h.default)(n.lineItems,function(t,r){var i=r.product;i&&e.ga(["ecommerce:addItem",{id:i.id,category:e.getProductCategory(i),quantity:r.quantity,price:i.unitSalePrice||i.unitPrice,name:e.transliterate(i.name),sku:i.skuCode,currency:i.currency||n.currency}],e.getOption("noConflict"))}),this.ga(["ecommerce:send"],this.getOption("noConflict")))},e.prototype.onCompletedTransactionEnhanced=function(t){var e=this,n=t.transaction;if(n&&n.orderId){(0,h.default)(n.lineItems,function(t,r){var i=r.product;i&&(i.currency=i.currency||n.currency||e.getOption("defaultCurrency"),e.enhancedEcommerceTrackProduct(r.product,r.quantity))});var r=s(n);this.ga(["ec:setAction","purchase",{id:n.orderId,affiliation:n.affiliation,revenue:n.total||n.subtotal||0,tax:n.tax,shipping:n.shippingCost,coupon:r}],this.getOption("noConflict")),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))}},e.prototype.onRefundedTransaction=function(t){var e=this,n=t.transaction;n&&n.orderId&&((0,h.default)(n.lineItems,function(t,r){var i=r.product;i&&(i.currency=i.currency||n.currency||e.getOption("defaultCurrency"),e.enhancedEcommerceTrackProduct(r.product,r.quantity))}),this.ga(["ec:setAction","refund",{id:n.orderId}],this.getOption("noConflict")),this.pushEnhancedEcommerce(t,this.getOption("noConflict")))},e.prototype.onViewedCampaign=function(t){var e=this;t.nonInteraction=!0;var n=t.campaigns;n&&Array.isArray(n)||!t.campaign||(n=[t.campaign]),n.forEach(function(t){t&&t.id&&e.ga(["ec:addPromo",{id:e.transliterate(t.id),name:e.transliterate(t.name),creative:e.transliterate(t.design||t.creative),position:e.transliterate(t.position)}])}),this.pushEnhancedEcommerce(t)},e.prototype.onClickedCampaign=function(t){var e=t.campaign;e&&e.id&&(this.ga(["ec:addPromo",{id:e.id,name:this.transliterate(e.name),creative:this.transliterate(e.design||e.creative),position:this.transliterate(e.position)}]),this.ga(["ec:setAction","promo_click",{}]),this.pushEnhancedEcommerce(t))},e.prototype.onViewedCheckoutStep=function(t){var e=this;t.nonInteraction=!0;var n=(0,p.getProp)(t,"cart")||(0,p.getProp)(t,"transaction");(0,h.default)(n.lineItems,function(t,r){var i=r.product;i&&(i.currency=i.currency||n.currency||e.getOption("defaultCurrency"),e.enhancedEcommerceTrackProduct(r.product,r.quantity))}),this.ga(["ec:setAction","checkout",{step:t.step||1,option:c(t,this.getOption("checkoutOptions"))||void 0}],this.getOption("noConflict")),this.pushEnhancedEcommerce(t,this.getOption("noConflict"))},e.prototype.onCompletedCheckoutStep=function(t){var e=c(t,this.getOption("checkoutOptions"));t.step&&e&&(this.ga(["ec:setAction","checkout_option",{step:t.step,option:e}],this.getOption("noConflict")),this.pushEnhancedEcommerce(t,this.getOption("noConflict")))},e.prototype.onCustomEvent=function(t){var e=this.getCustomDimensions(t,"user");this.setUserCustomDimensions(e,this.getOption("noConflict"));var n=Object.assign({eventAction:t.action||t.name||"event",eventCategory:t.category||"All",eventLabel:t.label,eventValue:Math.round(t.value)||0,nonInteraction:!!t.nonInteraction},this.getCustomDimensions(t,"hit"));this.ga(["send","event",(0,g.default)(n)])},e.prototype.onException=function(t){t.exception&&t.exception.message&&this.ga(["send","exception",{exDescription:t.exception.description||t.exception.message,exFatal:t.exception.isFatal||!1,nonInteraction:!0}])},e.prototype.setUserCustomDimensions=function(t,e){(0,v.default)(t)&&this.ga(["set",t],e)},e.prototype.enhancedEcommerceTrackProduct=function(t,e,n){if(t){var r=this.getCustomDimensions(t,"product"),i=Object.assign({id:t.id||t.skuCode,name:this.transliterate(t.name),category:this.getProductCategory(t),price:t.unitSalePrice||t.unitPrice,brand:this.transliterate(t.brand||t.manufacturer),variant:this.transliterate(t.variant),currency:t.currency||this.getOption("defaultCurrency")},r);e&&(i.quantity=e),n&&(i.position=n),t.voucher&&(i.coupon=t.voucher),this.ga(["set","&cu",i.currency],this.getOption("noConflict")),this.ga(["ec:addProduct",i],this.getOption("noConflict"))}},e.prototype.enhancedEcommerceProductAction=function(t,e,n){var r=t.listItem?t.listItem.position:void 0,i=t.listItem?t.listItem.product:t.product;i&&i.id&&(this.enhancedEcommerceTrackProduct(i,t.quantity,r),this.ga(["ec:setAction",e,n||{}],this.getOption("noConflict")))},e}(P.default);n.default=k},{"../Integration":143,"../events/semanticEvents":158,"../variableTypes":231,"./utils/transliterate":218,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8,"@segmentstream/utils/size":36,"js-cookie":102}],185:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("../Integration"),l=r(d),p=function(t){function e(n,r){i(this,e);var a=Object.assign({containerId:null,noConflict:!1},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//www.googletagmanager.com/gtm.js?id="+r.containerId+"&l=dataLayer"}}),s}return a(e,t),e.prototype.allowCustomEvents=function(){return!0},e.prototype.getEventValidationConfig=function(t){return{fields:Object.keys(t)}},e.prototype.initialize=function(){window.dataLayer=window.dataLayer||[],this.ddManager.on("ready",function(){window.dataLayer.push({event:"DDManager Ready"})}),this.ddManager.on("load",function(){window.dataLayer.push({event:"DDManager Loaded"})}),this.getOption("containerId")&&!1===this.getOption("noConflict")&&window.dataLayer.push({"gtm.start":Number(new Date),event:"gtm.js"})},e.prototype.isLoaded=function(){return!(!window.google_tag_manager||!window.google_tag_manager[this.getOption("containerId")])},e.prototype.reset=function(){(0,u.default)(window,"dataLayer"),(0,u.default)(window,"google_tag_manager")},e.prototype.trackEvent=function(t){var e=Object.assign({},t),n=e.name,r=e.category;(0,u.default)(e,"name"),(0,u.default)(e,"category"),e.event=n,e.eventCategory=r,window.dataLayer.push(e)},e}(l.default);n.default=p},{"../Integration":143,"@segmentstream/utils/deleteProperty":5}],186:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("../Integration"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=function(t){function e(n,o){r(this,e);var a=Object.assign({widgetId:""},o),s=i(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//code.jivosite.com/script/widget/"+o.widgetId+";"}}),s}return o(e,t),e.prototype.isLoaded=function(){return!!window.jivo_version},e}(c.default);n.default=u},{"../Integration":143}],187:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/getVarValue"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("@segmentstream/utils/cleanObject"),g=r(f),m=t("../Integration"),h=r(m),y=t("./utils/AsyncQueue"),v=r(y),E=t("../events/semanticEvents"),w=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:"",labelVar:void 0},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//k50-a.akamaihd.net/k50/k50tracker2.js",async:!0}}),s}return a(e,t),e.prototype.initialize=function(){var t=this;this.asyncQueue=new v.default(function(){return t.isLoaded()})},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.isLoaded=function(){return!!(0,p.getProp)(window,"k50Tracker.init")},e.prototype.reset=function(){(0,u.default)(window,"k50Tracker"),this.pageTracked=!1},e.prototype.getSemanticEvents=function(){return[E.VIEWED_PAGE]},e.prototype.getEnrichableEventProps=function(t){var e=["page.url"],n=this.getOption("labelVar");return n&&"digitalData"===n.type&&e.push(n.value),e},e.prototype.getLabel=function(t){var e=this.getOption("labelVar");return e?(0,l.default)(e,t):void 0},e.prototype.trackEvent=function(t){var e,n=(e={},e[E.VIEWED_PAGE]="onViewedPage",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.asyncQueue.push(function(){if(e.pageTracked)return window.k50Tracker.change(!0,(0,g.default)({landing:(0,p.getProp)(t,"page.url"),label:e.getLabel(t)}));window.k50Tracker.init((0,g.default)({siteId:e.getOption("siteId"),label:e.getLabel(t)})),e.pageTracked=!0})},e}(h.default);n.default=w},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getVarValue":14}],188:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/getQueryParam"),u=r(c),d=t("@segmentstream/utils/topDomain"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("../Integration"),g=r(f),m=t("../events/semanticEvents"),h=t("./utils/affiliate"),y="linkprofit_click_hash",v="linkprofit_affiliate_id",E=function(t){function e(n,r){i(this,e);var a=Object.assign({defaultCampaignId:"",clickHashCookieName:y,affiliateIdCookieName:v,cookieTracking:!0,cookieDomain:(0,l.default)(window.location.href),cookieTtl:90,deduplication:!1,utmSource:"linkprofit",deduplicationUtmMedium:[]},r),s=o(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag({type:"img",attr:{src:"https://cpa.linkprofit.ru/sale?OrderID={{ orderId }}&ClickHash={{ clickHash }}&CampaignID={{ campaignId }}&AffiliateID={{ affiliateId }}"}}),s}return a(e,t),e.prototype.initialize=function(){if(this._isLoaded=!0,this.getOption("cookieTracking")){var t=(0,u.default)("ClickHash"),e=(0,u.default)("AffiliateID");if(t&&e){var n=this.getOption("clickHashCookieName"),r=this.getOption("affiliateIdCookieName"),i=this.getOption("cookieTtl"),o=this.getOption("cookieDomain");(0,h.addAffiliateCookie)(n,t,i,o),(0,h.addAffiliateCookie)(r,e,i,o)}}},e.prototype.getSemanticEvents=function(){return[m.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){return t.name===m.COMPLETED_TRANSACTION?["transaction","context.campaign"]:[]},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[m.COMPLETED_TRANSACTION]={fields:["transaction.orderId","context.campaign.source","context.campaign.medium","integrations.linkprofit.campaignId"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e=(0,h.getAffiliateCookie)(this.getOption("clickHashCookieName")),n=(0,h.getAffiliateCookie)(this.getOption("affiliateIdCookieName"));if(e){var r=(0,p.getProp)(t,"context.campaign"),i=this.getOption("utmSource"),o=this.getOption("deduplicationUtmMedium");(0,h.isDeduplication)(r,i,o)||t.name===m.COMPLETED_TRANSACTION&&this.onCompletedTransaction(t,e,n)}},e.prototype.isDeduplication=function(t){if(this.getOption("deduplication")){var e=(0,p.getProp)(t,"context.campaign.source");if(!e||e.toLowerCase()!==this.getOption("utmSource")){var n=this.getOption("deduplicationUtmMedium")||[];if(!n||0===n.length)return!0;var r=(0,p.getProp)(t,"context.campaign.medium");if(n.indexOf(r.toLowerCase())>=0)return!0}}return!1},e.prototype.onCompletedTransaction=function(t,e,n){var r=t.transaction;if(r&&r.orderId){var i=r.orderId,o=(0,p.getProp)(t,"integrations.linkprofit.campaignId")||this.getOption("defaultCampaignId");this.load({orderId:i,clickHash:e,affiliateId:n,campaignId:o})}},e}(g.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/topDomain":37}],189:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/cleanObject"),p=r(l),f=t("@segmentstream/utils/isEmpty"),g=r(f),m=t("@segmentstream/utils/arrayMerge"),h=r(m),y=t("@segmentstream/utils/semver"),v=r(y),E=t("../Integration"),w=r(E),_=t("../events/semanticEvents"),b=t("../IntegrationUtils"),I="V2",P="V3",T=["authenticationTicket","ids","area","firstName","lastName","middleName","fullName","mobilePhone","email","birthDate","sex"],D=function(t){return{email:"Email",sms:"Sms"}[t]},O=function(t){function e(n,r){i(this,e);var a=Object.assign({apiVersion:I,endpointId:"",projectSystemName:"",webpush:!1,includeManifest:!0,firebaseMessagingSenderId:"",useCustomServiceWorkerPath:!1,serviceWorkerPath:"",serviceWorkerScope:"",brandSystemName:"",pointOfContactSystemName:"",projectDomain:"",operationMapping:{},setCartOperation:"",userVars:{},productVars:{},orderVars:{},userIdProvider:void 0,customerIdsMapping:{},productIdsMapping:{},productSkuIdsMapping:{},productCategoryIdsMapping:{},areaIdsMapping:{},orderIdsMapping:{},pushSubscriptionTriggerEvent:"Agreed to Receive Push Notifications"},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[_.VIEWED_PAGE,_.LOGGED_IN,_.REGISTERED,_.SUBSCRIBED,_.UPDATED_PROFILE_INFO,_.VIEWED_PRODUCT_DETAIL,_.VIEWED_PRODUCT_LISTING,_.ADDED_PRODUCT,_.REMOVED_PRODUCT,_.ADDED_PRODUCT_TO_WISHLIST,_.REMOVED_PRODUCT_FROM_WISHLIST,_.COMPLETED_TRANSACTION,_.UPDATED_CART],s.isWebpush()&&s.SEMANTIC_EVENTS.push(s.getOption("pushSubscriptionTriggerEvent")),s.prepareEnrichableUserProps(),s.prepareEnrichableAreaIds(),s.prepareEnrichableUserIds(),s.prepareEnrichableCategoryIds(),s.operationEvents=Object.keys(s.getOption("operationMapping")),s.operationEvents.forEach(function(t){s.SEMANTIC_EVENTS.indexOf(t)<0&&s.SEMANTIC_EVENTS.push(t)}),s.addTag({type:"script",attr:{id:"mindbox",src:"//api.mindbox.ru/scripts/v1/tracker.js"}}),s.isWebpush()&&s.getOption("includeManifest")&&s.addTag("webpush",{type:"link",attr:{rel:"manifest",href:"https://api.mindbox.ru/assets/manifest.json"}}),s}return a(e,t),e.prototype.initialize=function(){window.mindbox=window.mindbox||function(){window.mindbox.queue.push(arguments)},window.mindbox.queue=window.mindbox.queue||[];var t=this.getOption("apiVersion")===P?{endpointId:this.getOption("endpointId")}:{projectSystemName:this.getOption("projectSystemName"),brandSystemName:this.getOption("brandSystemName"),pointOfContactSystemName:this.getOption("pointOfContactSystemName"),projectDomain:this.getOption("projectDomain")};if(this.isWebpush()&&(this.getOption("includeManifest")&&this.load("webpush"),t.firebaseMessagingSenderId=this.getOption("firebaseMessagingSenderId"),this.hasCustomServiceWorkerPath())){t.serviceWorkerPath=this.getOption("serviceWorkerPath");var e=this.getOption("serviceWorkerScope");e&&(t.serviceWorkerScope=e)}window.mindbox("create",t),this.isWebpush()&&window.mindbox("webpush.create")},e.prototype.isWebpush=function(){return this.getOption("webpush")},e.prototype.hasCustomServiceWorkerPath=function(){return!(!this.getOption("useCustomServiceWorkerPath")||!this.getOption("serviceWorkerPath"))},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.prepareEnrichableUserProps=function(){this.enrichableUserProps=(0,b.getEnrichableVariableMappingProps)(this.getOption("userVars"))},e.prototype.prepareEnrichableAreaIds=function(){this.enrichableAreIds=(0,b.getEnrichableVariableMappingProps)(this.getOption("areaIdsMapping"))},e.prototype.prepareEnrichableUserIds=function(){this.enrichableUserIds=(0,b.getEnrichableVariableMappingProps)(this.getOption("customerIdsMapping"))},e.prototype.prepareEnrichableCategoryIds=function(){this.enrichableCategoryIds=(0,b.getEnrichableVariableMappingProps)(this.getOption("productCategoryIdsMapping"))},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case _.VIEWED_PAGE:e=[].concat(this.getEnrichableUserIds(),["cart"]);break;case _.UPDATED_CART:e=["cart"];break;case _.LOGGED_IN:case _.REGISTERED:e=[].concat(this.getEnrichableUserIds(),this.getEnrichableAreaIds()),t.user||(0,h.default)(e,[].concat(this.getEnrichableUserProps(),["user.userId","user.isSubscribed","user.isSubscribedBySms","user.subscriptions"]));break;case _.SUBSCRIBED:e=[].concat(this.getEnrichableAreaIds()),t.user||(0,h.default)(e,[].concat(this.getEnrichableUserProps(),["user.isSubscribed","user.isSubscribedBySms","user.subscriptions"]));break;case _.UPDATED_PROFILE_INFO:t.user||(e=[].concat(this.getEnrichableUserIds(),this.getEnrichableAreaIds(),this.getEnrichableUserProps(),["user.userId","user.isSubscribed","user.isSubscribedBySms","user.subscriptions"]));break;case _.COMPLETED_TRANSACTION:e=[].concat(this.getEnrichableUserIds(),this.getEnrichableAreaIds(),this.getEnrichableUserProps(),["user.userId","transaction"]);break;case _.VIEWED_PRODUCT_DETAIL:e=["product"];break;case _.VIEWED_PRODUCT_LISTING:e=[].concat(this.getEnrichableCategoryIds(),["listing.categoryId"])}return e},e.prototype.getEventValidationConfig=function(t){var e,n=[],r={},i=["cart.lineItems[].product.id","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity"],o={"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]},"cart.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}};this.getOption("setCartOperation")&&(n=i,r=o);var a=[].concat(this.getEnrichableUserProps(),["user.userId","user.isSubscribed"]),s=["product.id","product.unitSalePrice"],c={"product.id":{errors:["required"],warnings:["string"]},"product.unitSalePrice":{errors:["required"],warnings:["numeric"]}};return(e={},e[_.VIEWED_PAGE]={fields:n,validations:r},e[_.REGISTERED]={fields:a},e[_.SUBSCRIBED]={fields:a},e[_.UPDATED_PROFILE_INFO]={fields:a},e[_.LOGGED_IN]={fields:a},e[_.VIEWED_PRODUCT_DETAIL]={fields:["product.id"],validation:{"product.id":{errors:["required"],warnings:["string"]}}},e[_.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId"],validations:{"listing.categoryId":{errors:["required"],warnings:["string"]}}},e[_.UPDATED_CART]={fields:i,validations:o},e[_.ADDED_PRODUCT]={fields:s,validations:c},e[_.REMOVED_PRODUCT]={fields:s,validations:c},e[_.ADDED_PRODUCT_TO_WISHLIST]={fields:s,validations:c},e[_.REMOVED_PRODUCT_FROM_WISHLIST]={fields:s,validations:c},e[_.COMPLETED_TRANSACTION]={fields:[].concat(a,["transaction.orderId","transaction.total","transaction.shippingMethod","transaction.paymentMethod","transaction.lineItems[].product.id","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity"]),validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]},"transaction.shippingMethod":{warnings:["required","string"]},"transaction.paymentMethod":{warnings:["required","string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.getEnrichableUserProps=function(){return this.enrichableUserProps},e.prototype.getEnrichableUserIds=function(){return this.enrichableUserIds},e.prototype.getEnrichableAreaIds=function(){return this.enrichableAreIds},e.prototype.getEnrichableCategoryIds=function(){return this.enrichableCategoryIds},e.prototype.isLoaded=function(){return window.mindboxInitialized},e.prototype.getOperationName=function(t){return this.getOption("operationMapping")[t]},e.prototype.getIdentificator=function(t,e){var n=void 0;if(this.getOption("userIdProvider")){var r=(0,c.getProp)(t,"user.userId");if(r&&(n={provider:this.getOption("userIdProvider"),identity:r},!e||"userId"===e))return n}var i=(0,c.getProp)(t,"user.email");if(i&&(n={provider:"email",identity:i}),n&&(!e||"email"===e))return n;var o=(0,c.getProp)(t,"user.phone");return o?{provider:"mobilePhone",identity:o}:null},e.prototype.getCustomerData=function(t){var e=this.getOption("userVars"),n=(0,b.extractVariableMappingValues)(t,e);if(n.authenticationTicket&&t.name!==_.UPDATED_PROFILE_INFO&&(0,d.default)(n,"authenticationTicket"),this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=this.getV3Area(t);r&&(n.ids=r),i&&t.name!==_.COMPLETED_TRANSACTION&&(n.area=i);Object.keys(n).reduce(function(t,e){return T.indexOf(e)<0&&((0,c.setProp)(n,"customFields."+e,n[e]),(0,d.default)(n,e)),n},n)}return n},e.prototype.getSubscriptions=function(t,e){var n=(0,c.getProp)(t,"user.subscriptions"),r=void 0;if(n&&Array.isArray(n))r=n.map(function(t){return{pointOfContact:D(t.type),topic:t.topic,isSubscribed:t.isSubscribed,valueByDefault:!!e||void 0}});else if(this.digitalData.version&&v.default.cmp(this.digitalData.version,"1.1.3")<0){var i=(0,c.getProp)(t,"user.isSubscribed");void 0!==i&&(r=r||[],r.push((0,p.default)({pointOfContact:"Email",isSubscribed:i,valueByDefault:!!e||void 0})));var o=(0,c.getProp)(t,"user.isSubscribedBySms");void 0!==o&&(r=r||[],r.push((0,p.default)({pointOfContact:"Sms",isSubscribed:o,valueByDefault:!!e||void 0})))}return r},e.prototype.getProductCustoms=function(t){var e=this.getOption("productVars"),n={};return Object.keys(e).forEach(function(r){var i=(0,c.getProp)(t,e[r]);i&&(n[r]=i)}),n},e.prototype.getProductIds=function(t){var e=this.getOption("productIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getProductSkuIds=function(t){var e=this.getOption("productSkuIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getProductCategoryIds=function(t){var e=this.getOption("productCategoryIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getAreaIds=function(t){var e=this.getOption("areaIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getOrderIds=function(t){var e=this.getOption("orderIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getCustomerIds=function(t){var e=this.getOption("customerIdsMapping"),n=(0,b.extractVariableMappingValues)(t,e);return(0,g.default)(n)?void 0:n},e.prototype.getV3Area=function(t){var e=this.getAreaIds(t);if(e)return{ids:e}},e.prototype.getV3Product=function(t){var e=this.getProductSkuIds(t);return{ids:this.getProductIds(t),sku:e?{ids:e}:void 0}},e.prototype.getV3ProductList=function(t){var e=this;return t.map(function(t){var n=e.getV3Product(t.product),r=t.quantity||1;return{product:n,count:r,price:t.subtotal||r*(0,c.getProp)(t,"product.unitSalePrice")}})},e.prototype.trackEvent=function(t){var e,n=(e={},e[_.VIEWED_PAGE]=this.onViewedPage.bind(this),e[_.VIEWED_PRODUCT_DETAIL]=this.onViewedProductDetail.bind(this),e[_.VIEWED_PRODUCT_LISTING]=this.onViewedProductListing.bind(this),e[_.ADDED_PRODUCT]=this.onAddedProduct.bind(this),e[_.REMOVED_PRODUCT]=this.onRemovedProduct.bind(this),e[_.LOGGED_IN]=this.onLoggedIn.bind(this),e[_.REGISTERED]=this.onRegistered.bind(this),e[_.SUBSCRIBED]=this.onSubscribed.bind(this),e[_.UPDATED_PROFILE_INFO]=this.onUpdatedProfileInfo.bind(this),e[_.UPDATED_CART]=this.onUpdatedCart.bind(this),e[_.COMPLETED_TRANSACTION]=this.onCompletedTransaction.bind(this),e[_.ADDED_PRODUCT_TO_WISHLIST]=this.onAddedProductToWishlist.bind(this),e[_.REMOVED_PRODUCT_FROM_WISHLIST]=this.onRemovedProductFromWishlist.bind(this),e);this.getOption("pushSubscriptionTriggerEvent")===t.name&&this.onPushSubscriptionTriggerEvent(t);var r=t.operation||(0,c.getProp)(t,"integrations.mindbox.operation")||this.getOperationName(t.name);(r||t.name===_.VIEWED_PAGE)&&(n[t.name]?n[t.name](t,r):this.onCustomEvent(t,r))},e.prototype.onViewedPage=function(t){var e=this.getOption("setCartOperation");e&&t.cart&&this.onUpdatedCart(t,e)},e.prototype.onUpdatedCart=function(t,e){var n=this,r=t.cart||{},i=r.lineItems||[];if(this.getOption("apiVersion")===P){var o=this.getCustomerIds(t),a=void 0;o&&(a={ids:o}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:a,productList:this.getV3ProductList(i)}}))}else window.mindbox("performOperation",{operation:e,data:{action:{personalOffers:i.map(function(t){var e=t.quantity||1;return Object.assign({productId:(0,c.getProp)(t,"product.id"),count:e,price:(0,c.getProp)(t,"product.unitSalePrice")*e},n.getProductCustoms(t.product))})}}})},e.prototype.onLoggedIn=function(t,e){if(this.getOption("apiVersion")===P){var n=t.user||{},r=this.getCustomerIds(t);if(!r)return;window.mindbox("async",{operation:e,data:{customer:(0,p.default)({ids:r,email:(0,c.getProp)(n,"email"),mobilePhone:(0,c.getProp)(n,"phone")})}})}else{var i=this.getIdentificator(t);if(!i)return;var o=(0,p.default)(this.getCustomerData(t));window.mindbox("identify",{operation:e,identificator:i,data:o})}},e.prototype.onRegistered=function(t,e){this.onUpdatedProfileInfo(t,e,!0)},e.prototype.onUpdatedProfileInfo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getSubscriptions(t,n);if(this.getOption("apiVersion")===P){var i=this.getCustomerData(t);if(!i)return;r&&(i.subscriptions=r),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i}}))}else{var o=this.getIdentificator(t);if(!o)return;var a=this.getCustomerData(t);r&&(a.subscriptions=r),window.mindbox("identify",(0,p.default)({operation:e,identificator:o,data:a}))}},e.prototype.onSubscribed=function(t,e){if((t.user||{}).email){var n=void 0,r=(0,c.getProp)(t,"user.subscriptions")||t.subscriptions;if(n=r?(r||[]).map(function(t){return{pointOfContact:D(t.type),topic:t.topic}}):[{pointOfContact:"Email",topic:t.subscriptionList}],this.getOption("apiVersion")===P){var i=this.getCustomerData(t);window.mindbox("async",(0,p.default)({operation:e,data:{customer:Object.assign({},i,{subscriptions:n}),pointOfContact:(0,c.getProp)(t,"campaign.name")}}))}else{var o=this.getIdentificator(t,"email");if(!o)return;var a=this.getCustomerData(t);a.subscriptions=n,window.mindbox("identify",(0,p.default)({operation:e,identificator:o,data:a}))}}},e.prototype.onViewedProductDetail=function(t,e){var n=(0,c.getProp)(t,"product")||{};if(n.id)if(this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=void 0;r&&(i={ids:r}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i,product:this.getV3Product(n)}}))}else window.mindbox("performOperation",{operation:e,data:{action:Object.assign({productId:n.id},this.getProductCustoms(n))}})},e.prototype.onViewedProductListing=function(t,e){if(this.getOption("apiVersion")===P)window.mindbox("async",{operation:e,data:{productCategory:{ids:this.getProductCategoryIds(t)}}});else{var n=(0,c.getProp)(t,"listing.categoryId");if(!n)return;window.mindbox("performOperation",{operation:e,data:{action:{productCategoryId:n}}})}},e.prototype.onAddedProduct=function(t,e){var n=(0,c.getProp)(t,"product")||{};if(this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=void 0;r&&(i={ids:r}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i,addProductToList:{product:this.getV3Product(n),price:n.unitSalePrice}}}))}else{if(!n.id)return;window.mindbox("performOperation",{operation:e,data:{action:Object.assign({productId:n.id,price:n.unitSalePrice},this.getProductCustoms(n))}})}},e.prototype.onRemovedProduct=function(t,e){var n=(0,c.getProp)(t,"product")||{};if(this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=void 0;r&&(i={ids:r}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i,removeProductFromList:{product:this.getV3Product(n),price:n.unitSalePrice}}}))}else{if(!n.id)return;window.mindbox("performOperation",{operation:e,data:{action:Object.assign({productId:n.id,price:n.unitSalePrice},this.getProductCustoms(n))}})}},e.prototype.onAddedProductToWishlist=function(t,e){var n=(0,c.getProp)(t,"product")||{};if(this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=void 0;r&&(i={ids:r}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i,addProductToList:{product:this.getV3Product(n),price:n.unitSalePrice}}}))}else{if(!n.id)return;window.mindbox("performOperation",{operation:e,data:{action:Object.assign({productId:n.id,price:n.unitSalePrice},this.getProductCustoms(n))}})}},e.prototype.onRemovedProductFromWishlist=function(t,e){var n=(0,c.getProp)(t,"product")||{};if(this.getOption("apiVersion")===P){var r=this.getCustomerIds(t),i=void 0;r&&(i={ids:r}),window.mindbox("async",(0,p.default)({operation:e,data:{customer:i,removeProductFromList:{product:this.getV3Product(n),price:n.unitSalePrice}}}))}else{if(!n.id)return;window.mindbox("performOperation",{operation:e,data:{action:Object.assign({productId:n.id,price:n.unitSalePrice},this.getProductCustoms(n))}})}},e.prototype.getV3ProductForTransaction=function(t){var e=this.getProductSkuIds(t);return{ids:this.getProductIds(t),sku:e?{ids:e}:void 0}},e.prototype.onCompletedTransactionV3=function(t,e){var n=this,r=this.getCustomerData(t),i=(0,c.getProp)(t,"transaction.lineItems"),o=[];i&&i.length&&(o=i.map(function(t){var e=n.getProductCustoms(t.product);return e=e&&0!==Object.keys(e).length?e:void 0,(0,p.default)({product:n.getV3ProductForTransaction(t.product),quantity:t.quantity||1,basePricePerItem:(0,c.getProp)(t,"product.unitPrice"),customFields:e})}));var a=this.getOption("orderVars"),s=(0,b.extractVariableMappingValues)(t,a),u=(0,c.getProp)(t,"transaction.paymentMethod"),d=void 0;u&&(d=[{type:u,amount:(0,c.getProp)(t,"transaction.total")}]);var l={ids:this.getOrderIds(t),totalPrice:(0,c.getProp)(t,"transaction.total"),deliveryCost:(0,c.getProp)(t,"transaction.shippingCost"),lines:o,payments:d,area:this.getV3Area(t),customFields:s};window.mindbox("async",(0,p.default)({operation:e,data:{customer:r,order:l}}))},e.prototype.onCompletedTransaction=function(t,e){var n=this;if(this.getOption("apiVersion")===P)return void this.onCompletedTransactionV3(t,e);var r=this.getIdentificator(t);if(r){var i=(0,c.getProp)(t,"transaction.orderId");if(i){var o=(0,c.getProp)(t,"transaction.lineItems"),a=[];o&&o.length&&(a=o.map(function(t){return(0,p.default)(Object.assign({productId:(0,c.getProp)(t,"product.id"),skuId:(0,c.getProp)(t,"product.skuCode"),quantity:t.quantity||1,price:(0,c.getProp)(t,"product.unitSalePrice")},n.getProductCustoms(t.product)))}));var s=this.getCustomerData(t),u=this.getOption("orderVars"),d=(0,b.extractVariableMappingValues)(t,u);s.order=Object.assign({webSiteId:i,price:(0,c.getProp)(t,"transaction.total"),deliveryType:(0,c.getProp)(t,"transaction.shippingMethod"),paymentType:(0,c.getProp)(t,"transaction.paymentMethod"),items:a},d),window.mindbox("identify",(0,p.default)({operation:e,identificator:r,data:s}))}}},e.prototype.onPushSubscriptionTriggerEvent=function(){var t=this;if(this.isWebpush()){window.mindbox("webpush.subscribe",{getSubscriptionOperation:"GetWebPushSubscription",subscribeOperation:"SubscribeToWebpush",onGranted:function(){t.digitalData.events.push({category:"Push Notifications",name:_.ALLOWED_PUSH_NOTIFICATIONS})},onDenied:function(){t.digitalData.events.push({category:"Push Notifications",name:_.BLOCKED_PUSH_NOTIFICATIONS,nonInteraction:!0})}})}},e.prototype.onCustomEvent=function(t,e){var n=void 0,r=void 0;t.user&&(n=this.getIdentificator(t),r=this.getCustomerData(t)),this.getOption("apiVersion")===P?window.mindbox("async",(0,p.default)({operation:e,data:r})):window.mindbox("performOperation",(0,p.default)({operation:e,identificator:n,data:r}))},e}(w.default);n.default=O},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/isEmpty":20,"@segmentstream/utils/semver":35}],190:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/getQueryParam"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("@segmentstream/utils/normalizeString"),p=r(l),f=t("../Integration"),g=r(f),m=t("../events/semanticEvents"),h=t("./utils/affiliate"),y="mixmarket",v="mixmarket",E=function(t){function e(n,r){i(this,e);var a=Object.assign({advertiserId:"",cookieName:y,cookieTracking:!0,cookieDomain:"",cookieTtl:90,deduplication:!1,utmSource:v,deduplicationUtmMedium:[]},r),s=o(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag("trackingPixel",{type:"img",attr:{src:"//mixmarket.biz/uni/tev.php?id="+r.advertiserId+"&r="+escape(window.document.referrer)+"&t="+Date.now()+"&a1={{ orderId }}&a2={{ total }}"}}),s}return a(e,t),e.prototype.initialize=function(){if(this._isLoaded=!0,this.getOption("cookieTracking")){var t=(0,p.default)(this.getOption("utmSource"));if((0,u.default)("utm_source")===t){var e=this.getOption("cookieName"),n=this.getOption("cookieTtl"),r=this.getOption("cookieDomain");(0,h.addAffiliateCookie)(e,1,n,r)}}},e.prototype.getSemanticEvents=function(){return[m.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){var e=[];return t.name===m.COMPLETED_TRANSACTION&&(e=["transaction","context.campaign"]),e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[m.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","context.campaign.medium"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){if(t.name===m.COMPLETED_TRANSACTION){if(!(0,h.getAffiliateCookie)(this.getOption("cookieName")))return;var e=(0,d.getProp)(t,"context.campaign"),n=this.getOption("utmSource"),r=this.getOption("deduplicationUtmMedium");if((0,h.isDeduplication)(e,n,r))return;this.trackSale(t)}},e.prototype.trackSale=function(t){var e=t.transaction;if(e&&e.orderId&&e.total){var n=e.orderId,r=e.total;this.load("trackingPixel",{orderId:n,total:r})}},e}(g.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/normalizeString":30}],191:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("@segmentstream/utils/dotProp"),c=t("../Integration"),u=function(t){return t&&t.__esModule?t:{default:t}}(c),d=t("../events/semanticEvents"),l=[d.VIEWED_PRODUCT_DETAIL,d.COMPLETED_TRANSACTION],p=function(t){function e(n,o){r(this,e);var a=Object.assign({shopId:"",afsecure:"",rbProductPixelId:"",rbConversionPixelId:"",utmSource:"multilead"},o),s=i(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag("productMailRuPixel",{type:"img",attr:{src:"https://ad.mail.ru/"+o.rbProductPixelId+".gif?shop="+o.shopId+"&offer={{ productId }}&rnd="+Date.now()}}),s.addTag("conversionMailRuPixel",{type:"img",attr:{src:"https://rs.mail.ru/"+o.rbConversionPixelId+".gif?rnd="+Date.now()}}),s.addTag("conversionPixel",{type:"img",attr:{src:"https://track.multilead.ru/success.php?afid={{ orderId }}&afprice={{ total }}&afcurrency={{ currency }}&afsecure="+o.afsecure}}),s}return o(e,t),e.prototype.getSemanticEvents=function(){return l},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case d.VIEWED_PRODUCT_DETAIL:return["product.id"];case d.COMPLETED_TRANSACTION:return["context.campaign","transaction"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[d.VIEWED_PRODUCT_DETAIL]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[d.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","transaction.currency","context.campaign.source"],validation:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e,n=(e={},e[d.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[d.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedProductDetail=function(t){var e=t.product;e&&e.id&&this.load("productMailRuPixel",{productId:e.id})},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=(0,s.getProp)(t,"context.campaign")||{};if(e.orderId&&n.source===this.getOption("utmSource")){var r=e.orderId,i=e.total,o=e.currency||"RUB";this.load("conversionMailRuPixel"),this.load("conversionPixel",{orderId:r,total:i,currency:o})}},e}(u.default);n.default=p},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7}],192:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){return t.filter(function(t){return!!t.product.id}).map(function(t){return!0!==e?t.product.id:t.product.skuCode})}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/getVarValue"),p=r(l),f=t("@segmentstream/utils/dotProp"),g=t("@segmentstream/utils/cleanObject"),m=r(g),h=t("../Integration"),y=r(h),v=t("../variableTypes"),E=t("../events/semanticEvents"),w=function(t){function e(n,r){i(this,e);var a=(0,f.getProp)(r,"counters");a&&(r.counters=a.map(function(t){return Object.assign({counterId:"",listVar:{type:v.CONSTANT_VAR,value:"1"},feedWithGroupedProducts:!1},t)}));var s=Object.assign({counters:[],noConflict:!1,goals:{}},r),c=o(this,t.call(this,n,s));return c.SEMANTIC_EVENTS=[E.VIEWED_PAGE,E.VIEWED_PRODUCT_DETAIL,E.VIEWED_PRODUCT_LISTING,E.ADDED_PRODUCT,E.VIEWED_CART,E.COMPLETED_TRANSACTION],c.addGoalsToSemanticEvents(),c.addTag({type:"script",attr:{id:"topmailru-code",src:"//top-fwz1.mail.ru/js/code.js"}}),c}return a(e,t),e.prototype.getCounters=function(){return this.getOption("counters")},e.prototype.getDigitalDataListVarValues=function(){return this.getCounters().map(function(t){return t.listVar}).filter(function(t){return t&&t.type===v.DIGITALDATA_VAR}).map(function(t){return t.value}).filter(function(t,e,n){return n.indexOf(t)===e})},e.prototype.initialize=function(){window._tmr=window._tmr||[]},e.prototype.allowNoConflictInitialization=function(){return!0},e.prototype.addGoalsToSemanticEvents=function(){var t=this;Object.keys(this.getOption("goals")).forEach(function(e){t.SEMANTIC_EVENTS.indexOf(e)<0&&t.SEMANTIC_EVENTS.push(e)})},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case E.VIEWED_PAGE:e=["page.type"];break;case E.VIEWED_PRODUCT_DETAIL:case E.ADDED_PRODUCT:e=["product"];break;case E.VIEWED_CART:e=["cart"];break;case E.COMPLETED_TRANSACTION:e=["transaction"]}return this.getDigitalDataListVarValues().forEach(function(t){return e.push(t)}),e},e.prototype.getEventValidationConfig=function(t){var e,n=(e={},e[E.VIEWED_PAGE]={fields:["page.type"],validations:{"page.type":{errors:["required","string"]}}},e[E.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.unitSalePrice"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.unitSalePrice":{warings:["required","numeric"]}}},e[E.VIEWED_CART]={fields:["cart.total","cart.lineItems[].product.id"],validations:{"cart.total":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[E.COMPLETED_TRANSACTION]={fields:["transaction.total","transaction.lineItems[].product.id"],validations:{"transaction.total":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e),r=n[t.name];return r&&this.getDigitalDataListVarValues().forEach(function(t){r.fields.push("listVar.value"),r.validations[t]={errors:["required"],warnings:["numeric"]}}),r},e.prototype.isLoaded=function(){return!(!window._tmr||!window._tmr.unload)},e.prototype.reset=function(){(0,d.default)(window,"_tmr")},e.prototype.getList=function(t,e){var n=(0,f.getProp)(e,"listVar");if(n)return(0,p.default)(n,t)},e.prototype.trackEvent=function(t){var e,n=(e={},e[E.VIEWED_PAGE]="onViewedPage",e[E.VIEWED_PRODUCT_LISTING]="onViewedProductCategory",e[E.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[E.ADDED_PRODUCT]="onAddedProduct",e[E.VIEWED_CART]="onViewedCart",e[E.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];this.getCounters().length>0&&(r&&!this.getOption("noConflict")&&this[r](t),this.trackCustomEvent(t))},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1,this.getCounters().forEach(function(t){window._tmr.push({id:t.counterId,type:"pageView",start:Date.now()})}),"home"===(t.page||{}).type&&this.onViewedHome(t),this.pageTracked||setTimeout(function(){e.pageTracked||e.onViewedOtherPage(t)},100)},e.prototype.onViewedHome=function(t){var e=this;this.getCounters().forEach(function(n){window._tmr.push({id:n.counterId,type:"itemView",productid:"",pagetype:"home",totalvalue:"",list:e.getList(t,n)})}),this.pageTracked=!0},e.prototype.onViewedProductCategory=function(t){var e=this;this.getCounters().forEach(function(n){window._tmr.push({id:n.counterId,type:"itemView",productid:"",pagetype:"category",totalvalue:"",list:e.getList(t,n)})}),this.pageTracked=!0},e.prototype.onViewedProductDetail=function(t){var e=this,n=t.product;this.getCounters().forEach(function(r){window._tmr.push({id:r.counterId,type:"itemView",productid:(!0!==r.feedWithGroupedProducts?n.id:n.skuCode)||"",pagetype:"product",totalvalue:n.unitSalePrice||"",list:e.getList(t,r)})}),this.pageTracked=!0},e.prototype.onAddedProduct=function(t){var e=this,n=t.product,r=t.quantity;this.getCounters().forEach(function(i){window._tmr.push({id:i.counterId,type:"itemView",productid:(!0!==i.feedWithGroupedProducts?n.id:n.skuCode)||"",pagetype:"cart",totalvalue:(n.unitSalePrice||n.unitPrice)*r||"",list:e.getList(t,i)})}),this.pageTracked=!0},e.prototype.onViewedCart=function(t){var e=this,n=t.cart;this.getCounters().forEach(function(r){var i=void 0;n.lineItems&&n.lineItems.length>0&&(i=s(n.lineItems,r.feedWithGroupedProducts)),window._tmr.push({id:r.counterId,type:"itemView",productid:i||"",pagetype:"cart",totalvalue:n.total||"",list:e.getList(t,r)})}),this.pageTracked=!0},e.prototype.onViewedOtherPage=function(t){var e=this;this.getCounters().forEach(function(n){window._tmr.push({id:n.counterId,type:"itemView",productid:"",pagetype:"other",totalvalue:"",list:e.getList(t,n)})}),this.pageTracked=!0},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction;this.getCounters().forEach(function(r){var i=void 0;n.lineItems&&n.lineItems.length>0&&(i=s(n.lineItems,r.feedWithGroupedProducts)),window._tmr.push({id:r.counterId,type:"itemView",productid:i||"",pagetype:"purchase",totalvalue:n.total||n.subtotal||"",list:e.getList(t,r)})}),this.pageTracked=!0},e.prototype.trackCustomEvent=function(t){var e=this.getOption("goals"),n=e[t.name];n&&this.getCounters().forEach(function(e){window._tmr.push((0,m.default)({id:e.counterId,type:"reachGoal",goal:n,value:t.value?Math.round(t.value):void 0}))})},e}(y.default);n.default=w},{"../Integration":143,"../events/semanticEvents":158,"../variableTypes":231,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getVarValue":14}],193:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("@segmentstream/utils/safeConsole"),c=t("../Integration"),u=function(t){return t&&t.__esModule?t:{default:t}}(c),d=function(t){function e(n,o){r(this,e);var a=Object.assign({namespace:void 0,sessionStreaming:!1,sessionIdDimension:void 0},o);return i(this,t.call(this,n,a))}return o(e,t),e.prototype.initialize=function(t){return this.initVersion=t,window.ga?(this.initVersion||this.getOption("namespace")||!1===this.getOption("namespace")||this.setOption("namespace","ddl"),this.getOption("sessionStreaming")?this.ga("require","OWOXBIStreaming",{sessionIdDimension:this.getOption("sessionIdDimension")}):this.ga("require","OWOXBIStreaming"),this.getOption("sessionStreaming")?function(){function t(t,e){var n=t.get("sendHitTask"),r=function(){function n(t,e){var n="XDomainRequest"in window?"XDomainRequest":"XMLHttpRequest",r=new window[n];r.open("POST",t,!0),r.onprogress=function(){},r.ontimeout=function(){},r.onerror=function(){},r.onload=function(){},r.setRequestHeader&&r.setRequestHeader("Content-Type","text/plain"),"XDomainRequest"==n?setTimeout(function(){r.send(e)},0):r.send(e)}function r(t,e){var n=new Image;n.onload=function(){},n.src=t+"?"+e}var i=e&&e.domain?e.domain:"stream.datago.ru/mp";return{send:function(e){var o,a=location.protocol+"//"+i+"/collect";try{navigator.sendBeacon&&navigator.sendBeacon(o=a+"?tid="+t.get("trackingId"),e)||(2036<e.length?n(o||a+"?tid="+t.get("trackingId"),e):r(a,e))}catch(t){}}}}();t.set("sendHitTask",function(t){if(e&&0<e.sessionIdDimension)try{t.set("dimension"+e.sessionIdDimension,t.get("clientId")+"_"+Date.now()),t.get("buildHitTask")(t)}catch(t){}n(t),r.send(t.get("hitPayload"))})}var e=window[window.GoogleAnalyticsObject||"ga"];"function"==typeof e&&e("provide","OWOXBIStreaming",t)}():function(){function t(t){var e=t.get("sendHitTask"),n=function(){function e(t){var e=!1;try{document.createElement("img").src=n(!0)+"?"+t,e=!0}catch(t){}return e}function n(e){var n="https://stream.datago.ru/mp"+encodeURIComponent(t.get("trackingId"));return e||(n+="?tid="+encodeURIComponent(t.get("trackingId"))),n}return{send:function(t){var r;if(!(r=2036>=t.length&&e(t))){r=!1;try{r=navigator.sendBeacon&&navigator.sendBeacon(n(),t)}catch(t){}}if(!r){r=!1;var i;try{window.XMLHttpRequest&&"withCredentials"in(i=new XMLHttpRequest)&&(i.open("POST",n(),!0),i.setRequestHeader("Content-Type","text/plain"),i.send(t),r=!0)}catch(t){}}return r||e(t)}}}();t.set("sendHitTask",function(t){try{e(t)}catch(t){}n.send(t.get("hitPayload"))})}var e=window[window.GoogleAnalyticsObject||"ga"];e&&e("provide","OWOXBIStreaming",t)}(),this._loaded=!0,!0):((0,s.warn)("Google Analytics integration should be initialized before OWOX BI Streaming integration"),!1)},e.prototype.isLoaded=function(){return!!this._loaded},e.prototype.reset=function(){},e.prototype.ga=function(){if(this.getOption("namespace")){var t;arguments[0]&&(arguments[0]=this.getOption("namespace")+"."+arguments[0]),(t=window).ga.apply(t,arguments)}else{var e;(e=window).ga.apply(e,arguments)}},e}(u.default);n.default=d},{"../Integration":143,"@segmentstream/utils/safeConsole":33}],194:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/cleanObject"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("../Integration"),g=r(f),m=t("./utils/AsyncQueue"),h=r(m),y=t("../events/semanticEvents"),v=[y.VIEWED_PAGE,y.VIEWED_PRODUCT_DETAIL,y.ADDED_PRODUCT,y.REMOVED_PRODUCT,y.COMPLETED_TRANSACTION],E=function(t){function e(n,r){i(this,e);var a=Object.assign({accountKey:""},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"https://t.ofsys.com/js/Journey/1/"+r.accountKey+"/DI.Journey-min.js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return v},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case y.VIEWED_PAGE:e=["user.email","cart"];break;case y.VIEWED_PRODUCT_DETAIL:e=["product.id"];break;case y.COMPLETED_TRANSACTION:e=["transaction"]}return e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[y.VIEWED_PAGE]={fields:["user.email","cart.id","cart.total","cart.checkoutStep","cart.lineItems[].product.id","cart.lineItems[].product.unitSalePrice","cart.lineItems[].product.name","cart.lineItems[].quantity"]},e[y.VIEWED_PRODUCT_DETAIL]={fields:["product.id"]},e[y.ADDED_PRODUCT]={fields:["product.id","product.name","product.unitSalePrice","quantity"]},e[y.REMOVED_PRODUCT]={fields:["product.id"]},e[y.COMPLETED_TRANSACTION]={fields:["transaction.total","transaction.lineItems[].product.id","transaction.orderId","transaction.cartId","transaction.shippingCost","transaction.affiliation","transaction.tax","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].subtotal","transaction.lineItems[].quantity"]},e)[t.name]},e.prototype.initialize=function(){this.asyncQueue=new h.default(this.isLoaded)},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.flushQueue=function(){for(var t=this.asyncQueue.shift();t&&"function"==typeof t;)t(),t=this.asyncQueue.shift();this.asyncQueue.push=function(t){t()}},e.prototype.isLoaded=function(){return!(!window.DI||!window.DI.Journey)},e.prototype.reset=function(){(0,u.default)(window,"OFSYS_Tracking_onload"),(0,u.default)(window,"DI")},e.prototype.createCart=function(t){t=t||{},t.id&&(t.total=t.total||0,this.cartId=t.id,this.cart=t,this.asyncQueue.push(function(){window.DI.Journey.ECommerce.AddCart((0,l.default)({idCart:t.id,status:t.checkoutStep,TotalPrice:t.total}))}),t.lineItems&&t.lineItems.length&&this.asyncQueue.push(function(){t.lineItems.forEach(function(e){window.DI.Journey.ECommerce.AddCartItem({idCart:t.id,idProduct:(0,p.getProp)(e,"product.id"),productName:(0,p.getProp)(e,"product.name"),priceunit:(0,p.getProp)(e,"product.unitSalePrice")||(0,p.getProp)(e,"product.unitPrice"),quantity:e.quantity||1})})}))},e.prototype.getCartItemNewQuantity=function(t,e){var n=this.cart;return n&&n.lineItems&&n.lineItems.length?n.lineItems.reduce(function(e,n){var r=n.product;return r&&String(r.id)===String(t)&&(e+=n.quantity||1),e},0):e},e.prototype.getNewCartTotal=function(t,e){var n=t*e;return this.cart.total+n},e.prototype.trackEvent=function(t){var e,n=(e={},e[y.VIEWED_PAGE]="onViewedPage",e[y.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[y.ADDED_PRODUCT]="onAddedProduct",e[y.REMOVED_PRODUCT]="onRemovedProduct",e[y.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=(0,p.getProp)(t,"user.email");e&&this.asyncQueue.push(function(){window.DI.Journey.Set("f_EMail",e),window.DI.Journey.Track()}),this.createCart(t.cart)},e.prototype.onViewedProductDetail=function(t){var e=t.product;e&&e.id&&this.asyncQueue.push(function(){window.DI.Journey.ECommerce.ProductView(e.id)})},e.prototype.onAddedProduct=function(t){var e=this,n=t.product;if(n&&n.id&&this.cartId){var r=this.getNewCartTotal(n.unitSalePrice,t.quantity||1);this.asyncQueue.push(function(){window.DI.Journey.ECommerce.AddCartItem({idCart:e.cartId,idProduct:n.id,productName:n.name,priceunit:n.unitSalePrice,quantity:e.getCartItemNewQuantity(n.id,t.quantity)}),window.DI.Journey.ECommerce.UpdateCart({idCart:e.cartId,TotalPrice:r}),window.DI.Journey.ECommerce.SubmitCart()})}},e.prototype.onRemovedProduct=function(t){var e=this,n=t.product;if(n&&n.id&&this.cartId){var r=this.getNewCartTotal(n.unitSalePrice,-t.quantity||-1);this.asyncQueue.push(function(){window.DI.Journey.ECommerce.RemoveCartItem({idCart:e.cartId,idProduct:n.id}),window.DI.Journey.ECommerce.UpdateCart({idCart:e.cartId,TotalPrice:r}),window.DI.Journey.ECommerce.SubmitCart()})}},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction;n&&n.orderId&&(this.asyncQueue.push(function(){window.DI.Journey.ECommerce.AddTransaction((0,l.default)({idTransaction:n.orderId,idCart:n.cartId||e.cartId,affiliation:n.affiliation,revenue:n.total,tax:n.tax,shipping:n.shippingCost}))}),n.lineItems&&Array.isArray(n.lineItems)&&this.asyncQueue.push(function(){n.lineItems.forEach(function(t){var r=(0,p.getProp)(t,"product.unitSalePrice")||(0,p.getProp)(t,"product.unitPrice"),i=t.quantity||1;window.DI.Journey.ECommerce.AddItem({idTransaction:n.orderId,idCart:n.cartId||e.cartId,idProduct:(0,p.getProp)(t,"product.id"),productName:(0,p.getProp)(t,"product.name"),Price_unit:r,Price_total:t.subtotal||r*i,quantity:i})})}),this.asyncQueue.push(function(){window.DI.Journey.ECommerce.SubmitTransaction()}))},e}(g.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],195:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("js-cookie"),d=r(u),l=t("@segmentstream/utils/topDomain"),p=r(l),f=t("../events/semanticEvents"),g=t("../Integration"),m=r(g),h="cookieSync",y="superSync",v=(0,p.default)(window.location),E=function(t){function e(n,r){i(this,e);var a=Object.assign({clientId:"",brandId:"",anonymousIdVar:"",superSync:!1,profileEnrichment:!1,token:"",attributesMapping:{}},r),s=o(this,t.call(this,n,a));return s.addTag(h,{type:"img",attr:{src:"https://sync.1dmp.io/pixel.gif?cid="+r.clientId+"&brid="+r.brandId+"&pid=w&uid={{ anonymousId }}"}}),s.addTag(y,{type:"iframe",attr:{src:"//sync.1dmp.io/supersync?cid="+r.clientId+"&brid="+r.brandId+"&pid=w&uid={{ anonymousId }}"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return[f.VIEWED_PAGE]},e.prototype.getEnrichableEventProps=function(t){if(t.name===f.VIEWED_PAGE){var e=this.getOption("anonymousIdVar");if(e)return[e]}return[]},e.prototype.getEventValidationConfig=function(t){if(t.name===f.VIEWED_PAGE){var e=this.getOption("anonymousIdVar");if(e){var n;return{fields:[e],validations:(n={},n[e]={errors:["required"]},n)}}}},e.prototype.initialize=function(){this._isLoaded=!0;var t=this.getOption("token"),e=d.default.get("_1dmc_e");this.getOption("profileEnrichment")&&t&&!e&&this.enrichDigitalData(t)},e.prototype.getProfile=function(t,e){var n=new window.XMLHttpRequest;n.open("GET","https://profiles.1dmp.io/v1/profiles?token="+t,!0),n.withCredentials=!0,n.send(),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t=JSON.parse(n.responseText);t&&t.attributes&&Array.isArray(t.attributes)&&e(t),d.default.set("_1dmc_e",1,{expires:7,domain:v})}else d.default.set("_1dmc_e",1,{expires:1,domain:v})}},e.prototype.enrichDigitalData=function(t){var e=this;this.getProfile(t,function(t){var n=t.attributes,r=e.getOption("attributesMapping");n.forEach(function(t){var n=t.primary;if(n){var i=r[n];i&&(t.secondary&&(i=[i,t.secondary].join(".")),(0,c.setProp)(e.digitalData,i,t.value),e.ddManager.persist(i,604800)),t.secondary&&(n=[n,t.secondary].join("."),(i=r[n])&&((0,c.setProp)(e.digitalData,i,t.value),e.ddManager.persist(i,604800)))}})})},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){t.name===f.VIEWED_PAGE&&this.onViewedPage(t)},e.prototype.onViewedPage=function(t){if(!d.default.get("_1dmc_s")){var e=this.getOption("anonymousIdVar");if(e){var n=(0,c.getProp)(t,e);if(n){var r=h;this.getOption("superSync")&&(r=y),this.load(r,{anonymousId:n},function(){d.default.set("_1dmc_s",1,{expires:90,domain:v})})}}}},e}(m.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/topDomain":37,"js-cookie":102}],196:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return window.location.href.indexOf("https:")>=0}function c(){function t(){return document.querySelector(".onesignal-bell-launcher-dialog-body")}function e(){return document.querySelector("#onesignal-bell-container .onesignal-bell-launcher #subscribe-button")}function n(){return document.querySelector("#onesignal-bell-container .onesignal-bell-launcher #unsubscribe-button")}function r(){window.OneSignal.event.trigger("notifyButtonSubscribeClick")}function i(){window.OneSignal.event.trigger("notifyButtonUnsubscribeClick")}function o(){e()&&(e().removeEventListener("click",r),e().addEventListener("click",r)),n()&&(n().removeEventListener("click",i),n().addEventListener("click",i))}function a(){t()&&t().addEventListener("DOMSubtreeModified",o)}window.OneSignal=window.OneSignal||[],window.OneSignal.push(function(){window.OneSignal.once("notifyButtonLauncherClick",function(){a()})})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("@segmentstream/utils/each"),g=r(f),m=t("../Integration"),h=r(m),y=t("../events/semanticEvents"),v=t("../variableTypes"),E=function(t){function e(n,r){i(this,e);var a=Object.assign({appId:"",autoRegister:!1,subdomainName:void 0,path:"/",safariWebId:void 0,pushSubscriptionTriggerEvent:"Agreed to Receive Push Notifications",tagVars:{},welcomeNotification:{disable:!0}},r),s=o(this,t.call(this,n,a));return s.userTags={},s.enrichableTagProps=[],s.SEMANTIC_EVENTS=[y.VIEWED_PAGE,y.SUBSCRIBED,s.getOption("pushSubscriptionTriggerEvent")],s.addTag("manifest",{type:"link",attr:{rel:"manifest",href:a.path.replace(/\/$/,"")+"/manifest.json"}}),s.addTag({type:"script",attr:{src:"https://cdn.onesignal.com/sdks/OneSignalSDK.js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return this.initialized?this.SEMANTIC_EVENTS:[]},e.prototype.allowCustomEvents=function(){return!1},e.prototype.getEnrichableEventProps=function(t){var e=["user.email"];if(this.SEMANTIC_EVENTS.indexOf(t.name)>=0){this.getEnrichableTagProps().forEach(function(t){e.push(t)})}return e},e.prototype.getEnrichableTagProps=function(){return this.enrichableTagProps},e.prototype.prepareEnrichableTagProps=function(){var t=this,e=this.getOption("tagVars");(0,g.default)(e,function(e,n){n.type===v.DIGITALDATA_VAR&&t.enrichableTagProps.push(n.value)})},e.prototype.initialize=function(){var t=this;if(window.OneSignal=window.OneSignal||[],this.getOption("notifyButton")&&this.getOption("notifyButton").displayPredicate)try{this.getOption("notifyButton").displayPredicate=Function(this.getOption("notifyButton").displayPredicate)}catch(t){(0,l.default)(this.getOption("notifyButton"),"displayPredicate")}this.getOption("notifyButton")&&this.getOption("notifyButton").enable&&c(),this.getOption("path")&&"/"!==this.getOption("path")&&window.OneSignal.push(function(){window.OneSignal.SERVICE_WORKER_PARAM={scope:"/"}}),window.OneSignal.push(["init",{appId:this.getOption("appId"),autoRegister:!this.getOption("isSlidePrompt")&&this.getOption("autoRegister"),subdomainName:this.getOption("subdomainName"),path:this.getOption("path"),safari_web_id:this.getOption("safariWebId"),promptOptions:this.getOption("promptOptions"),notifyButton:this.getOption("notifyButton"),welcomeNotification:this.getOption("welcomeNotification")}]),window.OneSignal.push(["getRegistrationId",function(e){e?window.OneSignal.push(["getTags",function(e){t.currentTags=e,t.emit("getTags")}]):(t.currentTags={},t.emit("getTags"))}]),window.OneSignal.push(function(){window.OneSignal.on("notificationPermissionChange",function(e){var n=e.to,r=void 0;r="granted"===n?y.ALLOWED_PUSH_NOTIFICATIONS:"denied"===n?y.BLOCKED_PUSH_NOTIFICATIONS:y.CLOSED_PUSH_NOTIFICATIONS_PROMPT,t.digitalData.events.push({category:"Push Notifications",name:r})})}),this.enrichDigitalData(),this.prepareEnrichableTagProps(),this.load("manifest"),this.initialized=!0},e.prototype.onGetTags=function(t){var e=this;this.currentTags?t(this.currentTags):this.on("getTags",function(){t(e.currentTags)})},e.prototype.extractTagValuesFromEvent=function(t){var e=this.getOption("tagVars"),n={};return(0,g.default)(e,function(e,r){var i=(0,p.getProp)(t,r.value);void 0!==i&&("boolean"==typeof i&&(i=i.toString()),n[e]=i)}),n},e.prototype.getTagsToDelete=function(t){var e=Object.keys(this.getOption("tagVars")),n=Object.keys(t),r=n.filter(function(t){return e.indexOf(t)<0});return r.length?r:null},e.prototype.getTagsToSend=function(t,e){var n=Object.keys(t),r={},i=0;return n.forEach(function(n){String(t[n])!==String(e[n])&&(r[n]=t[n],i+=1)}),i>0?r:null},e.prototype.isHttps=function(){return s()},e.prototype.isLoaded=function(){return window.OneSignal&&!Array.isArray(window.OneSignal)},e.prototype.reset=function(){(0,l.default)(window,"OneSignal")},e.prototype.enrichDigitalData=function(){var t=this;window.OneSignal.push(function(){var e=t.digitalData.user.pushNotifications={},n=window.OneSignal.isPushNotificationsSupported();e.isSupported=n,n?window.OneSignal.push(["getNotificationPermission",function(n){switch(n){case"granted":e.isSubscribed=!0,window.OneSignal.push(["getUserId",function(n){e.userId=n,t.onEnrich()}]);break;case"denied":e.isSubscribed=!1,e.isDenied=!0,t.onEnrich();break;default:e.isSubscribed=!1,t.onEnrich()}}]):t.onEnrich()})},e.prototype.sendTagsUpdate=function(t){var e=this;this.onGetTags(function(n){var r=e.extractTagValuesFromEvent(t),i=e.getTagsToDelete(n),o=e.getTagsToSend(r,n);window.OneSignal.push(function(){o&&(window.OneSignal.sendTags(o),Object.assign(e.currentTags,o)),i&&(window.OneSignal.deleteTags(i),i.forEach(function(t){(0,l.default)(e.currentTags,t)}))})})},e.prototype.trackEvent=function(t){this.getOption("autoRegister")&&t.name===y.VIEWED_PAGE&&this.getOption("isSlidePrompt")?window.OneSignal.push(["showHttpPrompt"]):t.name===this.getOption("pushSubscriptionTriggerEvent")?(this.getOption("isSlidePrompt")?window.OneSignal.push(["showHttpPrompt"]):window.OneSignal.push(["registerForPushNotifications"]),this.sendTagsUpdate(t)):this.SEMANTIC_EVENTS.indexOf(t.name)>=0&&this.sendTagsUpdate(t)},e}(h.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"../variableTypes":231,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8}],197:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("js-cookie"),u=r(c),d=t("../Integration"),l=r(d),p=function(t){function e(n,r){i(this,e);var a=Object.assign({domain:void 0,platformCode:void 0},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"https://"+r.domain+".push.world/embed.js"}}),s}return a(e,t),e.prototype.initialize=function(){var t=this;window.pw={websiteId:this.getOption("platformCode"),date:Date.now()},this.enrichDigitalData(),document.addEventListener("pw:subscribe:allow",function(e){t.digitalData.changes.push(["user.pushNotifications.isSubscribed",!0]),t.digitalData.changes.push(["user.pushNotifications.userId",e.detail.device_id])},!1),document.addEventListener("pw:subscribe:deny",function(){t.digitalData.changes.push(["user.pushNotifications.isDenied",!0])},!1)},e.prototype.enrichDigitalData=function(){var t=u.default.get("pw_status_"+this.getOption("platformCode")),e=!1;switch(t){case"allow":e=!0,this.digitalData.changes.push(["user.pushNotifications.userId",u.default.get("pw_deviceid")]);break;case"deny":this.digitalData.changes.push(["user.pushNotifications.isDenied",!0])}this.digitalData.changes.push(["user.pushNotifications.isSubscribed",e])},e}(l.default);n.default=p},{"../Integration":143,"js-cookie":102}],198:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/cleanObject"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("../IntegrationUtils"),p=t("../Integration"),f=r(p),g=t("../events/semanticEvents"),m=[g.VIEWED_PAGE,g.VIEWED_PRODUCT_DETAIL,g.VIEWED_PRODUCT_LISTING,g.ADDED_PRODUCT,g.REMOVED_PRODUCT,g.COMPLETED_TRANSACTION,g.SEARCHED_PRODUCTS],h=function(t){function e(n,r){i(this,e);var a=Object.assign({storeKey:"",feedWithGroupedProducts:!1,productVariables:{}},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"https://cdn.rees46.com/v3.js"}}),s}return a(e,t),e.prototype.initialize=function(){window.r46=window.r46||function(){(window.r46.q=window.r46.q||[]).push(arguments)},window.r46("init",this.getOption("storeKey"))},e.prototype.getSemanticEvents=function(){return m},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case g.VIEWED_PAGE:return["user","website"];case g.VIEWED_PRODUCT_LISTING:return["listing.categoryId"];case g.SEARCHED_PRODUCTS:return["listing.query"];case g.COMPLETED_TRANSACTION:return["transaction"];case g.VIEWED_PRODUCT_DETAIL:return[].concat((0,l.getEnrichableVariableMappingProps)(this.getOption("productVariables")),["product"]);default:return[]}},e.prototype.getProductVariables=function(t){var e=t.product,n=this.getOption("productVariables");return(0,l.extractVariableMappingValues)({event:t,product:e},n,{multipleScopes:!0})},e.prototype.trackEvent=function(t){var e,n=(e={},e[g.VIEWED_PAGE]=this.onViewedPage.bind(this),e[g.VIEWED_PRODUCT_DETAIL]=this.onViewedProductDetail.bind(this),e[g.VIEWED_PRODUCT_LISTING]=this.onViewedProductListing.bind(this),e[g.SEARCHED_PRODUCTS]=this.onSearchedProducts.bind(this),e[g.ADDED_PRODUCT]=this.onAddedProduct.bind(this),e[g.REMOVED_PRODUCT]=this.onRemovedProduct.bind(this),e[g.COMPLETED_TRANSACTION]=this.onCompletedTransaction.bind(this),e);n[t.name]&&n[t.name](t)},e.prototype.onViewedPage=function(t){var e=t.user||{},n=(0,d.getProp)(t,"website.regionId"),r=String(e.gender).toLowerCase(),i=(0,u.default)({id:e.userId,email:e.email,gender:["m","f"].indexOf(r)>=0?r:void 0,birthday:e.birthDate,location:n});Object.keys(i).length>0&&window.r46("profile","set",i)},e.prototype.onViewedProductDetail=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts"),r=n?e.skuCode:e.id;if(r){var i=this.getProductVariables(t),o=e.stock;void 0!==o&&(i.stock=o>0),Object.keys(i).length>0?window.r46("track","view",Object.assign({id:r},i)):window.r46("track","view",r)}},e.prototype.onAddedProduct=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts"),r=n?e.skuCode:e.id;r&&window.r46("track","cart",{id:r,amount:t.quantity||1})},e.prototype.onRemovedProduct=function(t){var e=t.product||{},n=this.getOption("feedWithGroupedProducts"),r=n?e.skuCode:e.id;r&&window.r46("track","remove_from_cart",r)},e.prototype.onViewedProductListing=function(t){var e=t.listing||{},n=e.categoryId;n&&window.r46("track","category",n)},e.prototype.onSearchedProducts=function(t){var e=t.listing||{},n=e.query;n&&window.r46("track","search",n)},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[],r=this.getOption("feedWithGroupedProducts");n.length&&window.r46("track","purchase",{products:n.map(function(t){return{id:r?(0,d.getProp)(t,"product.skuCode"):(0,d.getProp)(t,"product.id"),price:(0,d.getProp)(t,"product.unitSalePrice"),amount:t.quantity||1}}),order:e.orderId,order_price:e.total})},e}(f.default);n.default=h},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/dotProp":7}],199:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("crypto-js/sha256"),d=r(u),l=t("../Integration"),p=r(l),f=t("../events/semanticEvents"),g=[f.VIEWED_PAGE,f.VIEWED_PRODUCT_DETAIL,f.VIEWED_PRODUCT_LISTING,f.SEARCHED_PRODUCTS,f.STARTED_ORDER,f.COMPLETED_TRANSACTION,f.VIEWED_CART,f.UPDATED_CART],m=function(t){function e(n,r){i(this,e);var a=Object.assign({accountKey:"",customDeduplication:!1,customTags:{},userSegmentVar:void 0},r),s=o(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag({type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("home",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_home{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("category2",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_category2_{{ categoryId }}{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("offer",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_offer_{{ productId }}{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("listing",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_listing_{{ productIds }}{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("basketadd",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_VB82iQFyqcxTg1HWJlJM_basketadd_{{ productId }}{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("basketstatus",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_basketstatus_{{ productIds }}{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("startorder",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_startorder{{ userSegmentParams }}{{ uidParams }}"}}),s.addTag("orderstatus2",{type:"script",attr:{src:"//creativecdn.com/tags?type=script&id=pr_"+r.accountKey+"_orderstatus2_{{ total }}_{{ orderId }}_{{ productIds }}&cd={{ deduplication }}{{ userSegmentParams }}{{ uidParams }}"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return g},e.prototype.getEnrichableEventProps=function(t){var e=void 0;switch(t.name){case f.VIEWED_PAGE:e=["page.type"];break;case f.VIEWED_PRODUCT_DETAIL:e=["product.id"];break;case f.VIEWED_PRODUCT_LISTING:e=["listing.categoryId"];break;case f.SEARCHED_PRODUCTS:e=["listing.items"];break;case f.VIEWED_CART:case f.UPDATED_CART:e=["cart"];break;case f.COMPLETED_TRANSACTION:e=["context.campaign","transaction"];break;default:e=[]}var n=this.getOption("userSegmentVar");n&&e.push(n);var r=this.getOption("customTags");return Object.keys(r).forEach(function(t){r[t].value&&"digitalData"===r[t].type&&e.push(r[t].value)}),e.push("user.email"),e},e.prototype.getEventValidationConfig=function(t){for(var e,n={},r=[],i=(0,c.getProp)(t,"listing.items.length")||0,o=0;o<Math.min(i,5);o+=1){var a=["listing.items",o,"id"].join(".");r.push(a),n[a]={errors:["required"],warnings:["string"]}}var s=(e={},e[f.VIEWED_PAGE]={fields:["page.type"],validations:{"page.type":{errors:["required","string"]}}},e[f.VIEWED_PRODUCT_DETAIL]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[f.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId"],validations:{"listing.categoryId":{errors:["required"],warnings:["string"]}}},e[f.SEARCHED_PRODUCTS]={fields:r,validations:n},e[f.VIEWED_CART]={fields:["cart.lineItems[].product.id"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[f.UPDATED_CART]={fields:["cart.lineItems[].product.id"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[f.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","transaction.lineItems[].product.id"],validation:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e),u=s[t.name],d=this.getOption("userSegmentVar");return d&&(u?(u.fields=u.fields||[],u.fields.push(d)):u={fields:[d]}),u},e.prototype.getUserSegmentParams=function(t){var e=this,n=this.getOption("userSegmentVar"),r=this.getOption("customTags");n&&(r.user=r.user||{type:"digitalData",value:n});var i=[];return Object.keys(r).forEach(function(n){var o=r[n].value,a=(0,c.getProp)(t,o);o&&void 0!==a&&i.push("&id=pr_"+e.getOption("accountKey")+"_custom_"+n+"_"+a)}),i.join("")},e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.getUidParams=function(t){var e=(0,c.getProp)(t,"user.email"),n=this.getOption("accountKey");return e?"&id=pr_"+n+"_uid_"+(0,d.default)(e):""},e.prototype.trackEvent=function(t){var e,n=(e={},e[f.VIEWED_PAGE]="onViewedPage",e[f.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[f.COMPLETED_TRANSACTION]="onCompletedTransaction",e[f.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[f.SEARCHED_PRODUCTS]="onSearchedProducts",e[f.STARTED_ORDER]="onStartedOrder",e[f.VIEWED_CART]="onViewedCart",e[f.UPDATED_CART]="onUpdatedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this,n=t.page;n&&"home"===n.type&&this.onViewedHome(t),this.pageTracked||setTimeout(function(){e.pageTracked||e.onViewedOther(t)},100)},e.prototype.onViewedCart=function(t){var e=t.cart;if(e&&e.lineItems&&e.lineItems.length){var n=e.lineItems.reduce(function(t,e,n){var r=(0,c.getProp)(e,"product.id");return n>0?[t,r].join(","):r},"");this.load("basketstatus",{productIds:n,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0}},e.prototype.onUpdatedCart=function(t){var e=t.cart;if(e&&e.lineItems&&e.lineItems.length){var n=e.lineItems.reduce(function(t,e,n){var r=(0,c.getProp)(e,"product.id");return n>0?[t,r].join(","):r},"");this.load("basketstatus",{productIds:n,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0}},e.prototype.onViewedHome=function(t){this.load("home",{userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0},e.prototype.onViewedOther=function(t){this.load({userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0},e.prototype.onViewedProductListing=function(t){var e=t.listing;e&&e.categoryId&&(this.load("category2",{categoryId:e.categoryId,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0)},e.prototype.onSearchedProducts=function(t){var e=t.listing;if(e&&e.items&&e.items.length){var n=e.items.reduce(function(t,e,n){return n>0?n<5?[t,e.id].join(","):t:e.id},"");this.load("listing",{productIds:n,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0}},e.prototype.onViewedProductDetail=function(t){var e=t.product;e&&e.id&&(this.load("offer",{productId:e.id,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0)},e.prototype.onStartedOrder=function(t){this.load("startorder",{userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0},e.prototype.onCompletedTransaction=function(t){var e=t.transaction;if(e&&e.orderId&&e.lineItems&&e.lineItems.length>0){var n=e.orderId,r=e.total,i=e.lineItems.reduce(function(t,e,n){var r=(0,c.getProp)(e,"product.id");return n>0?[t,r].join(","):r},""),o="default";if(this.getOption("customDeduplication")){o="rtbhouse"!==(0,c.getProp)(t,"context.campaign.source")}this.load("orderstatus2",{productIds:i,orderId:n,total:r,deduplication:o,userSegmentParams:this.getUserSegmentParams(t),uidParams:this.getUidParams(t)}),this.pageTracked=!0}},e}(p.default);n.default=m},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7,"crypto-js/sha256":101}],200:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("@segmentstream/utils/dotProp"),c=t("../Integration"),u=function(t){return t&&t.__esModule?t:{default:t}}(c),d=t("../events/semanticEvents"),l=[d.VIEWED_PRODUCT_DETAIL,d.VIEWED_CART,d.COMPLETED_TRANSACTION],p=function(t){function e(n,o){r(this,e);var a=Object.assign({shopId:""},o),s=i(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag("product",{type:"script",attr:{src:"//recreativ.ru/trck.php?shop="+o.shopId+"&offer={{ productId }}&rnd="+Math.floor(999*Math.random())}}),s.addTag("cart",{type:"script",attr:{src:"//recreativ.ru/trck.php?shop="+o.shopId+"&cart={{ productIds }}&rnd="+Math.floor(999*Math.random())}}),s.addTag("transaction",{type:"script",attr:{src:"//recreativ.ru/trck.php?shop="+o.shopId+"&del={{ productIds }}&rnd="+Math.floor(999*Math.random())}}),s}return o(e,t),e.prototype.getSemanticEvents=function(){return l},e.prototype.getEnrichableEventProps=function(t){var e=void 0;switch(t.name){case d.VIEWED_PRODUCT_DETAIL:e=["product.id"];break;case d.VIEWED_CART:e=["cart"];break;case d.COMPLETED_TRANSACTION:e=["transaction"];break;default:e=[]}return e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[d.VIEWED_PRODUCT_DETAIL]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[d.VIEWED_CART]={fields:["cart.lineItems[].product.id"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e[d.COMPLETED_TRANSACTION]={fields:["transaction.lineItems[].product.id"],validation:{"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]}}},e)[t.name]},e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e,n=(e={},e[d.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[d.VIEWED_CART]="onViewedCart",e[d.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedProductDetail=function(t){var e=t.product;e&&e.id&&this.load("product",{productId:e.id})},e.prototype.onViewedCart=function(t){var e=t.cart;if((0,s.getProp)(e,"lineItems.length")){var n=e.lineItems.reduce(function(t,e,n){var r=(0,s.getProp)(e,"product.id");return n>0?[t,r].join(","):r},"");this.load("cart",{productIds:n})}},e.prototype.onCompletedTransaction=function(t){var e=t.transaction;if((0,s.getProp)(e,"lineItems.length")){var n=e.lineItems.reduce(function(t,e,n){var r=(0,s.getProp)(e,"product.id");return n>0?[t,r].join(","):r},"");this.load("transaction",{productIds:n})}},e}(u.default);n.default=p},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7}],201:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/safeConsole"),u=t("../Integration"),d=function(t){return t&&t.__esModule?t:{default:t}}(u),l=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){return window.ga?(window.ga("require","RentaStreaming"),function(){var t=function(t,e){var n=t.get("sendHitTask"),r=function(){function n(t){var e,n=!1;try{window.XMLHttpRequest&&"withCredentials"in(e=new XMLHttpRequest)&&(e.open("POST",s(),!0),a.setRequestHeader("Content-Type","text/plain"),e.send(t),n=!0)}catch(t){}return n}function r(t){var e,n=!1;try{window.XDomainRequest&&(e=new XDomainRequest,e.open("POST",s(!1,location.protocol.slice(0,-1))),setTimeout(function(){e.send(t)},0),n=!0)}catch(t){}return n}function i(t){var e,n=!1;try{e=document.createElement("img"),e.src=s(!0)+"?"+t,n=!0}catch(t){}return n}function o(t){var e;try{e=navigator.sendBeacon&&navigator.sendBeacon(s(),t)}catch(t){}return e}function s(e,n){var r;return n||(n="https"),r=n+"://"+c+"/collect",e||(r+="?tid="+encodeURIComponent(t.get("trackingId"))),r}var c=e&&e.domain?e.domain:"stream.renta.im";return{send:function(t){return i(t)||o(t)||n(t)||r(t)}}}();t.set("sendHitTask",function(t){n(t),r.send(t.get("hitPayload"))})},e=window[window.GoogleAnalyticsObject||"ga"];e&&e("provide","RentaStreaming",t)}(),this._loaded=!0,!0):((0,c.warn)("Google Analytics integration should be initialized before Renta integration"),!1)},e.prototype.isLoaded=function(){return!!this._loaded},e}(d.default);n.default=l},{"../Integration":143,"@segmentstream/utils/safeConsole":33}],202:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/noop"),l=r(d),p=t("@segmentstream/utils/dotProp"),f=t("@segmentstream/utils/getVarValue"),g=r(f),m=t("@segmentstream/utils/each"),h=r(m),y=t("../Integration"),v=r(y),E=t("../IntegrationUtils"),w=t("../events/semanticEvents"),_=[w.VIEWED_PAGE,w.VIEWED_PRODUCT_DETAIL,w.VIEWED_PRODUCT_LISTING,w.CLICKED_PRODUCT,w.ADDED_PRODUCT,w.SEARCHED_PRODUCTS,w.COMPLETED_TRANSACTION,w.SUBSCRIBED],b=function(t){function e(n,r){i(this,e);var a=Object.assign({partnerId:"",userIdProperty:"user.userId",trackProducts:!0,noConflict:!1,trackAllEmails:!1,useGroupView:!1,listMethods:{},customVariables:{},productVariables:{}},r),s=o(this,t.call(this,n,a));return!1===s.getOption("trackProducts")&&s.setOption("noConflict",!0),s.addTag({type:"script",attr:{id:"rrApi-jssdk",src:"//cdn.retailrocket.ru/content/javascript/tracking.js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return _},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case w.SUBSCRIBED:e=[].concat((0,E.getEnrichableVariableMappingProps)(this.getOption("customVariables")));break;case w.VIEWED_PAGE:e=[].concat((0,E.getEnrichableVariableMappingProps)(this.getOption("customVariables")),["user.email","user.isSubscribed"]);break;case w.VIEWED_PRODUCT_DETAIL:e=[].concat((0,E.getEnrichableVariableMappingProps)(this.getOption("productVariables")),["product"]);break;case w.VIEWED_PRODUCT_LISTING:e=["listing.categoryId"];break;case w.SEARCHED_PRODUCTS:e=["listing.query"];break;case w.COMPLETED_TRANSACTION:e=["transaction"];break;case w.ADDED_PRODUCT:e=[].concat((0,E.getEnrichableVariableMappingProps)(this.getOption("productVariables")))}return e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[w.VIEWED_PAGE]={fields:["user.email","user.isSubscribed"],validations:{"user.email":{warnings:["string"]},"user.isSubscribed":{warnings:["boolean"]}}},e[w.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.skuCode","product.variations[].skuCode"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[w.ADDED_PRODUCT]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[w.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId"],validations:{"listing.categoryId":{errors:["required"],warnings:["string"]}}},e[w.SEARCHED_PRODUCTS]={fields:["listing.query"],validations:{"listing.query":{errors:["required"],warnings:["string"]}}},e[w.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.initialize=function(){window.rrPartnerId=this.getOption("partnerId");var t=(0,p.getProp)(this.digitalData,this.getOption("userIdProperty"));t&&(window.rrPartnerUserId=t),window.rrApiOnReady=window.rrApiOnReady||[],window.rrApi={},"pageView addToBasket order categoryView setEmail view groupView recomMouseDown recomAddToCart search".split(/\s+/).forEach(function(t){window.rrApi[t]=l.default})},e.prototype.isLoaded=function(){return!(!window.rrApi||"function"!=typeof window.rrApi._initialize)},e.prototype.reset=function(){(0,u.default)(window,"rrPartnerId"),(0,u.default)(window,"rrApi"),(0,u.default)(window,"rrApiOnReady"),(0,u.default)(window,"rrApi"),(0,u.default)(window,"retailrocket"),(0,u.default)(window,"retailrocket_products"),(0,u.default)(window,"rrLibrary");var t=document.getElementById("rrApi-jssdk");t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.getTransactionItems=function(t){var e=this,n={};return t.forEach(function(t){var r=t.product,i={id:e.getOption("useGroupView")?r.skuCode:r.id,qnt:t.quantity,price:r.unitSalePrice||r.unitPrice},o=n[r.id];o?o.qnt+=1:n[r.id]=i}),Object.keys(n).map(function(t){return n[t]})},e.prototype.trackEvent=function(t){!0!==this.getOption("noConflict")?t.name===w.VIEWED_PAGE?this.onViewedPage(t):t.name===w.VIEWED_PRODUCT_LISTING?this.onViewedProductCategory(t.listing):t.name===w.ADDED_PRODUCT?this.onAddedProduct(t):t.name===w.VIEWED_PRODUCT_DETAIL?this.onViewedProductDetail(t):t.name===w.CLICKED_PRODUCT?this.onClickedProduct(t.listItem):t.name===w.COMPLETED_TRANSACTION?this.onCompletedTransaction(t):t.name===w.SUBSCRIBED?this.onSubscribed(t):t.name===w.SEARCHED_PRODUCTS&&this.onSearched(t.listing):t.name===w.SUBSCRIBED&&this.onSubscribed(t)},e.prototype.onViewedPage=function(t){var e=t.user;e&&e.email&&(!0!==this.getOption("trackAllEmails")&&!0!==e.isSubscribed||this.onSubscribed(t))},e.prototype.onViewedProductCategory=function(t){var e=t||{},n=e.categoryId;n&&window.rrApiOnReady.push(function(){try{window.rrApi.categoryView(n)}catch(t){}})},e.prototype.onViewedProductDetail=function(t){var e=this,n=t.product,r=this.getProductId(n);if(r){var i=this.getProductVariables(t);window.rrApiOnReady.push(function(){try{if(e.getOption("useGroupView")){var t=n.variations||[],o=void 0;o=t.length?t.map(function(t){return t.skuCode}):[n.skuCode],window.rrApi.groupView(o,i)}else window.rrApi.view(r,i)}catch(t){}})}},e.prototype.onAddedProduct=function(t){var e=this,n=t.product,r=this.getProductId(n);if(r){var i=this.getProductVariables(t);window.rrApiOnReady.push(function(){try{e.getOption("useGroupView")?window.rrApi.addToBasket(n.skuCode,i):window.rrApi.addToBasket(r,i)}catch(t){}})}},e.prototype.onClickedProduct=function(t){var e=this;if(t){var n=this.getProductId(t.product);if(n){var r=t.listId;if(r){var i=this.getOption("listMethods")[r];i&&window.rrApiOnReady.push(function(){try{e.getOption("useGroupView")?window.rrApi.recomMouseDown(t.product.skuCode,i):window.rrApi.recomMouseDown(n,i)}catch(t){}})}}}},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction||{};if(this.validateTransaction(n)){!0===this.getOption("trackAllEmails")&&this.onSubscribed(t);var r=n.lineItems;r.every(function(t){return e.validateTransactionLineItem(t)})&&window.rrApiOnReady.push(function(){try{window.rrApi.order({transaction:n.orderId,items:e.getTransactionItems(r)})}catch(t){}})}},e.prototype.onSubscribed=function(t){var e=t.user||{};if(e.email){var n={},r=this.getOption("customVariables");(0,h.default)(r,function(e,r){var i=void 0;void 0!==(i="string"==typeof r?(0,p.getProp)(t,r):(0,g.default)(r,t))&&("boolean"==typeof i&&(i=i.toString()),n[e]=i)}),window.rrApiOnReady.push(function(){try{window.rrApi.setEmail(e.email,n)}catch(t){}})}},e.prototype.onSearched=function(t){t=t||{},t.query&&window.rrApiOnReady.push(function(){try{window.rrApi.search(t.query)}catch(t){}})},e.prototype.validateTransaction=function(t){if(!t.orderId)return!1;var e=t.lineItems;return!(!e||!Array.isArray(e)||0===e.length)},e.prototype.validateLineItem=function(t){return!!t.product},e.prototype.validateTransactionLineItem=function(t){if(!this.validateLineItem(t))return!1;var e=t.product;return!(!e.id||!e.unitSalePrice&&!e.unitPrice||!t.quantity)},e.prototype.getProductVariables=function(t){var e=t.product,n=this.getOption("productVariables");return(0,E.extractVariableMappingValues)({event:t,product:e},n,{multipleScopes:!0})},e.prototype.getProductId=function(t){return(t||{}).id},e}(v.default);n.default=b},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/each":8,"@segmentstream/utils/getVarValue":14,"@segmentstream/utils/noop":29}],203:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":c(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":c(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return(0,l.default)({id:t.id,name:t.name,imageUrl:t.imageURL,url:t.linkURL,unitSalePrice:Number(t.price.replace(/[^0-9.]/g,"")),manufacturer:t.brand})}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var u=t("@segmentstream/utils/dotProp"),d=t("@segmentstream/utils/cleanObject"),l=r(d),p=t("@segmentstream/utils/deleteProperty"),f=r(p),g=t("./utils/AsyncQueue"),m=r(g),h=t("../Integration"),y=r(h),v=t("../events/semanticEvents"),E=function(t){function e(n,r){i(this,e);var a=Object.assign({apiKey:"",useProductionUrl:!1,sessionIdVar:"",placements:[]},r),s=o(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:"//media.richrelevance.com/rrserver/js/1.2/p13n.js"}}),s}return a(e,t),e.prototype.getEnrichableEventProps=function(t){switch(t.name){case v.VIEWED_PAGE:return["page.type","user.userId","website.currency","website.regionId",this.getOption("sessionIdVar")];case v.VIEWED_PRODUCT_DETAIL:return["product"];case v.VIEWED_PRODUCT_LISTING:case v.SEARCHED_PRODUCTS:return["listing"];case v.VIEWED_CART:return["cart"];case v.COMPLETED_TRANSACTION:return["transaction"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e,n;return(n={},n[v.VIEWED_PAGE]={fields:["page.type",this.getOption("sessionIdVar")],validations:(e={"page.type":{errors:["required","string"]}},e[this.getOption("sessionIdVar")]={errors:["required"],warnings:["string"]},e)},n[v.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId","listing.category"],validations:{"listing.categoryId":{errors:["required"],warnings:["string"]},"listing.category":{errors:["array"],warnings:["required"]}}},n[v.SEARCHED_PRODUCTS]={fields:["listing.query"],validations:{"listing.query":{errors:["required","string"]}}},n[v.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.name","product.categoryId"],validation:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{errors:["required","string"]},"product.categoryId":{warnings:["required","string"]}}},n[v.ADDED_PRODUCT]={fields:["product.id","product.skuCode"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.skuCode":{warnings:["required","string"]}}},n[v.VIEWED_CART]={fields:["cart.lineItems[].product.id","cart.lineItems[].product.skuCode"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]},"cart.lineItems[].product.skuCode":{warnings:["required","string"]}}},n[v.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.skuCode","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity"],validation:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.skuCode":{warnings:["required","string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}}},n)[t.name]},e.prototype.getSemanticEvents=function(){return[v.VIEWED_PAGE,v.VIEWED_PRODUCT_DETAIL,v.ADDED_PRODUCT,v.VIEWED_PRODUCT_LISTING,v.SEARCHED_PRODUCTS,v.VIEWED_CART,v.COMPLETED_TRANSACTION]},e.prototype.initialize=function(){this.baseUrlSubdomain=this.getOption("useProductionUrl")?"recs":"integration",this.asyncQueue=new m.default(this.isLoaded),this.enrichDigitalData()},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.enrichDigitalData=function(){var t=this;this.asyncQueue.push(function(){window.RR.jsonCallback=function(){var e=(0,u.getProp)(window,"RR.data.JSON.placements");if(!e||!e.length)return void t.onEnrich();var n=t.digitalData.recommendation=t.digitalData.recommendation||[];Array.isArray(n)||(n=[n]),e.forEach(function(e){n.push({listId:e.placement_name,listName:e.message,strategy:e.strategy,items:e.items.map(s)}),t.digitalData.changes.push(["recommendation",n,t.getName()+" Integration"])}),t.onEnrich()}})},e.prototype.isLoaded=function(){return!(!window.RR||!window.rr_flush_onload)},e.prototype.getPlacements=function(t){var e=this.getOption("placements");return e?e.filter(function(e){return 0===e.indexOf(t+".")}):[]},e.prototype.addPlacements=function(t){var e=this.getPlacements(t);e.length?e.forEach(function(t){window.R3_COMMON.addPlacementType(t)}):window.R3_COMMON.addPlacementType(t)},e.prototype.rrAddListItems=function(t){if(t.items){var e=0;t.items.forEach(function(t){e>=15||t.id&&(window.R3_COMMON.addItemId(t.id),e+=1)})}},e.prototype.rrResetContext=function(){void 0!==window.R3_ITEM&&(0,f.default)(window,"R3_ITEM"),window.R3_COMMON.placementTypes&&(0,f.default)(window.R3_COMMON,"placementTypes"),window.R3_COMMON.categoryHintIds&&(0,f.default)(window.R3_COMMON,"categoryHintIds")},e.prototype.rrFlush=function(){this.rrFlushed||window.rr_flush_onload(),window.r3(),this.rrFlushed=!0},e.prototype.trackEvent=function(t){var e,n=(e={},e[v.VIEWED_PAGE]="onViewedPage",e[v.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[v.ADDED_PRODUCT]="onAddedProduct",e[v.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[v.SEARCHED_PRODUCTS]="onSearchedProducts",e[v.VIEWED_CART]="onViewedCart",e[v.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&(this.rrFlushed&&this.rrResetContext(),this[r](t))},e.prototype.onViewedPage=function(t){var e=this;this.rrFlushed=!1;var n=t.page||{},r=t.user||{},i=t.website||{},o=(0,u.getProp)(t,this.getOption("sessionIdVar"));this.asyncQueue.push(function(){window.R3_COMMON=new r3_common,window.R3_COMMON.setApiKey(e.getOption("apiKey")),window.R3_COMMON.setBaseUrl(window.location.protocol+"//"+e.baseUrlSubdomain+".richrelevance.com/rrserver/"),window.R3_COMMON.setClickthruServer(window.location.protocol+"//"+window.location.host),window.R3_COMMON.setSessionId(o),r.userId&&window.R3_COMMON.setUserId(r.userId),i.regionId&&window.R3_COMMON.setRegionId(i.regionId),i.currency&&window.R3_COMMON.setCurrency(i.currency),setTimeout(function(){e.rrFlushed||e.rrFlush()},100)}),"home"===n.type&&this.onViewedHome(t)},e.prototype.onViewedHome=function(){var t=this;this.asyncQueue.push(function(){t.addPlacements("home_page"),window.R3_HOME=new window.r3_home,t.rrFlush()})},e.prototype.onViewedGenericPage=function(){var t=this;this.asyncQueue.push(function(){t.addPlacements("generic_page"),window.R3_GENERIC=new window.r3_generic,t.rrFlush()})},e.prototype.onViewedProductDetail=function(t){var e=this,n=t.product||{};this.asyncQueue.push(function(){e.addPlacements("item_page"),n.categoryId&&window.R3_COMMON.addCategoryHintId(n.categoryId),window.R3_ITEM=new window.r3_item,window.R3_ITEM.setId(n.id),window.R3_ITEM.setName(n.name),e.rrFlush()})},e.prototype.onAddedProduct=function(t){var e=this,n=t.product||{};this.asyncQueue.push(function(){e.addPlacements("add_to_cart_page"),window.R3_ADDTOCART=new window.r3_addtocart,window.R3_ADDTOCART.addItemIdToCart(n.id,n.skuCode),e.rrFlush()})},e.prototype.onViewedProductListing=function(t){var e=this,n=t.listing||{};n.categoryId&&(n.items=n.items||[],this.asyncQueue.push(function(){if(e.addPlacements("category_page"),window.R3_CATEGORY=new r3_category,window.R3_CATEGORY.setId(n.categoryId),n.category&&n.category.length){var t=n.category[n.category.length-1];window.R3_CATEGORY.setName(t)}e.rrAddListItems(n),e.rrFlush()}))},e.prototype.onSearchedProducts=function(t){var e=this,n=t.listing||{};n.query&&this.asyncQueue.push(function(){e.addPlacements("search_page"),window.R3_SEARCH=new r3_search,window.R3_SEARCH.setTerms(n.query),e.rrAddListItems(n),e.rrFlush()})},e.prototype.onViewedCart=function(t){var e=this,n=t.cart;if(n){var r=n.lineItems||[];this.asyncQueue.push(function(){e.addPlacements("cart_page"),window.R3_CART=new window.r3_cart,r.forEach(function(t){var e=t.product||{};window.R3_CART.addItemId(e.id,e.skuCode)}),e.rrFlush()})}},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction;if(n&&n.orderId){var r=n.lineItems||[];this.asyncQueue.push(function(){e.addPlacements("purchase_complete_page"),window.R3_PURCHASED=new window.r3_purchased,window.R3_PURCHASED.setOrderNumber(n.orderId),r.forEach(function(t){var e=t.product||{},n=t.quantity||1;window.R3_PURCHASED.addItemIdPriceQuantity(e.id,e.unitSalePrice,n,e.skuCode)}),e.rrFlush()})}},e}(y.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],204:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){return t=t||[],t.map(function(t){return{qty:t.quantity,price:(0,c.getProp)(t,"product.unitSalePrice"),sku:(0,c.getProp)(t,"product.id")}})}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("../Integration"),d=function(t){return t&&t.__esModule?t:{default:t}}(u),l=t("../events/semanticEvents"),p=[l.VIEWED_PAGE,l.VIEWED_CART,l.VIEWED_PRODUCT_DETAIL,l.VIEWED_PRODUCT_LISTING,l.ADDED_PRODUCT,l.REMOVED_PRODUCT,l.VIEWED_CHECKOUT_STEP,l.COMPLETED_TRANSACTION],f=function(t){function e(n,o){r(this,e);var a=Object.assign({accountKey:""},o),s=i(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag({type:"script",attr:{src:"//cdn.rutarget.ru/static/tag/tag.js"}}),s}return o(e,t),e.prototype.getSemanticEvents=function(){return p},e.prototype.getEnrichableEventProps=function(t){switch(t.name){case l.VIEWED_PRODUCT_DETAIL:return["product.id","product.unitSalePrice"];case l.VIEWED_PRODUCT_LISTING:return["listing.categoryId","listing.category"];case l.VIEWED_CART:case l.VIEWED_CHECKOUT_STEP:return["cart"];case l.COMPLETED_TRANSACTION:return["transaction"];default:return[]}},e.prototype.getEventValidationConfig=function(t){var e,n={fields:["product.id","product.unitSalePrice"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.unitSalePrice":{errors:["required"],warnings:["numeric"]}}},r={fields:["cart.lineItems[].product.id","cart.lineItems[].product.unitSalePrice","cart.lineItems[].quantity"],validations:{"cart.lineItems[].product.id":{errors:["required"],warnings:["string"]},"cart.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"cart.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}}};return(e={},e[l.VIEWED_PRODUCT_DETAIL]=n,e[l.ADDED_PRODUCT]=n,e[l.REMOVED_PRODUCT]={fields:["product.id"],validations:{"product.id":{errors:["required"],warnings:["string"]}}},e[l.VIEWED_PRODUCT_LISTING]={fields:["listing.categoryId","listing.category"],validations:{"listing.categoryId":{errors:["required"],warnings:["string"]},"listing.category":{errors:["required","array"]}}},e[l.VIEWED_CART]=r,e[l.VIEWED_CHECKOUT_STEP]=r,e[l.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","transaction.lineItems[].product.id","transaction.lineItems[].product.unitSalePrice","transaction.lineItems[].quantity"],validations:{"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.unitSalePrice":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].quantity":{errors:["required"],warnings:["numeric"]}}},e)[t.name]},e.prototype.initialize=function(){window.rtgNoSync=!1,window.rtgSyncFrame=!0,window._rutarget=window._rutarget||[]},e.prototype.isLoaded=function(){return!(!window._rutarget||Array.prototype.push===window._rutarget.push)},e.prototype.trackEvent=function(t){var e,n=(e={},e[l.VIEWED_PAGE]="onViewedPage",e[l.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[l.COMPLETED_TRANSACTION]="onCompletedTransaction",e[l.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[l.VIEWED_CHECKOUT_STEP]="onViewedCheckoutStep",e[l.ADDED_PRODUCT]="onAddedProduct",e[l.REMOVED_PRODUCT]="onRemovedProduct",e[l.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(){var t=this;setTimeout(function(){t.pageTracked||window._rutarget.push({event:"otherPage"})},100)},e.prototype.onViewedProductListing=function(t){var e=t.listing;if(e&&e.categoryId&&e.category){var n=e.category,r=void 0;n&&Array.isArray(n)&&(r=n[n.length-1]),window._rutarget.push({event:"showCategory",categoryCode:e.categoryId,categoryName:r}),this.pageTracked=!0}},e.prototype.onViewedProductDetail=function(t){var e=t.product;e&&e.id&&e.unitSalePrice&&(window._rutarget.push({event:"showOffer",sku:e.id,price:e.unitSalePrice}),this.pageTracked=!0)},e.prototype.onAddedProduct=function(t){var e=t.product;e&&e.id&&e.unitSalePrice&&window._rutarget.push({event:"addToCart",sku:e.id,qty:t.quantity||1,price:e.unitSalePrice})},e.prototype.onRemovedProduct=function(t){var e=t.product;e&&e.id&&window._rutarget.push({event:"removeFromCart",sku:e.id,qty:t.quantity||1})},e.prototype.onViewedCart=function(t){if(!this.cartTracked){var e=t.cart;e&&e.lineItems&&(window._rutarget.push({event:"cart",products:a(e.lineItems)}),this.cartTracked=!0,this.pageTracked=!0)}},e.prototype.onViewedCheckoutStep=function(t){if(!this.cartTracked){var e=t.cart;e&&e.lineItems&&(window._rutarget.push({event:"confirmOrder",products:a(e.lineItems)}),this.cartTracked=!0,this.pageTracked=!0)}},e.prototype.onCompletedTransaction=function(t){var e=t.transaction;e&&e.lineItems&&(window._rutarget.push({event:"thankYou",products:a(e.lineItems),order_id:e.orderId,total_cost:e.total}),this.cartTracked=!0,this.pageTracked=!0)},e}(d.default);n.default=f},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/dotProp":7}],205:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(t){return void 0===t?"undefined":s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":s(t)},u=t("@segmentstream/utils/deleteProperty"),d=r(u),l=t("@segmentstream/utils/dotProp"),p=t("../Integration"),f=r(p),g=function(t){function e(n,r){i(this,e);var a=Object.assign({https:!1,pushScriptUrl:"",pushSubscriptionTriggerEvent:"Agreed to Receive Push Notifications",userVariables:[]},r),s=o(this,t.call(this,n,a));return s.SEMANTIC_EVENTS=[s.getOption("pushSubscriptionTriggerEvent")],s.addTag({type:"script",attr:{charset:"UTF-8",src:s.getOption("pushScriptUrl")}}),s}return a(e,t),e.prototype.initialize=function(){},e.prototype.onLoad=function(){var e=this,n=window.oSpP.storeSubscription;window.oSpP.storeSubscription=function(t){n(t),"DENY"!==t&&(e.digitalData.user.pushNotifications.isSubscribed=!0,e.sendUserAttributes(e.digitalData))},this.enrichDigitalData(),t.prototype.onLoad.call(this)},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.enrichDigitalData=function(){var t=this,e=this.digitalData.user.pushNotifications={};try{e.isSupported=this.checkPushNotificationsSupport(),this.getPushSubscriptionInfo(function(n){if(t.isLoaded()){if(void 0===n){if(e.isSubscribed=!1,window.oSpP.isSafariNotificationSupported()){var r=window.safari.pushNotification.permission("web.com.sendpulse.push");"denied"===r.permission&&(e.isDenied=!0)}}else"DENY"===n.value?(e.isSubscribed=!1,e.isDenied=!0):(e.isSubscribed=!0,e.subscriptionId=n.value);t.onSubscriptionStatusReceived(),t.onEnrich()}})}catch(t){e.isSupported=!1,this.onEnrich()}},e.prototype.onSubscriptionStatusReceived=function(){this.digitalData.user.pushNotifications.isSubscribed&&this.sendUserAttributes(this.digitalData)},e.prototype.checkPushNotificationsSupport=function(){var t=window,e=t.oSpP;if(!e.detectSite())return!1;if("iOS"===e.detectOs())return!1;var n=e.detectOs(),r=e.detectBrowser(),i=r.name.toLowerCase();return!("chrome"===i&&parseFloat(r.version)<42)&&(!("firefox"===i&&parseFloat(r.version)<44)&&(("firefox"!==i||"Android"!==n)&&(!(["safari","firefox","chrome"].indexOf(i)<0)&&("safari"===i?e.isSafariNotificationSupported():!this.isHttps()||e.isServiceWorkerChromeSupported()))))},e.prototype.getPushSubscriptionInfo=function(t){window.oSpP.getDbValue("SPIDs","SubscriptionId",function(e){t(e.target.result)})},e.prototype.sendUserAttributes=function(t){this.getOption("userVariables").forEach(function(e){var n=void 0;void 0!==(n=e.indexOf(".")<0?(0,l.getProp)(t.user,e):(0,l.getProp)(t,e))&&"object"!==(void 0===n?"undefined":c(n))&&window.oSpP.push(e,String(n))})},e.prototype.isLoaded=function(){return!!window.oSpP},e.prototype.reset=function(){(0,d.default)(window,"oSpP")},e.prototype.isHttps=function(){return 0===window.location.href.indexOf("https://")&&!0===this.getOption("https")},e.prototype.trackEvent=function(t){if(t.name===this.getOption("pushSubscriptionTriggerEvent")&&this.checkPushNotificationsSupport())if(this.isHttps())window.oSpP.startSubscription();else{var e=window.oSpP.detectBrowser(),n=e.name.toLowerCase();"safari"===n?window.oSpP.startSubscription():"chrome"!==n&&"firefox"!==n||window.oSpP.showPopUp()}},e}(f.default);n.default=g},{"../Integration":143,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7}],206:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":u(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":u(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){for(var e=[],n=0,r=t.length;n<r;n+=1){var i=t[n];if(i&&i.product){var o=i.product.id||i.product.skuCode;if(o){var a={identifier:String(o),amount:i.product.unitSalePrice||i.product.unitPrice||0,quantity:i.quantity||1,currency:i.product.currency||""};e.push(a)}}}return e}function c(t){Object.keys(window[t]).forEach(function(e){""===window[t][e]&&(0,f.default)(window[t],e)})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var d=t("crypto-js/sha256"),l=r(d),p=t("@segmentstream/utils/deleteProperty"),f=r(p),g=t("../Integration"),m=r(g),h=t("../events/semanticEvents"),y=void 0,v=function(t){function e(n,r){i(this,e);var a=Object.assign({region:"",advertiserToken:"",prefix:""},r),s=o(this,t.call(this,n,a)),c=s.getOption("region")||"",u=c?c+"-":"",d=s.getOption("advertiserToken"),l="//"+u+"sonar.sociomantic.com/js/2010-07-01/adpan/"+d;return s.SEMANTIC_EVENTS=[h.VIEWED_PAGE,h.VIEWED_PRODUCT_DETAIL,h.VIEWED_PRODUCT_LISTING,h.VIEWED_CART,h.SEARCHED_PRODUCTS,h.COMPLETED_TRANSACTION],s.addTag({type:"script",attr:{type:"text/javascript",async:!0,src:l}}),s._isLoaded=!1,s.trackingScriptCalled=!1,s}return a(e,t),e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.loadTrackingScript=function(){var t=this.getOption("advertiserToken");this.trackingScriptCalled?window.sociomantic.sonar.adv[t].track():this.load(),this.trackingScriptCalled=!0,this.pageTracked=!0},e.prototype.clearTrackingObjects=function(){var t=this.getOption("advertiserToken");this.trackingScriptCalled&&window.sociomantic.sonar.adv[t].clear()},e.prototype.reset=function(){this.clearTrackingObjects(),(0,f.default)(window,"sociomantic"),this.trackingScriptCalled=!1,this._isLoaded=!1,y&&clearTimeout(y)},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case h.VIEWED_PAGE:e=["page.type","user.userId","user.email"];break;case h.VIEWED_PRODUCT_DETAIL:e=["product"];break;case h.VIEWED_PRODUCT_LISTING:e=["listing.category"];break;case h.VIEWED_CART:e=["cart.lineItems"];break;case h.SEARCHED_PRODUCTS:e=["listing.query"];break;case h.COMPLETED_TRANSACTION:e=["transaction"]}return e},e.prototype.trackEvent=function(t){var e,n=(e={},e[h.VIEWED_PAGE]="onViewedPage",e[h.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[h.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[h.VIEWED_CART]="onViewedCart",e[h.COMPLETED_TRANSACTION]="onCompletedTransaction",e[h.SEARCHED_PRODUCTS]="onSearchedProducts",e),r=n[t.name];r&&(this.trackingScriptCalled&&this.clearTrackingObjects(),this[r](t))},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1;var n=this.getOption("prefix"),r=n+"customer",i=t.user;if(i&&(i.userId||i.email)){var o=void 0,a=void 0;i.userId&&(o=String(i.userId)),i.email&&(a=(0,l.default)(i.email).toString()),window[r]={identifier:o||"",mhash:a||""},c(r)}y=setTimeout(function(){e.pageTracked||e.loadTrackingScript()},100)},e.prototype.onViewedProductDetail=function(t){var e=this.getOption("prefix"),n=e+"product",r=t.product;if(r&&(r.id||r.skuCode)){var i=void 0,o=void 0;r.id&&(i=String(r.id)),r.skuCode&&(o=String(r.skuCode)),window[n]={identifier:i||o},this.loadTrackingScript()}},e.prototype.onViewedProductListing=function(t){var e=this.getOption("prefix"),n=e+"product",r=t.listing;r&&r.category&&r.category.length&&(window[n]={category:r.category},this.loadTrackingScript())},e.prototype.onSearchedProducts=function(t){var e=this.getOption("prefix"),n=e+"search",r=t.listing;r&&r.query&&(window[n]={query:r.query,type:2},this.loadTrackingScript())},e.prototype.onViewedCart=function(t){var e=this.getOption("prefix"),n=e+"basket",r=t.cart;if(r&&r.lineItems){var i=s(r.lineItems);i.length&&(window[n]={products:i},this.loadTrackingScript())}},e.prototype.onCompletedTransaction=function(t){var e=this.getOption("prefix"),n=e+"basket",r=t.transaction;if(r&&r.lineItems){var i=s(r.lineItems);if(i.length){var o=void 0;r.orderId&&(o=String(r.orderId)),window[n]={products:i,transaction:o||"",amount:r.total||"",currency:r.currency||""},c(n)}}this.loadTrackingScript()},e}(m.default);n.default=v},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/deleteProperty":5,"crypto-js/sha256":101}],207:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/dotProp"),u=t("@segmentstream/utils/cleanObject"),d=r(u),l=t("@segmentstream/utils/deleteProperty"),p=r(l),f=t("@segmentstream/utils/normalizeString"),g=r(f),m=t("crypto-js/md5"),h=r(m),y=t("../Integration"),v=r(y),E=t("../events/semanticEvents"),w=[E.VIEWED_PAGE,E.VIEWED_PRODUCT_DETAIL,E.COMPLETED_TRANSACTION,E.LOGGED_IN,E.REGISTERED,E.SUBSCRIBED,E.ADDED_PRODUCT,E.REMOVED_PRODUCT,E.VIEWED_CART],_=function(t){function e(n,r){i(this,e);var a=Object.assign({siteId:"",userSegmentVar:void 0},r);return o(this,t.call(this,n,a))}return a(e,t),e.prototype.adriverCounterFactory=function(){return function(){var t=window.document,e=function t(e,n){if(!(this instanceof AdriverCounter))return t.items[e];e=t.items.length||1,t.items[e]=this,n.ph=e,n.custom&&(n.custom=t.toQueryString(n.custom,";")),t.request(t.toQueryString(n))};return e.httplize=function(t){return(/^\/\//.test(t)?location.protocol:"")+t},e.loadScript=function(e){try{var n=t.getElementsByTagName("head")[0],r=t.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("referrerpolicy","no-referrer-when-downgrade"),r.setAttribute("charset","windows-1251"),r.setAttribute("src",e.split("![rnd]").join(Math.round(1e6*Math.random()))),r.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&(r.onload=null,n.removeChild(r))},r.onload=function(){n.removeChild(r)},n.insertBefore(r,n.firstChild)}catch(t){console.error(t)}},e.toQueryString=function(t,e,n){e=e||"&",n=n||"=";var r,i=[];for(r in t)t.hasOwnProperty(r)&&i.push(r+n+escape(t[r]));return i.join(e)},e.request=function(t){var n=e.toQueryString(e.defaults);e.loadScript(e.redirectHost+"/cgi-bin/erle.cgi?"+t+"&rnd=![rnd]"+(n?"&"+n:""))},e.items=[],e.defaults={tail256:document.referrer||"unknown"},e.redirectHost=e.httplize("//ad.adriver.ru"),e}},e.prototype.initAdriverCounter=function(t,e){e=e||{},e.custom=e.custom||{},e.custom=Object.assign(e.custom,{153:this.getEmailMd5(t),160:(0,c.getProp)(t,"user.hasTransacted")?0:1,162:this.getUserSegment(t)}),e=Object.assign(e,{sid:this.getOption("siteId"),bt:62}),e=(0,d.default)(e),new window.AdriverCounter(0,e)},e.prototype.getSemanticEvents=function(){return w},e.prototype.getEnrichableEventProps=function(t){var e=void 0;switch(t.name){case E.VIEWED_PRODUCT_DETAIL:case E.ADDED_PRODUCT:case E.REMOVED_PRODUCT:e=["product.id","product.categoryId"];break;case E.COMPLETED_TRANSACTION:e=["transaction"];break;case E.REGISTERED:case E.LOGGED_IN:e=["user.userId"];break;default:e=[]}e.push("user.email","user.hasTransacted");var n=this.getOption("userSegmentVar");return n&&e.push(n),e},e.prototype.getEventValidationConfig=function(t){var e,n={fields:["product.id","product.categoryId"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.categoryId":{errors:["required"],warnings:["string"]}}},r=(e={},e[E.VIEWED_PRODUCT_DETAIL]=n,e[E.ADDED_PRODUCT]=n,e[E.REMOVED_PRODUCT]=n,e[E.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.total","transaction.lineItems[].product.id"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.total":{errors:["required"],warnings:["numeric"]},"transaction.lineItems[].product.id":{warnings:["required","string"]}}},e[E.REGISTERED]={fields:["user.userId","user.email"],validations:{"user.userId":{errors:["required"],warnings:["string"]}}},e[E.LOGGED_IN]={fields:["user.userId","user.email"],validations:{"user.userId":{errors:["required"],warnings:["string"]}}},e[E.SUBSCRIBED]={fields:["user.email"],validations:{"user.email":{errors:["required"],warnings:["string"]}}},e[E.VIEWED_CART]={fields:["user.email"],validations:{"user.email":{warnings:["string"]}}},e),i=r[t.name],o=this.getOption("userSegmentVar");return o&&(i?(i.fields=i.fields||[],i.fields.push(o)):i={fields:[o]}),i},e.prototype.initialize=function(){window.AdriverCounter=this.adriverCounterFactory()()},e.prototype.isLoaded=function(){return!!window.AdriverCounter},e.prototype.reset=function(){(0,p.default)(window,"AdriverCounter"),this.pageTracked=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.getEmailMd5=function(t){var e=(0,c.getProp)(t,"user.email");if(e){var n=(0,g.default)(e);return(0,h.default)(n).toString()}},e.prototype.getUserSegment=function(t){var e=this.getOption("userSegmentVar");if(e)return(0,c.getProp)(t,e)},e.prototype.trackEvent=function(t){var e,n=(e={},e[E.VIEWED_PAGE]="onViewedPage",e[E.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[E.COMPLETED_TRANSACTION]="onCompletedTransaction",e[E.REGISTERED]="onRegistered",e[E.LOGGED_IN]="onLoggedIn",e[E.SUBSCRIBED]="onSubscribed",e[E.REMOVED_PRODUCT]="onRemovedProduct",e[E.ADDED_PRODUCT]="onAddedProduct",e[E.VIEWED_CART]="onViewedCart",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1,this.timeoutHandle=setTimeout(function(){e.pageTracked||e.onViewedOther(t)},100)},e.prototype.onViewedOther=function(t){this.initAdriverCounter(t),this.pageTracked=!0},e.prototype.onViewedProductDetail=function(t){var e=t.product||{};e.id&&(this.initAdriverCounter(t,{custom:{10:e.id,11:e.categoryId}}),this.pageTracked=!0)},e.prototype.onNewBuyer=function(t){var e=t.transaction||{};e.orderId&&(this.initAdriverCounter(t,{sz:"new_buyer",custom:{150:e.orderId,151:e.total}}),this.pageTracked=!0)},e.prototype.onCompletedTransaction=function(t){var e=t.transaction||{},n=e.lineItems||[];e.orderId&&(e.isFirst&&this.onNewBuyer(t),this.initAdriverCounter(t,{sz:"confirm",custom:{150:e.orderId,151:e.total,10:n.map(function(t){return(0,c.getProp)(t,"product.id")}).join(",")}}),this.pageTracked=!0)},e.prototype.onAddedProduct=function(t){var e=t.product||{};e.id&&(this.initAdriverCounter(t,{sz:"add_basket",custom:{10:e.id,11:e.categoryId}}),this.pageTracked=!0)},e.prototype.onRemovedProduct=function(t){var e=t.product||{};e.id&&(this.initAdriverCounter(t,{sz:"del_basket",custom:{10:e.id,11:e.categoryId}}),this.pageTracked=!0)},e.prototype.onViewedCart=function(t){this.initAdriverCounter(t,{sz:"basket"}),this.pageTracked=!0},e.prototype.onRegistered=function(t){var e=t.user||{};e.userId&&(this.initAdriverCounter(t,{sz:"regist",custom:{152:e.userId}}),this.pageTracked=!0)},e.prototype.onLoggedIn=function(t){var e=t.user||{};e.userId&&(this.initAdriverCounter(t,{sz:"authorization",custom:{152:e.userId}}),this.pageTracked=!0)},e.prototype.onSubscribed=function(t){(t.user||{}).email&&(this.initAdriverCounter(t,{sz:"newsletter"}),this.pageTracked=!0)},e}(v.default);n.default=_},{"../Integration":143,"../events/semanticEvents":158,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/normalizeString":30,"crypto-js/md5":100}],208:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}
var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0,n.CONFIRMATION_PAGE_ID=n.EMPTY_SEARCH_PAGE_ID=n.SEARCH_PAGE_ID=n.CART_PAGE_ID=n.LISTING_PAGE_ID=n.PRODUCT_PAGE_ID=n.OTHER_PAGE_ID=n.HOME_PAGE_ID=void 0;var c=t("@segmentstream/utils/dotProp"),u=t("../Integration"),d=r(u),l=t("../events/semanticEvents"),p=t("./utils/AsyncQueue"),f=r(p),g=[l.VIEWED_PAGE,l.VIEWED_PRODUCT_DETAIL,l.VIEWED_PRODUCT_LISTING,l.VIEWED_CART,l.SEARCHED_PRODUCTS,l.COMPLETED_TRANSACTION],m=n.HOME_PAGE_ID="1000",h=n.OTHER_PAGE_ID="2200",y=n.PRODUCT_PAGE_ID="1200",v=n.LISTING_PAGE_ID="1400",E=n.CART_PAGE_ID="1600",w=n.SEARCH_PAGE_ID="2000",_=n.EMPTY_SEARCH_PAGE_ID="3400",b=n.CONFIRMATION_PAGE_ID="2400",I=function(t){function e(n,r){i(this,e);var a=Object.assign({clientId:void 0,feedWithGroupedProducts:!1,hasRankOption:!0},r),s=o(this,t.call(this,n,a));return s.addTag("trackingScript",{type:"script",attr:{type:"text/javascript",async:!0,src:"https://static.target2sell.com/t2s.min.js"}}),s}return a(e,t),e.prototype.initialize=function(){this.asyncQueue=new f.default(function(){return!!window.T2S}),this._isLoaded=!0},e.prototype.target2SellApiCall=function(t){this.pageTracked=!0,this.trackingScriptLoaded?this.asyncQueue.push(function(){window._t2sparams=t,window.T2S._sendTracking()}):(window._t2sparams=t,this.load("trackingScript"),this.trackingScriptLoaded=!0)},e.prototype.getSemanticEvents=function(){return g},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case l.VIEWED_PAGE:e=["page.type","user.userId","user.email"];break;case l.VIEWED_PRODUCT_DETAIL:e=["page.type","user.userId","user.email","product"];break;case l.VIEWED_PRODUCT_LISTING:e=["page.type","user.userId","user.email","listing.items"];break;case l.VIEWED_CART:e=["page.type","user.userId","user.email","cart"];break;case l.SEARCHED_PRODUCTS:e=["page.type","user.userId","user.email","listing.items","page.queryString"];break;case l.COMPLETED_TRANSACTION:e=["page.type","user.userId","user.email","transaction"]}return e},e.prototype.prepareParams=function(t,e){return{eN:e||"view",cID:this.getOption("clientId"),pID:this.getPageId(t),uEM:(0,c.getProp)(t,"user.email"),uID:(0,c.getProp)(t,"user.userId"),hasRankOption:this.getOption("hasRankOption")}},e.prototype.getPageId=function(t){var e;return(e={},e[l.VIEWED_PAGE]="home"===(0,c.getProp)(t,"page.type")?m:h,e[l.VIEWED_PRODUCT_DETAIL]=y,e[l.VIEWED_PRODUCT_LISTING]=v,e[l.VIEWED_CART]=E,e[l.SEARCHED_PRODUCTS]=((0,c.getProp)(t,"listing.items")||[]).length>0?w:_,e[l.COMPLETED_TRANSACTION]=b,e)[t.name]},e.prototype.getProductIds=function(t){var e=this.getOption("feedWithGroupedProducts");return t.map(function(t){return t[e?"skuCode":"id"]}).join("|")},e.prototype.getProductFields=function(t,e){return t.map(function(t){return t[e]}).join("|")},e.prototype.getSearchString=function(t){var e=t.indexOf("=")+1;return e>0?t.substr(e):""},e.prototype.trackEvent=function(t){var e,n=(e={},e[l.VIEWED_PAGE]="onViewedPage",e[l.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[l.VIEWED_PRODUCT_LISTING]="onViewedProductListing",e[l.VIEWED_CART]="onViewedCart",e[l.SEARCHED_PRODUCTS]="onSearchedProducts",e[l.COMPLETED_TRANSACTION]="onCompletedTransaction",e),r=n[t.name];r&&this[r](t)},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1,setTimeout(function(){e.pageTracked||e.target2SellApiCall(e.prepareParams(t))},100)},e.prototype.onViewedProductDetail=function(t){var e=this.prepareParams(t);e.iID=this.getProductIds([t.product]),this.target2SellApiCall(e)},e.prototype.onViewedProductListing=function(t){var e=this.prepareParams(t),n=(0,c.getProp)(t,"listing.items")||[];e.iID=this.getProductIds(n),this.target2SellApiCall(e)},e.prototype.onViewedCart=function(t){var e=this.prepareParams(t),n=(0,c.getProp)(t,"cart.lineItems");e.iID=this.getProductIds(n.map(function(t){return t.product})),e.qTE=this.getProductFields(n,"quantity"),this.target2SellApiCall(e)},e.prototype.onSearchedProducts=function(t){var e=this.prepareParams(t),n=(0,c.getProp)(t,"listing.items")||[],r=(0,c.getProp)(t,"page.queryString");n.length>0&&(e.iID=this.getProductIds(n)),e.kw=this.getSearchString(r),this.target2SellApiCall(e)},e.prototype.onCompletedTransaction=function(t){var e=this.prepareParams(t),n=(0,c.getProp)(t,"transaction.lineItems")||[];e.iID=this.getProductIds(n.map(function(t){return t.product})),e.bS=String((0,c.getProp)(t,"transaction.total")),e.qTE=this.getProductFields(n,"quantity"),e.oID=(0,c.getProp)(t,"transaction.orderId"),e.priceL=this.getProductFields(n,"subtotal"),this.target2SellApiCall(e)},e}(d.default);n.default=I},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/dotProp":7}],209:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/getQueryParam"),u=r(c),d=t("@segmentstream/utils/dotProp"),l=t("@segmentstream/utils/normalizeString"),p=r(l),f=t("../Integration"),g=r(f),m=t("../events/semanticEvents"),h=t("./utils/affiliate"),y="tradetracker",v="tradetracker",E=function(t){function e(n,r){i(this,e);var a=Object.assign({campaignId:"",cookieName:y,cookieTracking:!0,cookieDomain:"",cookieTtl:90,deduplication:!1,utmSource:v,deduplicationUtmMedium:[]},r),s=o(this,t.call(this,n,a));return s._isLoaded=!1,s.addTag("trackingPixel",{type:"img",attr:{src:"//ts.tradetracker.net/?cid="+r.campaignId+"&tid={{ orderId }}&tam={{ subtotal }}&qty=1&event=sales&currency={{ currency }}"}}),s}return a(e,t),e.prototype.initialize=function(){if(this._isLoaded=!0,this.getOption("cookieTracking")){var t=(0,p.default)(this.getOption("utmSource"));if((0,u.default)("utm_source")===t){var e=this.getOption("cookieName"),n=this.getOption("cookieTtl"),r=this.getOption("cookieDomain");(0,h.addAffiliateCookie)(e,1,n,r)}}},e.prototype.getSemanticEvents=function(){return[m.COMPLETED_TRANSACTION]},e.prototype.getEnrichableEventProps=function(t){var e=[];return t.name===m.COMPLETED_TRANSACTION&&(e=["transaction","context.campaign"]),e},e.prototype.getEventValidationConfig=function(t){var e;return(e={},e[m.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.subtotal","transaction.total","transaction.currency","context.campaign.medium"],validations:{"transaction.orderId":{errors:["required"],warnings:["string"]},"transaction.subtotal":{warnings:["required","numeric"]}}},e)[t.name]},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){if(t.name===m.COMPLETED_TRANSACTION){if(!(0,h.getAffiliateCookie)(this.getOption("cookieName")))return;var e=(0,d.getProp)(t,"context.campaign"),n=this.getOption("utmSource"),r=this.getOption("deduplicationUtmMedium");if((0,h.isDeduplication)(e,n,r))return;this.trackSale(t)}},e.prototype.trackSale=function(t){var e=t.transaction;if(e&&e.orderId){var n=e.orderId,r=e.currency,i=e.subtotal||e.total;this.load("trackingPixel",{orderId:n,subtotal:i,currency:r})}},e}(g.default);n.default=E},{"../Integration":143,"../events/semanticEvents":158,"./utils/affiliate":216,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getQueryParam":12,"@segmentstream/utils/normalizeString":30}],210:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("../Integration"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=t("../events/semanticEvents"),d=function(t){function e(n,o){r(this,e);var a=Object.assign({clientId:""},o),s=i(this,t.call(this,n,a));return s.pluginLoaded=!1,s.addTag("plugin",{type:"script",attr:{id:"tryfit-plugin",src:"https://plugin.try.fit/"+o.clientId+"/tf.js"}}),s}return o(e,t),e.prototype.getSemanticEvents=function(){return[u.VIEWED_PRODUCT_DETAIL]},e.prototype.trackEvent=function(t){this.pluginLoaded||t.name!==u.VIEWED_PRODUCT_DETAIL||(this.pluginLoaded=!0,this.load("plugin"))},e}(c.default);n.default=d},{"../Integration":143,"../events/semanticEvents":158}],211:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("../Integration"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=t("../events/semanticEvents"),d=function(t){function e(n,o){r(this,e);var a=Object.assign({javaScriptUrl:"",pixelUrl:""},o),s=i(this,t.call(this,n,a));return s.addTag({type:"script",attr:{src:o.javaScriptUrl}}),s.addTag("pixel",{type:"img",attr:{src:o.pixelUrl}}),s}return o(e,t),e.prototype.getSemanticEvents=function(){return[u.VIEWED_PAGE,u.COMPLETED_TRANSACTION]},e.prototype.isLoaded=function(){return!!window.VeAPI},e.prototype.trackEvent=function(t){t.name===u.COMPLETED_TRANSACTION&&this.getOption("pixelUrl")&&this.load("pixel")},e}(c.default);n.default=d},{"../Integration":143,"../events/semanticEvents":158}],212:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/arrayMerge"),u=r(c),d=t("@segmentstream/utils/deleteProperty"),l=r(d),p=t("@segmentstream/utils/getVarValue"),f=r(p),g=t("@segmentstream/utils/dotProp"),m=t("./utils/AsyncQueue"),h=r(m),y=t("../Integration"),v=r(y),E=t("../events/semanticEvents"),w=function(t,e){return{id:e?t.skuCode:t.id,price:t.unitSalePrice,price_old:t.unitPrice}},_=function(t){return"RUB"===t?"RUR":t},b=function(t){function e(n,r){i(this,e);var a=Object.assign({pixels:r.pixelId?[{pixelId:r.pixelId,priceListId:r.priceListId}]:[],customEvents:{},eventPixels:{},pixelId:"",priceListId:""},r),s=o(this,t.call(this,n,a));return s.asyncQueue=new h.default(s.isLoaded),s.hasPixels()?s.SEMANTIC_EVENTS=[E.VIEWED_PAGE,E.VIEWED_PRODUCT_DETAIL,E.VIEWED_PRODUCT_LISTING,E.SEARCHED_PRODUCTS,E.ADDED_PRODUCT,E.ADDED_PRODUCT_TO_WISHLIST,E.REMOVED_PRODUCT,E.REMOVED_PRODUCT_FROM_WISHLIST,E.STARTED_ORDER,E.ADDED_PAYMENT_INFO,E.COMPLETED_TRANSACTION]:s.SEMANTIC_EVENTS=[],(0,u.default)(s.SEMANTIC_EVENTS,Object.keys(s.getOption("eventPixels"))),(0,u.default)(s.SEMANTIC_EVENTS,Object.keys(s.getOption("customEvents"))),s.addTag({type:"script",attr:{src:"https://vk.com/js/api/openapi.js?150"}}),s}return a(e,t),e.prototype.hasPixels=function(){return!!(this.getOption("pixels")||[]).length},e.prototype.onLoadInitiated=function(){this.asyncQueue.init()},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getEnrichableEventProps=function(t){var e=[];return t.name===E.VIEWED_PAGE&&(e=["page.type"]),t.name===E.VIEWED_PRODUCT_DETAIL&&(e=["product"]),t.name!==E.STARTED_ORDER&&t.name!==E.ADDED_PAYMENT_INFO||(e=["cart"]),t.name===E.COMPLETED_TRANSACTION&&(e=["transaction"]),t.name!==E.VIEWED_PRODUCT_LISTING&&t.name!==E.SEARCHED_PRODUCTS||(e=["listing"]),this.getOption("pixels").forEach(function(t){var n=(0,g.getProp)(t,"priceListId.type"),r=(0,g.getProp)(t,"priceListId.value");"digitalData"===n&&e.push(r)}),e},e.prototype.allowNoConflictInitialization=function(){return!0},e.prototype.isLoaded=function(){return!(!window.VK||!window.VK.Retargeting)},e.prototype.reset=function(){(0,l.default)(window,"VK")},e.prototype.getProductId=function(t,e){return e.feedWithGroupedProducts?t.skuCode:t.id},e.prototype.getPriceListId=function(t,e){var n=e.priceListId;return"string"==typeof n?n:(0,f.default)(n,t)},e.prototype.trackSingleProduct=function(t,e){var n=this,r=t.product||{};this.asyncQueue.push(function(){n.getOption("pixels").forEach(function(i){window.VK.Retargeting.Init(i.pixelId),window.VK.Retargeting.ProductEvent(n.getPriceListId(t,i),e,{products:[w(r,i.feedWithGroupedProducts)],total_price:r.unitSalePrice,currency_code:_(r.currency)})})}),this.pageTracked=!0},e.prototype.trackLineItems=function(t,e,n,r,i){var o=this;this.asyncQueue.push(function(){o.getOption("pixels").forEach(function(a){window.VK.Retargeting.Init(a.pixelId),window.VK.Retargeting.ProductEvent(o.getPriceListId(r,a),i,{products:t.map(function(t){return w(t.product,a.feedWithGroupedProducts)}),total_price:e,currency_code:_(n)})})}),this.pageTracked=!0},e.prototype.trackCart=function(t,e){var n=(0,g.getProp)(t,"cart.lineItems")||[],r=(0,g.getProp)(t,"cart.subtotal"),i=(0,g.getProp)(t,"cart.currency");this.trackLineItems(n,r,i,t,e)},e.prototype.trackTransaction=function(t,e){var n=(0,g.getProp)(t,"transaction.lineItems")||[],r=(0,g.getProp)(t,"transaction.subtotal"),i=(0,g.getProp)(t,"transaction.currency");this.trackLineItems(n,r,i,t,e)},e.prototype.trackEvent=function(t){var e=this;if(this.hasPixels()){var n,r=(n={},n[E.VIEWED_PAGE]="onViewedPage",n[E.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",n[E.COMPLETED_TRANSACTION]="onCompletedTransaction",n[E.VIEWED_PRODUCT_LISTING]="onViewedProductListing",n[E.SEARCHED_PRODUCTS]="onSearchedProducts",n[E.ADDED_PRODUCT]="onAddedProduct",n[E.REMOVED_PRODUCT]="onRemovedProduct",n[E.ADDED_PRODUCT_TO_WISHLIST]="onAddedProductToWishlist",n[E.REMOVED_PRODUCT_FROM_WISHLIST]="onRemovedProductFromWishlist",n[E.STARTED_ORDER]="onStartedOrder",n[E.ADDED_PAYMENT_INFO]="onAddedPaymentInfo",n),i=r[t.name];i&&this[i](t)}var o=this.getOption("customEvents"),a=o[t.name];a&&this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(t){window.VK.Retargeting.Init(t.pixelId),window.VK.Retargeting.Event(a)})});var s=this.getOption("eventPixels"),c=s[t.name];c&&this.addPixel(c)},e.prototype.onViewedPage=function(t){var e=this;this.pageTracked=!1,this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(t){window.VK.Retargeting.Init(t.pixelId),window.VK.Retargeting.Hit()})}),"home"===(t.page||{}).type?(this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(n){window.VK.Retargeting.Init(n.pixelId),window.VK.Retargeting.ProductEvent(e.getPriceListId(t,n),"view_home")})}),this.pageTracked=!0):setTimeout(function(){e.pageTracked||e.onViewedOther(t)},100)},e.prototype.onViewedOther=function(t){var e=this;this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(n){window.VK.Retargeting.Init(n.pixelId),window.VK.Retargeting.ProductEvent(e.getPriceListId(t,n),"view_other")})}),this.pageTracked=!0},e.prototype.onViewedProductListing=function(t){var e=this,n=(0,g.getProp)(t,"listing.items")||[];this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(r){window.VK.Retargeting.Init(r.pixelId),window.VK.Retargeting.ProductEvent(e.getPriceListId(t,r),"view_category",{category_ids:[(0,g.getProp)(t,"listing.categoryId")],products_recommended_ids:n.slice(0,4).map(function(t){return e.getProductId(t,r)})})})}),this.pageTracked=!0},e.prototype.onViewedProductDetail=function(t){this.trackSingleProduct(t,"view_product")},e.prototype.onSearchedProducts=function(t){var e=this,n=(0,g.getProp)(t,"listing.items")||[],r=(0,g.getProp)(t,"listing.query");this.asyncQueue.push(function(){e.getOption("pixels").forEach(function(i){window.VK.Retargeting.Init(i.pixelId),window.VK.Retargeting.ProductEvent(e.getPriceListId(t,i),"view_search",{search_string:r,products_recommended_ids:n.slice(0,4).map(function(t){return i.feedWithGroupedProducts?t.skuCode:t.id})})})}),this.pageTracked=!0},e.prototype.onAddedProductToWishlist=function(t){this.trackSingleProduct(t,"add_to_wishlist")},e.prototype.onAddedProduct=function(t){this.trackSingleProduct(t,"add_to_cart")},e.prototype.onRemovedProductFromWishlist=function(t){this.trackSingleProduct(t,"remove_from_wishlist")},e.prototype.onRemovedProduct=function(t){this.trackSingleProduct(t,"remove_from_cart")},e.prototype.onStartedOrder=function(t){this.trackCart(t,"init_checkout")},e.prototype.onAddedPaymentInfo=function(t){this.trackCart(t,"add_payment_info")},e.prototype.onCompletedTransaction=function(t){this.trackTransaction(t,"purchase")},e.prototype.addPixel=function(t){(window.Image?new window.Image:window.document.createElement("img")).src=window.location.protocol+t},e}(v.default);n.default=b},{"../Integration":143,"../events/semanticEvents":158,"./utils/AsyncQueue":215,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/getVarValue":14}],213:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var s=t("../Integration"),c=function(t){return t&&t.__esModule?t:{default:t}}(s),u=function(t){function e(n,o){r(this,e);var a=Object.assign({siteId:"",eventPixels:{}},o),s=i(this,t.call(this,n,a));s.SEMANTIC_EVENTS=Object.keys(s.getOption("eventPixels")),s._isLoaded=!1;var c=s.getOption("siteId");return c?s.addTag({type:"img",attr:{src:"https://rtbprojects.solution.weborama.fr/fcgi-bin/dispatch.fcgi?a.A=co&a.si="+c+"&a.cp={{ conversionId }}&a.ct=d"}}):s.addTag("weborama-event-pixel",{type:"img",attr:{src:"{{ url }}"}}),s}return o(e,t),e.prototype.initialize=function(){this._isLoaded=!0},e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.trackEvent=function(t){var e=this.getOption("eventPixels");if(this.getOption("siteId")){var n=e[t.name];n&&this.load({conversionId:n})}else e[t.name]&&this.load("weborama-event-pixel",{url:e[t.name]})},e}(c.default);n.default=u},{"../Integration":143}],214:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var c=t("@segmentstream/utils/deleteProperty"),u=r(c),d=t("@segmentstream/utils/cleanObject"),l=r(d),p=t("@segmentstream/utils/arrayMerge"),f=r(p),g=t("@segmentstream/utils/size"),m=r(g),h=t("js-cookie"),y=r(h),v=t("@segmentstream/utils/dotProp"),E=t("@segmentstream/utils/eventListener"),w=t("../events/semanticEvents"),_=t("../Integration"),b=r(_),I=t("../IntegrationUtils"),P=function(t){function e(n,r){i(this,e);var a=Object.assign({counterId:"",accurateTrackBounce:!1,feedWithGroupedProducts:!1,sendUserId:!0,clickmap:!1,webvisor:!1,webvisorVersion:1,trackLinks:!0,trackHash:!1,purchaseGoalId:void 0,goals:{},visitParamsVars:{},userParamsVars:{}},r),s=o(this,t.call(this,n,a));return s.dataLayerName="yandexDL",s.yaCounterClass="Metrika",s.yaCallbacksArrayName="yandex_metrika_callbacks",r.webvisor&&2===r.webvisorVersion&&(s.yaCounterClass+="2",s.yaCallbacksArrayName+="2"),s.enrichableUserParamsProps=(0,I.getEnrichableVariableMappingProps)(s.getOption("userParamsVars")),s.enrichableVisitParamsProps=(0,I.getEnrichableVariableMappingProps)(s.getOption("visitParamsVars")),s.SEMANTIC_EVENTS=[w.VIEWED_PAGE,w.VIEWED_PRODUCT_DETAIL,w.ADDED_PRODUCT,w.REMOVED_PRODUCT,w.COMPLETED_TRANSACTION],s.goalEvents=Object.keys(s.getOption("goals")),s.goalEvents.forEach(function(t){s.SEMANTIC_EVENTS.indexOf(t)<0&&s.SEMANTIC_EVENTS.push(t)}),s.pageCalled=!1,s.dataLayer=[],s.addTag({type:"script",attr:{src:"https://mc.yandex.ru/metrika/"+(r.webvisor&&2===r.webvisorVersion?"tag":"watch")+".js"}}),s}return a(e,t),e.prototype.getSemanticEvents=function(){return this.SEMANTIC_EVENTS},e.prototype.getGoalEvents=function(){return this.goalEvents},e.prototype.getProductCategory=function(t){var e=t.category;return Array.isArray(e)?e=e.join("/"):e&&t.subcategory&&(e=e+"/"+t.subcategory),e},e.prototype.getProductId=function(t){return this.getOption("feedWithGroupedProducts")?t.skuCode:t.id},e.prototype.getProduct=function(t,e){var n={},r=this.getProductId(t),i=t.brand||t.manufacturer,o=t.unitSalePrice||t.unitPrice,a=this.getProductCategory(t);return r&&(n.id=r),t.name&&(n.name=t.name),i&&(n.brand=i),o&&(n.price=o),a&&(n.category=a),t.variant&&(n.variant=t.variant),t.voucher&&(n.coupon=t.voucher),e&&(n.quantity=e),n},e.prototype.getEnrichableEventProps=function(t){var e=[];switch(t.name){case w.VIEWED_PAGE:e=["user.userId"],(0,f.default)(e,this.getEnrichableUserParamsProps()),(0,f.default)(e,this.getEnrichableVisitParamsProps());break;case w.VIEWED_PRODUCT_DETAIL:e=["product"];break;case w.COMPLETED_TRANSACTION:e=["transaction"];break;default:this.getGoalEvents().indexOf(t.name)>=0&&((0,f.default)(e,this.getEnrichableUserParamsProps()),(0,f.default)(e,this.getEnrichableVisitParamsProps()))}return e},e.prototype.getEventValidationConfig=function(t){var e,n=[];return(0,f.default)(n,this.getEnrichableUserParamsProps()),(0,f.default)(n,this.getEnrichableVisitParamsProps()),(e={},e[w.VIEWED_PAGE]={fields:n},e[w.VIEWED_PRODUCT_DETAIL]={fields:["product.id","product.name","product.category","product.unitSalePrice","product.currency"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},"product.unitSalePrice":{errors:["numeric"],warnings:["required"]},"product.currency":{warnings:["required","string"]}}},e[w.ADDED_PRODUCT]={fields:["product.id","product.name","product.category","product.unitSalePrice","product.currency","quantity"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},"product.unitSalePrice":{errors:["numeric"],warnings:["required"]},"product.currency":{warnings:["required","string"]},quantity:{warnings:["required","numeric"]}}},e[w.REMOVED_PRODUCT]={fields:["product.id","product.name","product.category","quantity"],validations:{"product.id":{errors:["required"],warnings:["string"]},"product.name":{warnings:["required","string"]},"product.category":{warnings:["required","array"]},quantity:{warnings:["required","numeric"]}}},e[w.COMPLETED_TRANSACTION]={fields:["transaction.orderId","transaction.lineItems[].product.id","transaction.lineItems[].product.name","transaction.lineItems[].product.category","transaction.lineItems[].product.unitSalePrice","transaction.total"],validations:{"transaction.orderId":{errors:["required"],warning:["string"]},"transaction.lineItems[].product.id":{errors:["required"],warnings:["string"]},"transaction.lineItems[].product.name":{warnings:["required","string"]},"transaction.lineItems[].product.category":{warnings:["required","array"]},"transaction.lineItems[].product.unitSalePrice":{warnings:["required","numeric"]},"transaction.total":{warnings:["required","numeric"]}}},e)[t.name]},e.prototype.getEnrichableUserParamsProps=function(){return this.enrichableUserParamsProps||[]},e.prototype.getEnrichableVisitParamsProps=function(){return this.enrichableVisitParamsProps||[]},e.prototype.getUserParams=function(t){return(0,I.extractVariableMappingValues)(t,this.getOption("userParamsVars"))},e.prototype.getVisitParams=function(t){return(0,I.extractVariableMappingValues)(t,this.getOption("visitParamsVars"))},e.prototype.yaCounterCall=function(t,e){var n=this;!this.isLoaded()&&window[this.yaCallbacksArrayName]?window[this.yaCallbacksArrayName].push(function(){n.yaCounter[t].apply(n,e)}):this.yaCounter[t].apply(this,e)},e.prototype.onYaCounterInited=function(t){if(this.yaCounter)t();else{var e=this.getOption("counterId");(0,E.bind)(document,"yacounter"+e+"inited",t)}},e.prototype.yaCounterCreate=function(t,e){var n=this,r=this.getOption("counterId"),i=function(){n.yaCounter=window["yaCounter"+r]=new window.Ya[n.yaCounterClass]({id:r,accurateTrackBounce:n.getOption("accurateTrackBounce"),clickmap:n.getOption("clickmap"),webvisor:n.getOption("webvisor"),trackLinks:n.getOption("trackLinks"),trackHash:n.getOption("trackHash"),triggerEvent:!0,ecommerce:n.dataLayerName,params:t,userParams:e})};!this.isLoaded()&&window[this.yaCallbacksArrayName]?window[this.yaCallbacksArrayName].push(function(){i()}):i()},e.prototype.allowNoConflictInitialization=function(){return!0},e.prototype.initialize=function(){window[this.yaCallbacksArrayName]=window[this.yaCallbacksArrayName]||[],this.dataLayer=window[this.dataLayerName]=window[this.dataLayerName]||[],this.enrichDigitalData()},e.prototype.enrichDigitalData=function(){var t=this,e=function(e){t.digitalData.changes.push(["user.yandexClientId",e,"DDM Yandex Metrica Integration"])},n=y.default.get("_ym_uid");this.digitalData.user=this.digitalData.user||{},n?(e(n),this.onEnrich()):this.onYaCounterInited(function(){e(t.yaCounter.getClientID()),t.onEnrich()})},e.prototype.isLoaded=function(){return window.Ya&&(1===this.getOption("webvisorVersion")&&window.Ya.Metrika||2===this.getOption("webvisorVersion")&&window.Ya.Metrika2)},e.prototype.reset=function(){(0,u.default)(window,"Ya"),(0,u.default)(window,this.yaCallbacksArrayName),(0,u.default)(window,this.dataLayerName),this.pageCalled=!1},e.prototype.trackEvent=function(t){var e,n=(e={},e[w.VIEWED_PAGE]="onViewedPage",e[w.VIEWED_PRODUCT_DETAIL]="onViewedProductDetail",e[w.ADDED_PRODUCT]="onAddedProduct",e[w.REMOVED_PRODUCT]="onRemovedProduct",e[w.COMPLETED_TRANSACTION]="onCompletedTransaction",e);if(this.getOption("counterId")){var r=n[t.name];r&&this[r](t),this.trackCustomEvent(t)}},e.prototype.onViewedPage=function(t){if(this.getOption("counterId")){var e=(0,l.default)(this.getVisitParams(t)),n=(0,l.default)(this.getUserParams(t));if(this.pageCalled){var r=t.page||{},i=r.url||window.location.href;this.yaCounterCall("hit",[i,{referer:r.referrer||document.referrer,title:r.title||document.title,params:e}]),(0,m.default)(n)&&this.yaCounterCall("userParams",[n])}else this.yaCounterCreate(e,n),this.pageCalled=!0;if(this.getOption("sendUserId")){var o=(0,v.getProp)(t,"user.userId");o&&this.yaCounterCall("setUserID",[o])}}},e.prototype.onViewedProductDetail=function(t){var e=t.product;(this.getProductId(e)||e.name)&&this.dataLayer.push({ecommerce:{detail:{products:[this.getProduct(e)]}}})},e.prototype.onAddedProduct=function(t){var e=t.product;if(this.getProductId(e)||e.name){var n=t.quantity||1;this.dataLayer.push({ecommerce:{add:{products:[this.getProduct(e,n)]}}})}},e.prototype.onRemovedProduct=function(t){var e=t.product;if(this.getProductId(e)||e.name){var n=t.quantity;this.dataLayer.push({ecommerce:{remove:{products:[{id:this.getProductId(e),name:e.name,category:this.getProductCategory(e),quantity:n}]}}})}},e.prototype.onCompletedTransaction=function(t){var e=this,n=t.transaction;if(n&&n.orderId){var r=n.lineItems.filter(function(t){var n=t.product;return e.getProductId(n)||n.name}).map(function(t){var n=t.product,r=t.quantity||1;return e.getProduct(n,r)}),i={actionField:{id:n.orderId,goal_id:this.getOption("purchaseGoalId")},products:r};if(n.vouchers&&n.vouchers.length){var o=n.vouchers[0];i.actionField.coupon=o}n.total?i.actionField.revenue=n.total:n.subtotal&&(i.actionField.revenue=n.subtotal),this.dataLayer.push({ecommerce:{purchase:i}})}},e.prototype.trackCustomEvent=function(t){var e=this.getOption("goals"),n=e[t.name];if(n){var r=(0,l.default)(this.getVisitParams(t)),i=[n];(0,m.default)(r)&&i.push(r),this.yaCounterCall("reachGoal",i)}},e}(b.default);n.default=P},{"../Integration":143,"../IntegrationUtils":144,"../events/semanticEvents":158,"@segmentstream/utils/arrayMerge":2,"@segmentstream/utils/cleanObject":3,"@segmentstream/utils/deleteProperty":5,"@segmentstream/utils/dotProp":7,"@segmentstream/utils/eventListener":9,"@segmentstream/utils/size":36,"js-cookie":102}],215:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function t(e){r(this,t),this.isLoadedDelegate=e,this.asyncQueue=[]}return t.prototype.init=function(){var t=this,e=0,n=setInterval(function(){e+=1,t.isLoadedDelegate()?(t.flushQueue(),clearInterval(n)):e>20&&clearInterval(n)},200)},t.prototype.flushQueue=function(){for(var t=this.asyncQueue.shift();t&&"function"==typeof t;)t(),t=this.asyncQueue.shift();this.asyncQueue.push=function(t){t()}},t.prototype.push=function(t){this.isLoadedDelegate()?t():this.asyncQueue.push(t)},t}();n.default=i},{}],216:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=t.source||"";if(!r||r.toLowerCase()!==e.toLowerCase()){if(!n||0===n.length)return!0;var i=(t.medium||"").toLowerCase();if(n=n.map(p.default),n.indexOf(i)>=0)return!0}return!1}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:90,r=arguments[3];window.self===window.top&&(r||(r=(0,g.default)(window.location.href)),d.default.set(t,e,{expires:n,domain:r}))}function a(t,e){e||(e=(0,g.default)(window.location.href)),d.default.remove(t,{domain:e})}function s(t){return d.default.get(t)}function c(t){t.deduplication&&(t.utmSource&&(t.utmSource=(0,p.default)(t.utmSource)),t.deduplicationUtmMedium&&(t.deduplicationUtmMedium=t.deduplicationUtmMedium.map(p.default)))}n.__esModule=!0,n.isDeduplication=i,n.addAffiliateCookie=o,n.removeAffiliateCookie=a,n.getAffiliateCookie=s,n.normalizeOptions=c;var u=t("js-cookie"),d=r(u),l=t("@segmentstream/utils/normalizeString"),p=r(l),f=t("@segmentstream/utils/topDomain"),g=r(f)},{"@segmentstream/utils/normalizeString":30,"@segmentstream/utils/topDomain":37,"js-cookie":102}],217:[function(t,e,n){"use strict";function r(t){var e=t.userAgent||"",n=e.indexOf("OS"),r=/(iPad|iPhone|iPod)/g.test(e),i=r&&window.Number(e.substr(n+3,3).replace("_","."));return"function"==typeof t.sendBeacon&&12!==i}n.__esModule=!0,n.isBeaconSupported=r},{}],218:[function(t,e,n){"use strict";function r(t){function e(t,e){if(!t)return"";for(var o="",a=0;a<t.length;a+=1){var s=t[a]===t[a].toUpperCase(),c=t[a].toLowerCase();if(" "===c&&e)o+=e;else{var u=void 0;u="uk"===n&&"Ð³"===c&&a>0&&"Ð·"===t[a-1].toLowerCase()?"gh":0===a?r[c]:i[c],o+=void 0===u?s?c.toUpperCase():c:s?u.toUpperCase():u}}return o}var n=t?t.preset:"ru",r={"Ð°":"a","Ð±":"b","Ð²":"v","Ò":"g","Ð³":"g","Ð´":"d","Ðµ":"e","Ñ":"e","Ñ":"ye","Ð¶":"zh","Ð·":"z","Ð¸":"i","Ñ":"i","Ñ":"yi","Ð¹":"i","Ðº":"k","Ð»":"l","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"p","Ñ":"r","Ñ":"s","Ñ":"t","Ñ":"u","Ñ":"f","Ñ":"h","Ñ":"c","Ñ":"ch","Ñ":"sh","Ñ":"sh'","Ñ":"","Ñ":"i","Ñ":"","Ñ":"e","Ñ":"yu","Ñ":"ya"};"uk"===n&&Object.assign(r,{"Ð³":"h","Ð¸":"y","Ð¹":"y","Ñ":"kh","Ñ":"ts","Ñ":"shch","'":"","â":"","Ê¼":""});var i=Object.assign({},r);return"uk"===n&&Object.assign(i,{"Ñ":"ie","Ñ":"i","Ð¹":"i","Ñ":"iu","Ñ":"ia"}),{transform:e}}n.__esModule=!0,n.default=r},{}],219:[function(t,e,n){"use strict";t("core-js/fn/array/find"),t("core-js/fn/array/fill"),t("core-js/fn/object/assign"),t("core-js/fn/string/ends-with"),t("promise-polyfill/dist/polyfill"),t("whatwg-fetch")},{"core-js/fn/array/fill":44,"core-js/fn/array/find":45,"core-js/fn/object/assign":46,"core-js/fn/string/ends-with":47,"promise-polyfill/dist/polyfill":128,"whatwg-fetch":134}],220:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=t("@segmentstream/utils/safeConsole"),o=t("../Handler"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e,n,i,o,a,s){r(this,t),this.name=e,this.event=n,this.handler=i,this.fireOnce=o||!1,this.digitalData=s,this.hasFired=!1,this.runAfterPageLoaded=a||!1}return t.prototype.newHandler=function(t){return new a.default(this.handler,this.digitalData,t)},t.prototype.run=function(t){if(!this.fireOnce||!this.hasFired){var e=void 0;t||this.event?t.name===this.event&&(e=this.newHandler([t])):e=this.newHandler();try{e.run(),this.hasFired=!0}catch(t){t.message='DDManager Custom Script "'+this.name+'" Error\n\n '+t.message,(0,i.error)(t)}}},t}();n.default=s},{"../Handler":142,"@segmentstream/utils/safeConsole":33}],221:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=t("@segmentstream/utils/eventListener"),o=t("./CustomScript"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s={},c=function(){function t(e,n){r(this,t),this.digitalData=e,this.pageLoadTimeout=n}return t.prototype.import=function(t){var e=this;t=t||[],t.sort(function(t,e){var n=t.priority||0,r=e.priority||0;return t.event||(n+=1),e.event||(r+=1),n===r?0:n<r?1:-1}),t.forEach(function(t){var n=t.event,r=t.fireOnce;n||(n="Viewed Page",r=!0);var i=new a.default(t.name,n,t.handler,r,t.runAfterPageLoaded,e.digitalData);e.prepareCollection(n).push(i)})},t.prototype.prepareCollection=function(t){return s[t]||(s[t]=[]),s[t]},t.prototype.run=function(t){var e=this;if(!t.stopPropagation){(s[t.name]||[]).forEach(function(n){var r="complete"===window.document.readyState;if(n.runAfterPageLoaded&&!r){var o=setTimeout(function(){n.run(t)},e.pageLoadTimeout||3e3);(0,i.bind)(window,"load",function(){clearTimeout(o),n.run(t)})}else n.run(t)})}},t.prototype.reset=function(){s={}},t}();n.default=c},{"./CustomScript":220,"@segmentstream/utils/eventListener":9}],222:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){return"1"===window.localStorage.getItem("_segmentstream_test_mode")||"1"===window.localStorage.getItem("_ddm_test_mode")}function o(){window.localStorage.removeItem("_segmentstream_test_mode"),window.localStorage.removeItem("_ddm_test_mode")}function a(t){return Array.isArray(t)?t[0]&&"object"===f(t[0])?"[Array of Objects]":JSON.stringify(t):"object"===(void 0===t?"undefined":f(t))?"[Object]":"string"==typeof t?'"'+t+'"':t}function s(){var t=window.SEGMENTSTREAM_ASSETS_URL||"https://cdn.segmentstream.com/assets",e=(0,y.default)({id:"segmentstream-test-mode-button",src:t+"/test-mode-button.html",height:"0",width:"0"}),n=(0,E.default)({rel:"stylesheet",type:"text/css",href:t+"/test-mode-button.css"});window.addEventListener("message",function(t){"disable test mode"===t.data&&(o(),setTimeout(function(){e.remove(),n.remove()},2e3))})}function c(){(0,g.log)("%c SegmentStream: Test Mode","color: blue; font-size: 18px")}function u(t,e){e.forEach(function(t){var e=t[0],n=t[1],r=t[2],i=t[3];i===m.TYPE_SUCCESS?(0,g.log)("%c["+i+"] "+e+": "+a(r),"color: "+w[i]+";"):(0,g.log)("%c["+i+"] "+e+" "+n+": "+a(r),"color: "+w[i]+";")})}function d(t,e,n,r,i){i&&n?(0,g.group)("[EVENT] "+t.name+" -> "+e):i?(0,g.group)("[EVENT] "+t.name+" x> "+e+" (not valid)"):(0,g.group)("[EVENT] "+t.name+" x> "+e+" (not initialized)"),r&&r.length&&u(t,r,e),(0,g.groupEnd)()}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.__esModule=!0;var p,f="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return void 0===t?"undefined":l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":l(t)};n.isTestMode=i,n.disableTestMode=o,n.prepareValueForLog=a,n.showTestModeBadge=s,n.showTestModeMessage=c,n.logValidationResult=u,n.logEnrichedIntegrationEvent=d;var g=t("@segmentstream/utils/safeConsole"),m=t("./EventValidator"),h=t("@segmentstream/utils/loadIframe"),y=r(h),v=t("@segmentstream/utils/loadLink"),E=r(v),w=(p={},p[m.TYPE_ERROR]="red",p[m.TYPE_WARNING]="#ee9a00",p[m.TYPE_SUCCESS]="green",p);n.default={isTestMode:i,showTestModeMessage:c}},{"./EventValidator":141,"@segmentstream/utils/loadIframe":24,"@segmentstream/utils/loadLink":25,"@segmentstream/utils/safeConsole":33}],223:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=t("./trackLink");Object.defineProperty(n,"trackLink",{enumerable:!0,get:function(){return r(i).default}});var o=t("./trackImpression");Object.defineProperty(n,"trackImpression",{enumerable:!0,get:function(){return r(o).default}})},{"./trackImpression":226,"./trackLink":227}],224:[function(t,e,n){"use strict";n.__esModule=!0,n.default=["blur","focus","focusin","focusout","load","resize","scroll","unload","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","error","touchstart","touchmove","touchend"]},{}],225:[function(t,e,n){"use strict";function r(t,e){return function(){try{e(t)}catch(t){}}}function i(t,e){if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `segmentstream.trackChange`.");if(window.jQuery)window.jQuery(window.document).on("change",t,function(t){return e(t.target)});else{var n=[];(0,o.bind)(window.document,"change",function(){n.forEach(function(t){var e=t[0],n=t[1];(0,o.unbind)(e,"change",n)});var i=(0,s.default)(t);n=[],i.forEach(function(t){var i=r(t,e);(0,o.bind)(t,"change",i),n.push([t,i])})},!0)}}}n.__esModule=!0,n.default=i;var o=t("@segmentstream/utils/eventListener"),a=t("@segmentstream/utils/domQuery"),s=function(t){return t&&t.__esModule?t:{default:t}}(a)},{"@segmentstream/utils/domQuery":6,"@segmentstream/utils/eventListener":9}],226:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){var e=window.document.documentElement,n=t.clientWidth,r=t.clientHeight,i=t.getBoundingClientRect().top,o=i+r,a=t.getBoundingClientRect().left,s=a+n;if(!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)||!(Number((0,d.default)(t,"opacity"))>0)||"hidden"===(0,d.default)(t,"visibility"))return!1;var c=o-r/4<=e.clientHeight&&i+r/4>=0,u=a+n/4>=0&&s-n/4<=e.clientWidth;if(!c||!u)return!1;for(var l=document.elementFromPoint(a+n/2,i+r/2);l&&l!==t&&l.parentNode!==document;)l=l.parentNode;return!!l&&l===t}function a(){m.update(),m.getAll().forEach(function(t){var e=[];if(t.blocks.forEach(function(n){o(n)&&!t.isViewedBlock(n)&&(e.push(n),t.addViewedBlock(n))}),e.length>0)try{t.handler(e)}catch(t){}})}function s(){a(),setInterval(function(){a()},500)}function c(t,e){if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `ddManager.trackImpression`.");m.add(t,e),h||(h=!0,s())}}n.__esModule=!0,n.default=c;var u=t("@segmentstream/utils/getStyle"),d=r(u),l=t("@segmentstream/utils/domQuery"),p=r(l),f=function(){function t(e){i(this,t),this.blocks=[],this.viewedBlocks=[],this.handler=e}return t.prototype.addViewedBlock=function(t){this.viewedBlocks.push(t)},t.prototype.isViewedBlock=function(t){return!(this.viewedBlocks.indexOf(t)<0)},t.prototype.setBlocks=function(t){this.blocks=t},t}(),g=function(){function t(){i(this,t),this.selectors=[],this.batches={}}return t.prototype.add=function(t,e){this.selectors.indexOf(t)<0&&(this.selectors.push(t),this.batches[t]=[]);var n=new f(e);this.batches[t].push(n)},t.prototype.update=function(){var t=this;this.selectors.forEach(function(e){var n=t.batches[e],r=window.jQuery?window.jQuery(e).get():(0,p.default)(e);n.forEach(function(t){t.setBlocks(r)})})},t.prototype.getAll=function(){var t=this,e=[];return this.selectors.forEach(function(n){var r=t.batches[n];e=[].concat(e,r)}),e},t}(),m=new g,h=!1},{"@segmentstream/utils/domQuery":6,"@segmentstream/utils/getStyle":13}],227:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(0!==t.detail){var i="A"===e.tagName&&(e.getAttribute("href")||e.getAttributeNS("http://www.w3.org/1999/xlink","href")||e.getAttribute("xlink:href"));try{n(e)}catch(t){}r&&i&&"_blank"!==e.target&&!(0,u.default)(t)&&!t.defaultPrevented&&!1!==t.returnValue&&((0,l.default)(t),setTimeout(function(){window.location.href=i},500))}}function o(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(r){i(r,t,e,n)}}function a(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `ddManager.trackLink`.");var r=[];(0,s.bind)(window.document,"click",function(){r.forEach(function(t){var e=t[0],n=t[1];(0,s.unbind)(e,"click",n)});var i=window.jQuery?window.jQuery(t).get():(0,f.default)(t);r=[],i.forEach(function(t){var i=o(t,e,n);(0,s.bind)(t,"click",i),r.push([t,i])})},!0)}}n.__esModule=!0,n.default=a;var s=t("@segmentstream/utils/eventListener"),c=t("@segmentstream/utils/isMeta"),u=r(c),d=t("@segmentstream/utils/preventDefault"),l=r(d),p=t("@segmentstream/utils/domQuery"),f=r(p)},{"@segmentstream/utils/domQuery":6,"@segmentstream/utils/eventListener":9,"@segmentstream/utils/isMeta":21,"@segmentstream/utils/preventDefault":31}],228:[function(t,e,n){"use strict";n.__esModule=!0,n.reset=void 0;var r=t("@segmentstream/utils/eventListener"),i=[],o=function(){var t=document.documentElement,e=document.body;return parseInt((t.scrollTop||e.scrollTop)/((t.scrollHeight||e.scrollHeight)-t.clientHeight)*100,10)},a=function(t,e){i.push({targetScrollDepth:t,handler:e,isFired:!1})},s=function(){var t=o();i=i.map(function(e){return!e.isFired&&e.targetScrollDepth<=t?(e.handler(e.targetScrollDepth),Object.assign({},e,{isFired:!0})):e})};(0,r.bind)(window,"scroll",s,!1);n.reset=function(){i=i.map(function(t){return Object.assign({},t,{isFired:!1})})};n.default=function(t,e){if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `ddManager.trackScroll`.");String(t).replace(/\s+/gm,"").split(",").forEach(function(t){var n=parseInt(t);n>0&&n<=100&&a(n,e)})}}},{"@segmentstream/utils/eventListener":9}],229:[function(t,e,n){"use strict";n.__esModule=!0,n.reset=void 0;var r=t("@segmentstream/utils/eventListener"),i=t("./listenEvents"),o=function(t){return t&&t.__esModule?t:{default:t}}(i),a=null,s=0,c=0,u=!1,d=[],l=!0,p=function(){o.default.forEach(function(t){(0,r.bind)(window.document,t,m,!1)})},f=function(){o.default.forEach(function(t){(0,r.unbind)(window.document,t,m,!1)})},g=function(){u&&(s+=10,u=!1),c+=10,d=d.map(function(t){var e=t.isActiveTime?s:c;return!t.isFired&&t.seconds<=e?(t.handler(e),Object.assign({},t,{isFired:!0})):t})},m=function(){u=!0},h=function(t,e,n){d.push({seconds:t,handler:e,isActiveTime:n,isFired:!1})},y=function(){a=setInterval(g,1e4),p()},v=function(){clearInterval(a),f()};y();n.reset=function(){l||(a&&v(),s=0,c=0,u=!1,d=d.map(function(t){return Object.assign({},t,{isFired:!1})}),y()),l=!1};n.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `ddManager.trackTimeOnPage`.");String(t).replace(/\s+/gm,"").split(",").forEach(function(t){var r=parseInt(t);r>0&&h(r,e,n)})}}},{"./listenEvents":224,"@segmentstream/utils/eventListener":9}],230:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0,n.reset=void 0;var i=t("@segmentstream/utils/eventListener"),o=t("./listenEvents"),a=r(o),s=t("../Storage"),c=r(s),u=null,d=!1,l=[],p=new c.default({prefix:"timeOnSite:"}),f=p.get("activeTime")||0,g=p.get("time")||0,m=p.get("firedEvents"),h=m?JSON.parse(m):[],y=function(){a.default.forEach(function(t){(0,i.bind)(window.document,t,I,!1)})},v=function(){a.default.forEach(function(t){(0,i.unbind)(window.document,t,I,!1)})},E=function(){f+=10,p.set("activeTime",f)},w=function(){g+=10,p.set("time",g)},_=function(t){h.push(t),p.set("firedEvents",JSON.stringify(h))},b=function(){d&&(E(),d=!1),w(),l.forEach(function(t){var e=t.isActiveTime?f:g;!h.includes(t.name+":"+t.seconds)&&t.seconds<=e&&(t.handler(e),_(t.name+":"+t.seconds))})},I=function(){d=!0},P=function(t,e,n,r){l.push({seconds:t,handler:e,isActiveTime:r,name:n})},T=function(){u=setInterval(b,1e4),y()},D=function(){clearInterval(u),v()};T();n.reset=function(){u&&D(),f=0,g=0,d=!1,h=[],p.remove("activeTime"),p.remove("time"),p.remove("firedEvents"),T()};n.default=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t){if("function"!=typeof e)throw new TypeError("Must pass function handler to `ddManager.trackTimeOnSite`.");String(t).replace(/\s+/gm,"").split(",").forEach(function(t){var i=parseInt(t);i>0&&P(i,e,n,r)})}}},{"../Storage":147,"./listenEvents":224,"@segmentstream/utils/eventListener":9}],231:[function(t,e,n){"use strict";n.__esModule=!0;n.CONSTANT_VAR="constant",n.DIGITALDATA_VAR="digitalData",n.EVENT_VAR="event",n.PRODUCT_VAR="product"},{}]},{},[160])}();window.segmentstream=window.ddManager||window.segmentstream,window.segmentstream.initialize({version:"1.2.9",buildNumber:1680624038404,projectId:"f72a2e9d-633c-4ab0-9cff-2c32b4d5cad6",projectName:"sbermegamarket.ru",domain:"sbermegamarket.ru",cookieConsent:"none",sessionLength:1800,trackJsErrors:!1,prioritiesTest:!0,pageLoadTimeout:8e3,useCookieStorage:!1,combineSdkAndInit:!0,prioritiesTestVar:"custom.prioritiesTestGroup",sendViewedPageEvent:!1,trackValidationErrors:!1,unpersistContextCampaignOnTransaction:!0,enrichments:[{prop:"user.lastAuthType",event:"Logged In",beforeEvent:!0,handler:function(e){return this.get(e,"action")},persist:!0},{prop:"custom.isSearchRelated",event:"Viewed Page",beforeEvent:!0,handler:function(e){var t=this,i=t.digitalData("page.type"),a=t.digitalData("page.category");t.digitalData("page.referrer");return"listing"!==i&&"Category Navigation"!==a?"product"!==i?"search"===i&&t.digitalData("listing.query")||!1:t.digitalData("custom.isSearchRelated")?void 0:t.digitalData("product.query")||!1:t.digitalData("custom.isSearchRelated")?void 0:t.digitalData("listing.query")||!1},persist:!0,persistTtl:86400,dependencies:["page.type","page.category","page.referrer","listing.query","product.query"]},{prop:"custom.isSearchRelated",event:"Clicked Menu Category",beforeEvent:!0,handler:function(e){return!1},persist:!0,persistTtl:86400},{prop:"custom.pageViews",event:"Viewed Page",beforeEvent:!0,handler:function(e){return this.digitalData("custom.pageViews")+1||1},persist:!0,persistTtl:1800},{prop:"custom.isSearchRelated",event:"Session Started",beforeEvent:!0,handler:function(e){return!1},persist:!0,persistTtl:86400},{prop:"custom.webView.isPochtaApp",event:"Viewed Page",beforeEvent:!0,handler:function(e){if(-1<document.cookie.indexOf("b9d55166-4c73-4ccc-b7c9-174de48ca57d")||"b9d55166-4c73-4ccc-b7c9-174de48ca57d"===this.cookie("wl"))return!0},persist:!0,persistTtl:864e3},{prop:"listing.filters",event:"Viewed Page",beforeEvent:!0,handler:function(e){return this.digitalData("filters")},dependencies:["filters"]},{prop:"custom.sessionId",event:"Viewed Page",beforeEvent:!0,handler:function(e){var i=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(i+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===e?t:3&t|8).toString(16)})}},{prop:"custom.updatedCart",event:"Updated Cart",beforeEvent:!0,handler:function(e){return this.get(e,"cart")}},{prop:"custom.completedTransactions",event:"Completed Transaction",beforeEvent:!0,handler:function(e){return this.digitalData("custom.completedTransactions")?this.digitalData("custom.completedTransactions")+1:1},persist:!0,dependencies:["custom.orderIndex"]},{prop:"custom.userAppliedVoucher_go",event:"Viewed Page",beforeEvent:!0,handler:function(e){if(!this.digitalData("custom.userAppliedVoucher_go"))return!1},persist:!0},{prop:"custom.userAppliedVoucher_go",event:"Completed Transaction",beforeEvent:!1,handler:function(e){var t=this.digitalData("transaction.vouchers")||"";if(t&&t[0]&&"go"===t[0].toLowerCase())return!0},persist:!0,dependencies:["transaction.vouchers"]},{prop:"custom.searchRelatedArray",event:"Viewed Page",beforeEvent:!0,handler:function(e){var t=this;if("confirmation"!==t.digitalData("page.type")&&"cart"!==t.digitalData("page.type")&&"checkout"!==t.digitalData("page.type")){var i=t.digitalData("custom.searchRelatedArray")||[],a=t.digitalData("cart.lineItems").map(function(e){return e.product.skuCode}),i=i.filter(function(e){return-1<a.indexOf(Object.keys(e)[0])});return i=1e3<encodeURI(JSON.stringify(i)).length?i.slice(i.length-10):i}},persist:!0,dependencies:["page.type","cart.lineItems"]},{prop:"custom.retailRocketLoaded",event:"Viewed Page",beforeEvent:!0,handler:function(e){return!!window.performance.getEntriesByName("https://cdn.retailrocket.ru/content/javascript/tracking.js").length},dependencies:["page.type"]},{prop:"user.isSubscribed",event:"Viewed Page",beforeEvent:!0,handler:function(e){if(!0===this.digitalData("user.isLoggedIn"))return!0},dependencies:["user.isLoggedIn"]},{prop:"user.hasAccount",event:"Viewed Page",beforeEvent:!1,handler:function(e){return this.digitalData("hasAccount")||this.digitalData("user.hasAccount")||0},persist:!0,dependencies:["hasAccount"]},{prop:"custom.searchRelatedArray",event:"Added Product",beforeEvent:!0,handler:function(e){var t=this.digitalData("custom.searchRelatedArray")||[],i=this.get(e,"product.skuCode");return this.digitalData("custom.isSearchRelated")&&((e={})[i]=this.digitalData("custom.isSearchRelated"),(t=1e3<encodeURI(JSON.stringify(t)).length?t.slice(t.length-9):t).push(e)),t},persist:!0,dependencies:["custom.isSearchRelated"]},{prop:"user.segment.bidStrategy",event:"Viewed Page",beforeEvent:!0,handler:function(e){return.042<=this.digitalData("custom.ecomscore")?"Up":"Default"},dependencies:["custom.ecomscore"]},{prop:"custom.prioritiesTestGroup",event:"Viewed Page",beforeEvent:!0,handler:function(e){return void 0!==this.digitalData("custom.prioritiesTestGroup")?this.digitalData("custom.prioritiesTestGroup"):Math.round(Math.random())},persist:!0},{prop:"user.hasAccount",event:"Logged In",beforeEvent:!1,handler:function(e){return"1"},persist:!0},{prop:"user.analytics_session_id",event:"Viewed Page",beforeEvent:!0,handler:function(e){return this.cookie("analytics_session_id")},persist:!0},{prop:"cart.shippingMethod",event:"Selected Pickup Point",beforeEvent:!1,handler:function(e){return"PICKUP"}},{prop:"custom.listing_veiwedcnc_count",event:"Viewed CNC Product",beforeEvent:!0,handler:function(e){return this.digitalData("custom.listing_veiwedcnc_count")?this.digitalData("custom.listing_veiwedcnc_count")+1:1},persist:!0},{prop:"custom.webView.isGoodsApp",event:"Viewed Page",beforeEvent:!0,handler:function(e){if("mobileApp"===this.queryParam("layout"))return!0},persist:!0,persistTtl:864e3},{prop:"cart.shippingMethod",event:"Manually Filled Delivery Info",beforeEvent:!1,handler:function(e){return"COURIER"}},{prop:"custom.listing_veiwedcnc_count",event:"Session Started",beforeEvent:!1,handler:function(e){return 0},persist:!0},{prop:"custom.isSearchRelated",event:"Clicked Product",beforeEvent:!0,handler:function(e){if("RetailRocket"===this.get(e,"source"))return!1},persist:!0,persistTtl:86400},{prop:"custom.flocktorySegment",event:"Viewed Page",beforeEvent:!1,handler:function(e){return this.digitalData("custom.flocktorySegment")||this.cookie("dd_custom.flocktorySegment")||Math.floor(2*Math.random())+1},persist:!0,persistTtl:789e4},{prop:"custom.exponeaViewedPages",event:"Viewed Page",beforeEvent:!0,handler:function(e){return this.digitalData("custom.exponeaViewedPages")?this.digitalData("custom.exponeaViewedPages")+1:1},persist:!0,persistTtl:43200},{prop:"custom.previousUrls",event:"Viewed Page",beforeEvent:!0,handler:function(e){var t=this.cookie("dd_custom.previousUrls");if(t)try{i=JSON.parse(t)}catch(e){}var i=this.digitalData("custom.previousUrls")||i||[];return i.push(this.digitalData("page.url")),2<i.length&&i.shift(),i},persistTtl:3600,dependencies:["page.url"]},{prop:"custom.previousUrl",event:"Viewed Page",beforeEvent:!0,handler:function(e){var t=this.digitalData("custom.previousUrls")||[];if(1<t.length)return t[0]},dependencies:["custom.previousUrls"]}],events:[{name:"15 Seconds Spent On Site",trigger:"activeTimeOnSite",handler:function(e){return{category:"Timing",name:"15 Seconds Spent On Site",nonInteraction:!0}},seconds:"15"},{name:"Clicked PLP To Up Button",trigger:"click",handler:function(e){return{name:"Clicked PLP To Up Button",category:"Behaviour",action:"Clicked PLP To Up Button"}},selector:".to-top-button.to-up-button",followLink:!0},{name:"Clicked PLP To Down Button",trigger:"click",handler:function(e){return{name:"Clicked PLP To Down Button",category:"Behaviour",action:"Clicked PLP To Down Button"}},selector:".to-top-button.to-down-button",followLink:!0},{name:"Clicked To Subscription To SberPrime",trigger:"click",handler:function(e){if(-1<e.innerText.indexOf("ÐÑÐ¾ÑÐ¼Ð¸ÑÑ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÑ"))return{name:"Clicked To Subscription To SberPrime",category:"OtherEvents",action:"ÐÐ»Ð¸Ðº Ð¾ÑÐ¾ÑÐ¼Ð¸ÑÑ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÑ Ð½Ð° Ð¡Ð±ÐµÑÐÑÐ°Ð¹Ð¼",label:this.digitalData("page.path")}},selector:".prime-plus__link",followLink:!0},{name:"Logged In - Custom",trigger:"event",handler:function(e){return{category:"Authorization",action:"Success",label:this.get(e,"action"),user:this.get(e,"user"),name:"Logged In - Custom"}},event:"Logged In"},{name:"Clicked Show More Button",trigger:"click",handler:function(e){return{name:"Clicked Show More Button",category:"OtherEvents",action:"ÐÐ¾ÐºÐ°Ð·Ð°ÑÑ ÐµÑÐµ",label:this.digitalData("page.path")}},selector:".show-more",followLink:!1},{name:"Viewed Favorite Products Page",trigger:"event",handler:function(e){if("Favorite Products"===this.digitalData("page.category"))return{name:"Viewed Favorite Products Page",category:"OtherEvents",action:"Viewed Favorite Products Page",label:this.digitalData("wishlist").length||""}},event:"Viewed Page"},{name:"30 Seconds Spent On Site",trigger:"timeOnSite",handler:function(e){return{category:"Timing",name:"30 Seconds Spent On Site",nonInteraction:!0}},seconds:"30"},{name:"Registered - Custom",trigger:"event",handler:function(e){return{category:"Registration",action:"Success-AutoReg",label:this.get(e,"action"),user:this.get(e,"user"),name:"Registered - Custom"}},event:"Registered"},{name:"Supermarket Selected Delivery Address",trigger:"click",handler:function(e){return{category:"Supermarket",action:"Click",label:this.digitalData("page.path"),name:"Supermarket Selected Delivery Address"}},selector:".analytics_supermarket_select_delivery_adress",followLink:!0},{name:"Supermarket Selected Delivery Store",trigger:"click",handler:function(e){return{name:"Supermarket Selected Delivery Store",category:"Supermarket",action:"Click",label:this.digitalData("page.path")}},selector:".analytics_supermarket_select_store",followLink:!0},{name:"Selected Store In Supermarket Page",trigger:"click",handler:function(e){return{name:"Selected Store In Supermarket Page",category:"OtherEvents",action:"Selected Store In Supermarket Page",label:this.digitalData("page.path")}},selector:".analytics_supermarket_screen_select_store",followLink:!0},{name:"Changed Pickup Point Layout",trigger:"click",handler:function(e){var t=e.className||"",e=e.innerText||"";return t.indexOf("current_0")<0&&"ÐÐ°ÑÑÐ°"===e?{category:"Click",name:"Changed Pickup Point Layout",label:"Map"}:t.indexOf("current_0")<0&&"Ð¡Ð¿Ð¸ÑÐ¾Ðº"===e?{category:"Click",name:"Changed Pickup Point Layout",label:"List"}:void 0},selector:".PickupPointSelector__ViewSwitch__item_0:first-child, .PickupPointSelector__ViewSwitch__item_0:last-child",followLink:!1},{name:"Closed BPG Popup",trigger:"click",handler:function(e){if("product"===this.digitalData("page.type"))return{category:"OtherEvents",name:"Closed BPG Popup",action:"ÐÐÐ¦ Popup closed",label:this.digitalData("page.path")}},selector:".popover__btn-close",followLink:!1},{name:"Clicked Buy Tab",trigger:"click",handler:function(e){if("product"===this.digitalData("page.type"))return{category:"OtherEvents",name:"Clicked Buy Tab",action:"Tab_Click ÐÑÐ¿Ð¸ÑÑ",label:this.digitalData("page.path")}},selector:".l-button",followLink:!1},{name:"Clicked Sellers Offers",trigger:"click",handler:function(e){if("pdp-offers"===(e.getAttribute("id")||""))return{category:"OtherEvents",name:"Clicked Sellers Offers",action:"ÐÑÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿ÑÐ¾Ð´Ð°Ð²ÑÐ¾Ð²",label:this.digitalData("page.path")}},selector:".btn-main",followLink:!1},{name:"Clicked Prices Tab",trigger:"click",handler:function(e){e=e.innerText||"";if(-1<e.indexOf("Ð¦ÐµÐ½Ñ")||-1<e.indexOf("ÑÐµÐ½Ñ"))return{category:"OtherEvents",name:"Clicked Prices Tab",action:"Tab_Click Ð¦ÐµÐ½Ñ",label:this.digitalData("page.path")}},selector:".components_PdpContentNav__item_0, .h1",followLink:!1},{name:"Clicked All Reviews Button",trigger:"click",handler:function(e){if(-1<(e.innerText||"").indexOf("ÐÑÐµ Ð¾ÑÐ·ÑÐ²Ñ"))return{category:"ÐÐµÑÐµÑÐ¾Ð´ Ð½Ð° Ð´ÐµÑÐ°Ð»ÑÐ½ÑÑ PDP",name:"Clicked All Reviews Button",action:"ÐÑÐµ Ð¾ÑÐ·ÑÐ²Ñ",label:this.digitalData("page.path")}},selector:".btn",followLink:!0},{name:"Subscribed",trigger:"event",handler:function(e){return{category:"Subscription",name:"Subscribed",user:this.digitalData("user")}},event:"Registered"},{name:"Clicked Search All Category Navigation Button",trigger:"click",handler:function(e){return{category:"Search",action:"Click",name:"Clicked Search All Category Navigation Button"}},selector:".analytics_search_all_category_nav_button",followLink:!0},{name:"Clicked Specs Tab",trigger:"click",handler:function(e){e=e.innerText||"";if(-1<e.indexOf("Ð¥Ð°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸")||-1<e.indexOf("ÑÐ°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸"))return{category:"OtherEvents",name:"Clicked Specs Tab",action:"Tab_Click Ð¥Ð°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸",label:this.digitalData("page.path")}},selector:".components_PdpContentNav__item_0, .h1",followLink:!0},{name:"RR - Subscribed While Logging In",trigger:"event",handler:function(e){return{name:"RRSubscribed",user:this.digitalData("user"),includeIntegrations:["Retail Rocket"]}},event:"Logged In"},{name:"Clicked Reviews Tab",trigger:"click",handler:function(e){e=e.innerText||"";if(-1<e.indexOf("ÐÑÐ·ÑÐ²Ñ")||-1<e.indexOf("Ð¾ÑÐ·ÑÐ²Ñ"))return{category:"OtherEvents",name:"Clicked Reviews Tab",action:"Tab_Click ÐÑÐ·ÑÐ²Ñ",label:this.digitalData("page.path")}},selector:".components_PdpContentNav__item_0, .h1",followLink:!0},{name:"Clicked All Specs Button",trigger:"click",handler:function(e){if(-1<(e.innerText||"").indexOf("ÐÑÐµ ÑÐ°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸"))return{category:"ÐÐµÑÐµÑÐ¾Ð´ Ð½Ð° Ð´ÐµÑÐ°Ð»ÑÐ½ÑÑ PDP",name:"Clicked All Specs Button",action:"ÐÑÐµ ÑÐ°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸",label:this.digitalData("page.path")}},selector:".btn",followLink:!0},{name:"Clicked Similar Products",trigger:"click",handler:function(e){if(0===this.digitalData("product.stock"))return{category:"ÐÐ¾ÑÐ¾Ð¶Ð¸Ðµ ÑÐ¾Ð²Ð°ÑÑ",name:"Clicked Similar Products",action:"ÐÐ»Ð¸Ðº Ð² Ð¿Ð¾ÑÐ¾Ð¶Ð¸Ðµ ÑÐ¾Ð²Ð°ÑÐ°"}},selector:".btn.btn-secondary.prod--disabled-btn , .btn.btn-secondary.btn-other-products",followLink:!0},{name:"BPG Popup Is Hidden",trigger:"impression",handler:function(e){if((element.getAttribute("class")||"").indexOf("fade in")<0)return{category:"OtherEvents",name:"BPG Popup Is Hidden",action:"ÐÐÐ¦ Popup hidden",label:this.digitalData("page.path")}},selector:".left popover--bpglist"},{name:"Clicked Search Top Category Navigation Button",trigger:"click",handler:function(e){return{category:"Search",action:"Click",label:e.innerText,name:"Clicked Search Top Category Navigation Button"}},selector:".analytics_search_top_category_nav_button",followLink:!0},{name:"Clicked Description Tab",trigger:"click",handler:function(e){e=e.innerText||"";if(-1<e.indexOf("ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ")||-1<e.indexOf("Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ"))return{category:"OtherEvents",name:"Clicked Description Tab",action:"Tab_Click ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",label:this.digitalData("page.path")}},selector:".components_PdpContentNav__item_0, .h1",followLink:!1},{name:"Viewed Product Detail",trigger:"event",handler:function(e){if("product"===this.digitalData("page.type")&&this.digitalData("product"))return{name:"Viewed Product Detail",category:"Ecommerce",cncAvailable:!!this.digitalData("product.cncAvailable")}},event:"Viewed Page"},{name:"Clicked Supermarket In Header",trigger:"click",handler:function(e){return{name:"Clicked Supermarket In Header",category:"OtherEvents",action:"Clicked Supermarket In Header",label:this.digitalData("page.path")}},selector:".headerDesktop_index__green_0",followLink:!0},{name:"RR - Subscribed While Transaction",trigger:"event",handler:function(e){return{name:"RRSubscribed",user:this.get(e,"user"),includeIntegrations:["Retail Rocket"]}},event:"Completed Transaction"},{name:"Clicked Tag",trigger:"click",handler:function(e){e=(e=e.getAttribute("onclick")||"").substring(e.indexOf("{"),e.indexOf("}")+1);return obj=JSON.parse(e),{name:"Clicked Tag",category:obj.eventCategory||"",action:obj.eventAction||"",label:obj.eventLabel||""}},selector:".cat-header--tags .btn-secondary, .section-related--links .btn-secondary",followLink:!1},{name:"Abandoned Cart",trigger:"event",handler:function(e){var t=this.digitalData("page.referrer")||"",i=this.digitalData("page.type")||"",a=this.digitalData("page.url")||"";if(-1<t.indexOf("/personal/order/make")&&"checkout"!==i&&"cart"!==i&&"confirmation"!==i)return{category:"OtherEvents",name:"Abandoned Cart",action:"ÐÑÐ¾ÑÐµÐ½Ð½Ð°Ñ ÐºÐ¾ÑÐ·Ð¸Ð½Ð°",label:a}},event:"Viewed Page"},{name:"Clicked BPG Button (Desktop)",trigger:"click",handler:function(e){if("product"===this.digitalData("page.type"))return{category:"OtherEvents",name:"Clicked BPG Button",action:"ÐÐÐ¦ 1",label:this.digitalData("page.path")}},selector:".favoritePrice__text, .favoritePrice__icon",followLink:!1},{name:"Unsubscribe",trigger:"event",handler:function(e){return{name:"Unsubscribe - Enriched",category:"OtherEvents",action:"Unsubscribe",label:this.get(e,"receiveTooManyEmails")+";"+this.get(e,"uninterestingOffers")+";"+this.get(e,"other")}},event:"Unsubscribe"},{name:"RR Absence Detected (Desktop Only)",trigger:"event",handler:function(e){if(!1===this.digitalData("custom.retailRocketLoaded")&&"desktop"===this.digitalData("website.type"))return{name:"RR Absence Detected",label:this.get(e,"transaction.orderId")}},event:"Completed Transaction"},{name:"30 Seconds Spent On Page",trigger:"timeOnPage",handler:function(e){return{category:"Timing",name:"30 Seconds Spent On Page",nonInteraction:!0}},event:"Viewed Page",seconds:"30"},{name:"Viewed Page: utm_source = yandex & utm_medium =cpm||banner",trigger:"event",handler:function(e){var t=this.digitalData("context.campaign.source")||"",i=this.digitalData("context.campaign.medium")||"";if(-1<t.indexOf("yandex")&&(-1<i.indexOf("cpm")||-1<i.indexOf("banner")))return{name:"Viewed Page: yandex cpm||banner",nonInteraction:!0}},event:"Viewed Page"},{name:"Viewed Product Reviews Page",trigger:"event",handler:function(e){if("Product Reviews"===this.digitalData("page.category"))return{name:"Viewed Product Reviews Page",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð½Ð° Ð´ÐµÑÐ°Ð»ÑÐ½ÑÑ PDP",action:"ÐÑÐµ Ð¾ÑÐ·ÑÐ²Ñ",label:this.digitalData("page.path")}},event:"Viewed Page"},{name:"Viewed Product Specifications Page",trigger:"event",handler:function(e){if("Product Specifications"===this.digitalData("page.category"))return{name:"Viewed Product Specifications Page",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð½Ð° Ð´ÐµÑÐ°Ð»ÑÐ½ÑÑ PDP",action:"ÐÑÐµ ÑÐ°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸",label:this.digitalData("page.path")}},event:"Viewed Page"},{name:"Clicked Auth Button",trigger:"click",handler:function(e){if(-1<e.innerText.indexOf("ÐÐ¾Ð¹ÑÐ¸"))return{name:"Clicked Auth Button",category:"Authorization",action:"Click",label:this.digitalData("page.path")}},selector:".btn.btn-lg.btn-block, .btn.btn-full-width",followLink:!1},{name:"Clicked Registration Button",trigger:"click",handler:function(e){if(-1<e.innerText.indexOf("ÐÐ°ÑÐµÐ³Ð¸ÑÑÑÐ¸ÑÐ¾Ð²Ð°ÑÑÑÑ"))return{name:"Clicked Registration Button",category:"Registration",action:"Click",label:this.digitalData("page.path")}},selector:".btn.btn-lg.btn-block, .btn.btn-full-width",followLink:!0},{name:"Viewed Cart",trigger:"event",handler:function(e){if("cart"===this.digitalData("page.type"))return{name:"Viewed Cart",category:"Ecommerce",cart:this.digitalData("cart")}},event:"Viewed Page"},{name:"Clicked BPG Button (Mobile)",trigger:"click",handler:function(e){if($(".bpglist__content:visible").length)return{category:"OtherEvents",name:"Clicked BPG Button",action:"ÐÐÐ¦ 1",label:this.digitalData("page.path")}},selector:".mobile-bpglist",followLink:!0},{name:"Viewed Campaign",trigger:"impression",handler:function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i].getAttribute("data-campaign-id");t.push(a)}return{name:"Viewed Campaign",category:"Promo",campaigns:t}},selector:".ddl_campaign"},{name:"Clicked Campaign",trigger:"click",handler:function(e){return{name:"Clicked Campaign",category:"Promo",campaign:e.getAttribute("data-campaign-id"),label:e.getAttribute("href")}},selector:".ddl_campaign_link",followLink:!0},{name:"Clicked Menu Category -  Mobile",trigger:"click",handler:function(e){if("mobile"===this.digitalData("website.type")){var t=[],i=e.getAttribute("data-menu-current"),a=e.getAttribute("data-menu-previous"),e=$(e).parents(".submenu-toggle").find('[data-menu-level="1"]').text();return a.length&&t.push(a),t.push(e),{category:"ÐÐ»Ð¸ÐºÐ¸ Ð² Ð¼ÐµÐ½Ñ",name:"Clicked Menu",action:t.join("-"),label:i}}},selector:".section-title.ddl_menu_link",followLink:!0},{name:"Searched Products (GA)",trigger:"event",handler:function(e){var t;if(this.digitalData("listing.query")?t=this.digitalData("listing.query"):this.digitalData("product.query")&&(t=this.digitalData("product.query")),t)return{name:"Searched Products (GA)",category:"Ecommerce",action:"Search_View",label:t,includeIntegrations:["Google Analytics"]}},event:"Viewed Page"},{name:"Searched Products",trigger:"event",handler:function(e){var t;if(this.digitalData("listing.query")?t=this.digitalData("listing.query"):this.digitalData("product.query")&&(t=this.digitalData("product.query")),t)return{name:"Searched Products",category:"Ecommerce",action:"Search_View",label:t}},event:"Viewed Page"},{name:"Completed Transaction with MyTarget Source",trigger:"event",handler:function(e){if("mytarget"===this.digitalData("context.campaign.source"))return{name:"Completed Transaction with MyTarget Source",value:this.get(e,"transaction.total")}},event:"Completed Transaction"},{name:"Clicked Leave Review LKP Button",trigger:"click",handler:function(e){if(-1<this.digitalData("page.path").indexOf("/personal/order"))return{name:"Clicked Leave Review LKP Button",category:"ReviewsAction",action:"Click_LKP",label:this.digitalData("user.userId")||""}},selector:".Order__DeliveryGood__review_0, .order-view__DeliveryGood__review_0",followLink:!1},{name:"Clicked Leave Review PDP Button",trigger:"click",handler:function(e){if("product"===this.digitalData("page.type"))return{name:"Clicked Leave Review PDP Button",category:"ReviewsAction",action:"Click_PDP"}},selector:".btn-leave-review",followLink:!1},{name:"Viewed Page: utm_source = dbm & utm_medium=cpv",trigger:"event",handler:function(e){var t=this.digitalData("context.campaign.source")||"",i=this.digitalData("context.campaign.medium")||"";if(-1<t.indexOf("dbm")&&-1<i.indexOf("cpv"))return{name:"Viewed Page: dbm cpv",nonInteraction:!0}},event:"Viewed Page"},{name:"Completed Transaction - Card Payment",trigger:"event",handler:function(e){if("CASH_ON_DELIVERY"!==this.get(e,"transaction.paymentMethod"))return{name:"Completed Transaction - Card Payment",transaction:this.get(e,"transaction")}},event:"Completed Transaction"},{name:"Viewed Checkout Step - Step 1 (Viewed Cart)",trigger:"event",handler:function(e){var t=this.digitalData("page.type")||"",i=this.digitalData("website.type")||"",a=this.digitalData("cart.lineItems")||"",n=!1,r=!1;if(a.forEach(function(e){n=n||-1<e.product.id.indexOf("CART_TYPE_CNC"),r=r||-1<e.product.id.indexOf("CART_TYPE_DEFAULT")}),"cart"===t)return{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 1",step:"1",checkoutStep:i+"|multicart|hasCncCart_"+n+"|hasOrdinaryCart_"+r+"|step_1",cart:this.digitalData("cart")}},event:"Viewed Page"},{name:"Viewed Certain Page (GA)",trigger:"event",handler:function(e){var t,i,a,n=this,r=n.digitalData("page.type"),o=n.digitalData("page.category");if("home"===r?(t="HomePage_View",i=n.digitalData("page.referrer"),a="Ecommerce"):"listing"===r?(t="PLP_View",i=n.digitalData("page.path"),a="Ecommerce"):"product"===r?(t="PDP_View",i=n.digitalData("page.path"),a="Ecommerce"):"404"===o&&(t=n.digitalData("page.path"),i=n.digitalData("page.referrer"),a="ÐÑÐ¸Ð±ÐºÐ° 404"),t)return{name:"Viewed Certain Page (GA)",category:a,action:t,label:i,nonInteraction:!0}},event:"Viewed Page"},{name:"Viewed Checkout Step - Step 2",trigger:"event",handler:function(e){var t=this,i=t.digitalData("page.type")||"",a=t.digitalData("website.type")||"",n=t.digitalData("cart.lineItems")||"",r=t.digitalData("cart.cartId")||"",o=!1,c=!1,d=window.location.href;if("checkout"===i&&(n.forEach(function(e){o=o||e.cartId===r&&-1<e.product.id.indexOf("CART_TYPE_CNC"),c=c||e.cartId!==r}),"desktop"===a||"mobile"===a&&-1<d.indexOf("#delivery")))return t.timeout(100,function(){return{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 2",step:"2",checkoutStep:a+"|hasSeveralCarts_"+c+"|cnc_"+o+"|step_2",cart:t.digitalData("cart")}})},event:"Viewed Page"},{name:"Clicked Filter Reset",trigger:"click",handler:function(e){return{name:"Clicked Filter Reset",category:"OtherEvents",action:"ÐÐ°Ð¶Ð°Ð»Ð¸ ÐÑÐ¸ÑÑÐ¸ÑÑ ÑÐ¸Ð»ÑÑÑÑ",label:this.digitalData("page.url")}},selector:".btn.btn-block.btn-secondary.btn-reset-filters",followLink:!0},{name:"Viewed Search Listing",trigger:"event",handler:function(e){if("search"===this.digitalData("page.type")){var t=!1,i=this.digitalData("listing.items");return i.length&&i.forEach(function(e){t=t||e.cncAvailable}),{name:"Viewed Search Listing",category:"Ecommerce",label:this.digitalData("listing.resultCount"),cncAvailable:t}}},event:"Viewed Page"},{name:"Clicked Menu Category - Desktop",trigger:"click",handler:function(e){var t=e.getAttribute("data-menu-current");return{category:"ÐÐ»Ð¸ÐºÐ¸ Ð² Ð¼ÐµÐ½Ñ",action:e.getAttribute("data-menu-previous")||"",label:t,name:"Clicked Menu Category"}},selector:"a[data-menu-current]",followLink:!0},{name:"Started Order",trigger:"event",handler:function(e){if("Step 1"===this.get(e,"label"))return{name:"Started Order",category:"Ecommerce",cart:this.digitalData("cart")}},event:"Viewed Checkout Step"},{name:"Viewed Daily Item",trigger:"impression",handler:function(e){return{name:"Viewed Daily Item",category:"Behavior",action:"View",label:this.digitalData("page.path")}},selector:".daily-item"},{name:"Viewed Checkout Step - Step 1 (Clicked Cart Equivalent)",trigger:"event",handler:function(e){var t=this.digitalData("page.type")||"",i=this.digitalData("website.type")||"",a=this.digitalData("cart.lineItems")||"";if("checkout"===t&&"desktop"===i){var n=this.digitalData("cart.cartId"),r=!1;if(a.forEach(function(e){r=r||e.cartId!==n}),!r){var o=!1;return a.forEach(function(e){o=o||e.cartId===n&&-1<e.product.id.indexOf("CART_TYPE_CNC")}),{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 1",step:"1",checkoutStep:"desktop|only_cart|cnc_"+o+"|step_1"}}}},event:"Viewed Page"},{name:"Scrolled Page",trigger:"scroll",handler:function(e){return{category:"ÐÐ»ÑÐ±Ð¸Ð½Ð° Ð¿ÑÐ¾ÐºÑÑÑÐºÐ¸",name:"Scrolled Page",action:this.digitalData("page.path"),label:e}},scrollDepth:"25,50,75,100"},{name:"Viewed Checkout Step - Step 4 (Desktop: Selected Saved Credit Card)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=(t.digitalData("page.type"),t.digitalData("website.type")||""),r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1;r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o});window.location.href;r=t.digitalData("cart.shippingMethod");if(!t.digitalData("cart.isPaymentMethodAutoFilled")&&"desktop"===n)return i?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_X|paymentMethod_online|step_4"}:{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_"+r+"|paymentMethod_online|step_4"}},event:"Selected Saved Credit Card"},{name:"Clicked Tag (SSR)",trigger:"click",handler:function(e){var t=e.className||"",e=e.innerText||"";return{name:"Clicked Tag",category:t,action:this.digitalData("page.path")||"",label:e}},selector:".tags-header, .tags-under-filters, .tags-in-filters, .tags-footer-compilations, .tags-footer-popular, .tags-footer-recent",followLink:!0},{name:"Viewed Checkout Step - Step 3 (Scrolled Page)",trigger:"event",handler:function(e){var t,i=this,a=!!i.digitalData("cart.isDeliveryInfoAutoFilled"),n=!!i.digitalData("cart.isPaymentMethodAutoFilled"),r=i.digitalData("page.type")||"",o=i.digitalData("website.type")||"",c=i.digitalData("cart.lineItems")||"",d=i.digitalData("cart.cartId")||"",s=!1,l=!1,u=window.location.href;if("checkout"===r&&i.digitalData("cart.isDeliveryInfoAutoFilled")&&50===i.get(e,"label"))return c.forEach(function(e){s=s||e.cartId===d&&-1<e.product.id.indexOf("CART_TYPE_CNC"),l=l||e.cartId!==d}),"desktop"===o?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step "+(t="3"),step:t,checkoutStep:o+"|hasSeveralCarts_"+l+"|cnc_"+s+"|deliveryInfoAutoFilled_"+a+"|paymentMethodAutoFilled_"+n+"|deliveryType_X|step_3"}:"mobile"===o&&-1<u.indexOf("#delivery")?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step "+(t="3"),step:t,checkoutStep:o+"|hasSeveralCarts_"+l+"|cnc_"+s+"|deliveryInfoAutoFilled_"+a+"|deliveryType_X|step_3"}:void 0},event:"Scrolled Page"},{name:"Viewed CNC Product",trigger:"event",handler:function(e){var t=this.get(e,"listItems"),i=!1,a=this.digitalData("listing.items"),n=[];if("RetailRocket"!==this.get(e,"source")&&a&&(t.forEach(function(e){var t=e.product.id;a.forEach(function(e){i=i||t===e.id&&e.cncAvailable,t===e.id&&e.cncAvailable&&n.push(e.skuCode)})}),i))return{category:"Ecommerce",name:"Viewed CNC Product",items:n}},event:"Viewed Product"},{name:"Clicked To Login By Sber Id",trigger:"click",handler:function(e){return{name:"Clicked To Login By Sber Id",category:"Auth"}},selector:".sber-id-button__icons-container",followLink:!0},{name:"Viewed Checkout Step - Step 4 (Mobile) TEMP",trigger:"impression",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=(t.digitalData("cart.isPaymentMethodAutoFilled"),t.digitalData("page.type")||""),n=t.digitalData("website.type")||"",r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1,s=window.location.href,t=t.digitalData("cart.shippingMethod");if("checkout"===a&&"mobile"===n&&-1<s.indexOf("#payment"))return r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o}),"COURIER"===t?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|deliveryType_COURIER|step_4"}:"PICKUP"===t?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|deliveryType_PICKUP|step_4"}:{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|deliveryType_X|step_4"}},selector:".mobile-checkout__payment-type-selector"},{name:"Viewed Elektroinstrumenty Category",trigger:"event",handler:function(e){if("/catalog/elektroinstrumenty/"===(this.digitalData("page.path")||""))return{name:"Viewed Elektroinstrumenty Category Page",category:"OtherEvents"}},event:"Viewed Page"},{name:"Viewed Home Page",trigger:"event",handler:function(e){if("home"===(this.digitalData("page.type")||""))return{name:"Viewed Home Page",category:"OtherEvents"}},event:"Viewed Page"},{name:"Clicked Checkout Buttons (Floodlight)",trigger:"click",handler:function(e){e=e.innerText||"";if(-1<e.indexOf("ÐÑÐ¾ÑÐ¼Ð¸ÑÑ Ð·Ð°ÐºÐ°Ð·")||-1<e.indexOf("ÐÐµÑÐµÐ¹ÑÐ¸ Ðº Ð¾ÑÐ¾ÑÐ¼Ð»ÐµÐ½Ð¸Ñ")||-1<e.indexOf("ÐÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÑ Ð¾ÑÐ¾ÑÐ¼Ð»ÐµÐ½Ð¸Ðµ"))return{name:"Clicked Checkout Buttons",category:"OtherEvents",action:"Clicked Checkout Buttons"}},selector:".btn-checkout, .checkout-slide-submit__action-text",followLink:!0},{name:"Clicked Partner Link",trigger:"click",handler:function(e){e=e.getAttribute("href");if(("/promo/virtualnaya-karta-rassrochki-halva/"===this.digitalData("page.path")||"checkout"===this.digitalData("page.type"))&&-1<e.indexOf("https://halva.express"))return{category:"External Link",name:"Clicked Partner Link",label:"Halva:partner_id=47195480-fb95-4782-beaf-400a26753181"}},selector:".button_buy, .halva",followLink:!0},{name:"Viewed Detskie Tovary Category",trigger:"event",handler:function(e){if("/catalog/detskie-tovary/"===(this.digitalData("page.path")||""))return{name:"Viewed Detskie Tovary Category Page",category:"OtherEvents",includeIntegrations:[""]}},event:"Viewed Page"},{name:"Viewed Elektronika Category",trigger:"event",handler:function(e){if("/catalog/elektronika/"===(this.digitalData("page.path")||""))return{name:"Viewed Elektronika Category Page",category:"OtherEvents"}},event:"Viewed Page"},{name:"Remove Inaccessible Item From Cart",trigger:"event",handler:function(e){return{category:"Ecommerce",name:"Remove Inaccessible Item From Cart",action:"Remove Inaccessible Item From Cart",label:this.digitalData("page.path")}},event:"Remove Inaccessible Item From Cart"},{name:"Not Enough Order Amount Popup Viewed",trigger:"event",handler:function(e){return{category:"OtherEvents",name:"Not Enough Order Amount Popup Viewed - custom",action:"Not Enough Order Amount Popup Viewed",label:this.digitalData("page.path")}},event:"Not Enough Order Amount Popup Viewed"},{name:"Clicked ToCart Button (Mobile Header Popup)",trigger:"click",handler:function(e){if("/multicart/"===e.getAttribute("href"))return{name:"Clicked ToCart Button",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð² ÐºÐ¾ÑÐ·Ð¸Ð½Ñ|ÐÐ»Ð¸Ðº",action:this.digitalData("page.type"),label:"mobile_headerPopup"}},selector:".icon.icon-arrow-right",followLink:!0},{name:"Clicked ToCart Button (Desktop + Mobile Main Icon)",trigger:"click",handler:function(e){if(-1<e.getAttribute("href").indexOf("/multicart/"))return{name:"Clicked ToCart Button",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð² ÐºÐ¾ÑÐ·Ð¸Ð½Ñ|ÐÐ»Ð¸Ðº",action:this.digitalData("page.type"),label:this.digitalData("website.type")+"_mainIcon"}},selector:".mini-cart .mini-cart__info , .mini-cart .mini-cart__mobile",followLink:!0},{name:"Clicked ToCart Button (Desktop Dropdown)",trigger:"click",handler:function(e){if(-1<e.getAttribute("href").indexOf("/multicart/"))return{name:"Clicked ToCart Button",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð² ÐºÐ¾ÑÐ·Ð¸Ð½Ñ|ÐÐ»Ð¸Ðº",action:this.digitalData("page.type"),label:"desktop_dropdown"}},selector:".dropdown-footer-action .btn",followLink:!0},{name:"Clicked ToCart Button (Desktop Header Popup)",trigger:"click",handler:function(e){if(-1<e.getAttribute("href").indexOf("/multicart/"))return{name:"Clicked ToCart Button",category:"ÐÐµÑÐµÑÐ¾Ð´ Ð² ÐºÐ¾ÑÐ·Ð¸Ð½Ñ|ÐÐ»Ð¸Ðº",action:this.digitalData("page.type"),label:"desktop_headerPopup"}},selector:".components_headerBuyingNotification__goTo_0",followLink:!0},{name:"Completed Transaction - Cash Payment",trigger:"event",handler:function(e){if("CASH_ON_DELIVERY"===this.get(e,"transaction.paymentMethod"))return{name:"Completed Transaction - Cash Payment",transaction:this.get(e,"transaction")}},event:"Completed Transaction"},{name:"Viewed Checkout Step - Step 3 (Selected Pickup Point)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=(t.digitalData("page.type"),t.digitalData("website.type")||""),r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1;r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o});window.location.href;if(!t.digitalData("cart.isDeliveryInfoAutoFilled"))return{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 3",step:"3",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_PICKUP|step_3"}},event:"Selected Pickup Point"},{name:"Viewed Checkout Step - Step 3 (Manually Filled Delivery Info)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=(t.digitalData("page.type"),t.digitalData("website.type")||""),r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1;r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o});window.location.href;if(!t.digitalData("cart.isDeliveryInfoAutoFilled"))return{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 3",step:"3",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_COURIER|step_3"}},event:"Manually Filled Delivery Info"},{name:"Viewed Checkout Step - Step 4 (Desktop: Selected Payment Method)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=(t.digitalData("page.type"),t.digitalData("website.type")||""),r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1;r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o});window.location.href;r=t.digitalData("cart.shippingMethod");if(!t.digitalData("cart.isPaymentMethodAutoFilled")&&"desktop"===n&&"cash"===t.get(e,"label"))return i?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_X|paymentMethod_cash|step_4"}:{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_"+r+"|paymentMethod_cash|step_4"}},event:"Selected Payment Method"},{name:"Viewed Checkout Step - Step 4 (Desktop: Scrolled Page)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=t.digitalData("page.type")||"",r=t.digitalData("website.type")||"",o=t.digitalData("cart.lineItems")||"",c=t.digitalData("cart.cartId")||"",d=!1,s=!1,l=(window.location.href,t.digitalData("cart.shippingMethod"));if("checkout"===n&&t.digitalData("cart.isPaymentMethodAutoFilled")&&75===t.get(e,"label")&&(o.forEach(function(e){d=d||e.cartId===c&&-1<e.product.id.indexOf("CART_TYPE_CNC"),s=s||e.cartId!==c}),"desktop"===r))return i?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:r+"|hasSeveralCarts_"+s+"|cnc_"+d+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_X|paymentMethod_X|step_4"}:{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:r+"|hasSeveralCarts_"+s+"|cnc_"+d+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_"+l+"|paymentMethod_X|step_4"}},event:"Scrolled Page"},{name:"Coupon Applied",trigger:"event",handler:function(e){return{category:"Ecommerce",name:"Coupon Applied",action:"Coupon Applied",label:this.digitalData("event.label")}},event:"Coupon Applied"},{name:"Viewed Checkout Step - Step 4 (Desktop: Started Card Info Filling)",trigger:"event",handler:function(e){var t=this,i=!!t.digitalData("cart.isDeliveryInfoAutoFilled"),a=!!t.digitalData("cart.isPaymentMethodAutoFilled"),n=(t.digitalData("page.type"),t.digitalData("website.type")||""),r=t.digitalData("cart.lineItems")||"",o=t.digitalData("cart.cartId")||"",c=!1,d=!1;r.forEach(function(e){c=c||e.cartId===o&&-1<e.product.id.indexOf("CART_TYPE_CNC"),d=d||e.cartId!==o});window.location.href;r=t.digitalData("cart.shippingMethod");if(!t.digitalData("cart.isPaymentMethodAutoFilled")&&"desktop"===n)return i?{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_X|paymentMethod_online|step_4"}:{category:"Ecommerce",name:"Viewed Checkout Step",action:"Checkout",label:"Step 4",step:"4",checkoutStep:n+"|hasSeveralCarts_"+d+"|cnc_"+c+"|deliveryInfoAutoFilled_"+i+"|paymentMethodAutoFilled_"+a+"|deliveryType_"+r+"|paymentMethod_online|step_4"}},event:"Started Card Info Filling"},{name:"Clicked Bonus Description Link",trigger:"click",handler:function(e){if(-1<this.digitalData("page.path").indexOf("/personal/loyalty/"))return{category:"Bonus Info",name:"Clicked Bonus Description Link"}},selector:".button-info",followLink:!0},{name:"Clicked Start Shopping Button",trigger:"click",handler:function(e){if(-1<this.digitalData("page.path").indexOf("/personal/loyalty/"))return{category:"Bonus Info",name:"Clicked Start Shopping Button"}},selector:".btn-bonus",followLink:!0},{name:"Viewed Bonus Info Block",trigger:"impression",handler:function(e){if(-1<this.digitalData("page.path").indexOf("/personal/loyalty/"))return{name:"Viewed Bonus Info Block",category:"Bonus Info"}},selector:".description__block"},{name:"RR - Subscribed While Registered",trigger:"event",handler:function(e){return{name:"RRSubscribed",user:this.get(e,"user"),includeIntegrations:["Retail Rocket"]}},event:"Registered"},{name:"Add More Products Clicked",trigger:"event",handler:function(e){return{name:"Add More Products Clicked",category:"OtherEvents",action:"Add More Products Clicked",label:this.digitalData("page.path")}},event:"Add More Products Clicked"},{name:"Clicked Customer Help Article (Navigation Block)",trigger:"click",handler:function(e){return{category:"Customer Help",action:"Clicked Navigation Block",label:e.innerText||"",name:"Clicked Customer Help Article"}},selector:".help-nav__link",followLink:!0},{name:"Clicked Category Block",trigger:"click",handler:function(e){var t=e.getAttribute("main_category_tile_current"),i=e.getAttribute("main_category_tile_previous"),e=e.getAttribute("main_category_tile");return{category:"ÐÐ»Ð¸ÐºÐ¸ Ð¿Ð¾ Ð¿Ð»Ð¸ÑÐºÐ°Ð¼",action:t||e||"test",label:i||"",name:"Clicked Category Block"}},selector:"a[main_category_tile]",followLink:!0},{name:"Clicked Customer Help Article (Popular Article)",trigger:"click",handler:function(e){return{category:"Customer Help",action:"Clicked Popular Article",label:e.innerText||"",name:"Clicked Customer Help Article"}},selector:".help-popular__link",followLink:!0},{name:"Clicked To Customer Help (footer)",trigger:"click",handler:function(e){return{category:"Customer Help",action:"Clicked To Help",label:"footer",name:"Clicked To Customer Help"}},selector:".help-link-place-footer",followLink:!0},{name:"Clicked To Customer Help (profile menu)",trigger:"click",handler:function(e){return{category:"Customer Help",action:"Clicked To Help",label:"profile_menu",name:"Clicked To Customer Help"}},selector:".help-link-place-profile-menu",followLink:!0},{name:"Clicked To Customer Help (checkout)",trigger:"click",handler:function(e){return{category:"Customer Help",action:"Clicked To Help",label:"checkout",name:"Clicked To Customer Help"}},selector:".help-link-place-checkout",followLink:!0},{name:"Transaction Check",trigger:"event",handler:function(e){return{excludeIntegrations:["Yandex.Metrica"],category:"Ecommerce",name:"Transaction Check",action:"Transaction_Check",label:(this.get(e,"transaction.isFirst")&&(this.digitalData("user.isLoggedIn")||1===this.digitalData("custom.completedTransactions"))?"isFirst.":"isNotFirst.")+this.get(e,"transaction.orderId")}},event:"Completed Transaction"},{name:"Clicked Product",trigger:"click",handler:function(e){var t=e.getAttribute("data-product-id"),i=e.getAttribute("data-list-id"),e=e.getAttribute("data-list-name");if(t&&""!==t)return{name:"Clicked Product",category:"Ecommerce",action:"Product_Click",label:this.digitalData("page.path"),listItem:{product:t,listId:i,listName:e}}},selector:".ddl_product_link, .ddl_product_link_js",followLink:!0},{name:"Viewed Product",trigger:"impression",handler:function(e){var t=e.map(function(e){return e.getAttribute("data-product-id")});if(t&&""!==t.toString().replace(/,/g,""))return{name:"Viewed Product",category:"Ecommerce",action:"Impressions",label:this.digitalData("page.path"),listItems:e.map(function(e){return{product:e.getAttribute("data-product-id"),listId:e.getAttribute("data-list-id")}})}},selector:".ddl_product_link"},{name:"Completed Transaction",trigger:"event",handler:function(e){var t=this.digitalData("transaction");return t.status="typ",{category:"Ecommerce",name:"Completed Transaction",transaction:t}},event:"Completed Transaction From GTM"},{name:"Order Success Thank You Page View",trigger:"event",handler:function(e){if(this.get(e,"order_success"))return{name:"Order Success Thank You Page View"}},event:"thank_you_page_view"},{name:"Viewed Product Listing",trigger:"event",handler:function(e){var t=this;if("listing"!==t.digitalData("page.type"))return"Category Navigation"===t.digitalData("page.category")&&t.digitalData("listing")?{name:"Viewed Product Listing",category:"Ecommerce",includeIntegrations:["RTB House","Retail Rocket","Flocktory","myTarget"]}:-1<t.digitalData("page.category").indexOf("Department")&&t.digitalData("listing")?{name:"Viewed Product Listing",category:"Ecommerce",includeIntegrations:["Retail Rocket"]}:void 0;var i=!1;return(t.digitalData("listing.items")||[]).forEach(function(e){i=i||e.cncAvailable}),{name:"Viewed Product Listing",category:"Ecommerce",cncAvailable:i}},event:"Viewed Page"}],scripts:[{name:"ci: creatives.afp.ai - Viewed Page",handler:function(e){this.loadPixel({src:"https://creatives.afp.ai/sbermegamarket/sbermegamarket.js",id:"creatives"})},event:"Viewed Page",fireOnce:!0,runAfterPageLoaded:!1},{name:"Flocktory - Cookie",handler:function(e){var t,i,a,n,r=this.queryParam("promocode_flocktory");r&&(t="promocode_flocktory",i=r,a=3650,(n=new Date).setTime(n.getTime()+24*a*60*60*1e3),n="expires="+n.toUTCString(),document.cookie=t+"="+i+";"+n+";path=/;domain=sbermegamarket.ru")},event:"Viewed Page",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Retail Rocket - Subscribed",handler:function(e){var t;"mobile"!==this.digitalData("website.type")&&this.digitalData("custom.retailRocketLoaded")&&(t=this.get(e,"user.email"),(window.rrApiOnReady=window.rrApiOnReady||[]).push(function(){rrApi.setEmail(t)}))},event:"RRSubscribed",fireOnce:!1,runAfterPageLoaded:!0},{name:"Validation - Event - Updated Cart",handler:function(e){var t=this.global("ddSchema.properties.events.properties");this.validate(t["Updated Cart"],e)},event:"Updated Cart",fireOnce:!1,runAfterPageLoaded:!1},{name:"Validation - Event - Removed Product from Wishlist",handler:function(e){var t=this.global("ddSchema.properties.events.properties");this.validate(t["Removed Product from Wishlist"],e)},event:"Removed Product from Wishlist",fireOnce:!1,runAfterPageLoaded:!1},{name:"Validation - Event - Added Product to Wishlist",handler:function(e){var t=this.global("ddSchema.properties.events.properties");this.validate(t["Added Product to Wishlist"],e)},event:"Added Product to Wishlist",fireOnce:!1,runAfterPageLoaded:!1},{name:"Validation - Event - Completed Transaction",handler:function(e){var t=this.global("ddSchema.properties.events.properties");this.validate(t["Completed Transaction"],e)},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!1},{name:"Validation - Event - Subscribed",handler:function(e){var t=this.global("ddSchema.properties.events.properties");this.validate(t.Subscribed,e)},event:"Subscribed",fireOnce:!1,runAfterPageLoaded:!1},{name:"Validation - Load Schema",handler:function(e){window.ddSchema={type:"object",properties:{campaigns:{type:"array",items:{type:"object",properties:{id:{type:"string"},name:{type:"string"},description:{type:"string"},category:{type:"string"},subcategory:{type:"string"},design:{type:"string"},position:{type:"string"}},required:["id","name"]}},transaction:{type:"object",properties:{currency:{type:"string"},isFirst:{type:"boolean"},isReturning:{type:"boolean"},lineItems:{type:"array",items:{type:"object",properties:{product:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currency:{type:"string"},description:{type:"string"},id:{type:"string"},imageUrl:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},rating:{type:"number"},skuCode:{type:"string"},stock:{type:"number"},thumbnailUrl:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},url:{type:"string"},color:{type:"string"},size:{type:"string"}},required:["categoryId","currency","id","name","skuCode","unitPrice","unitSalePrice"]},quantity:{type:"number"},subtotal:{type:"number"},shippingMethod:{type:"number"},shippingCost:{type:"string"}},required:["product","quantity","subtotal"]}},orderId:{type:"string"},orderIndex:{type:"number"},paymentMethod:{type:"string"},shippingCost:{type:"number"},shippingMethod:{type:"string"},subtotal:{type:"number"},total:{type:"number"},voucher:{type:"array",items:{type:"string"}},voucherDiscount:{type:"number"}},required:["currency","isFirst","isReturning","lineItems","orderId","subtotal","total"]},recommendation:{type:"array",items:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{categoryId:{type:"string"},currency:{type:"string"},id:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},skuCode:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"}},required:["categoryId","currency","id","name","skuCode","unitPrice","unitSalePrice"]}},listId:{type:"string"},listName:{type:"string"}},required:["items","listId","listName"]}},listingSearch:{type:"object",properties:{categoryId:{type:"string"},currentPage:{type:"number"},items:{type:"array",items:{type:"object",properties:{currency:{type:"string"},id:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},skuCode:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"}},required:["currency","id","name","skuCode","unitPrice","unitSalePrice"]}},listId:{type:"string"},listName:{type:"string"},pagesCount:{type:"number"},resultCount:{type:"number"},layout:{type:"string"},sortBy:{type:"string"},query:{type:"string"}},required:["categoryId","items","listId","listName","query"]},listing:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currentPage:{type:"number"},filters:{type:"object",properties:{filterTag:{type:"array",items:{type:"string"}},filterBrand:{type:"array",items:{type:"string"}},price:{type:"array",items:{type:"string"}}}},items:{type:"array",items:{type:"object",properties:{currency:{type:"string"},id:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},skuCode:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"}},required:["currency","id","name","skuCode","unitPrice","unitSalePrice"]}},listId:{type:"string"},listName:{type:"string"},pagesCount:{type:"number"},resultCount:{type:"number"},layout:{type:"string"},sortBy:{type:"string"}},required:["categoryId","items","listId","listName"]},listingNavigation:{type:"object",properties:{categoryId:{type:"string"}},required:["categoryId"]},cart:{type:"object",properties:{currency:{type:"string"},lineItems:{type:"array",items:{type:"object",properties:{product:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currency:{type:"string"},description:{type:"string"},id:{type:"string"},imageUrl:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},rating:{type:"number"},skuCode:{type:"string"},stock:{type:"number"},thumbnailUrl:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},url:{type:"string"}},required:["categoryId","currency","id","name","skuCode","unitPrice","unitSalePrice"]},quantity:{type:"number"},subtotal:{type:"number"}},required:["product","quantity","subtotal"]}},paymentMethod:{type:"string"},shippingCost:{type:"number"},shippingMethod:{type:"string"},subtotal:{type:"number"},total:{type:"number"},voucherDiscount:{type:"number"},vouchers:{type:"array",items:{type:"string"}},tax:{type:"number"}},required:["currency","lineItems","subtotal","total"]},cartEmpty:{type:"object",properties:{currency:{type:"string"},subtotal:{type:"number",enum:[0]},total:{type:"number",enum:[0]},lineItems:{type:"array"}},required:["currency","subtotal","total","lineItems"]},product:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currency:{type:"string"},description:{type:"string"},id:{type:"string"},imageUrl:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},rating:{type:"number"},reviews:{type:"array",items:{type:"object",properties:{userName:{type:"string"},bodyNegative:{type:"string"},bodyPositive:{type:"string"},comment:{type:"string"},rating:{type:"number"}},required:["rating"]}},skuCode:{type:"string"},stock:{type:"number"},thumbnailUrl:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},url:{type:"string"},variations:{type:"array",items:{type:"object",properties:{id:{type:"string"},skuCode:{type:"string"},stock:{type:"number"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},color:{type:"string"},size:{type:"string"}},required:["id","skuCode","unitPrice","unitSalePrice"]}},color:{type:"string"},size:{type:"string"},voucher:{type:"string"}},required:["categoryId","currency","id","skuCode","unitPrice","unitSalePrice"]},userLoggedIn:{type:"object",properties:{birthDate:{type:"string",pattern:"^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$"},email:{type:"string",pattern:"^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$"},firstName:{type:"string"},gender:{type:"string"},hasTransacted:{type:"boolean"},isLoggedIn:{type:"boolean"},isSubscribed:{type:"boolean"},lastName:{type:"string"},lastTransactionDate:{type:"string",pattern:"^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$"},middleName:{type:"string"},phone:{type:"string",pattern:"^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\./0-9]*$"},userId:{type:"string"},lastDeliveryDate:{type:"string",pattern:"^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$"},testVariation:{type:"string"}},required:["email","firstName","isLoggedIn","isSubscribed","userId"]},user:{type:"object",properties:{isLoggedIn:{type:"boolean"}},required:["isLoggedIn"]},page:{type:"object",properties:{breadcrumb:{type:"array",items:{type:"string"}},category:{type:"string"},type:{type:"string",enum:["home","listing","product","search","cart","checkout","confirmation","content"]}},required:["category","type"]},website:{type:"object",properties:{environment:{type:"string",enum:["development","testing","production"]},region:{type:"string"},regionId:{type:"string"},type:{type:"string",enum:["desktop","mobile","responsive"]},language:{type:"string"},currency:{type:"string"}},required:["environment","region","type"]},version:{type:"string"},events:{type:"object",properties:{Subscribed:{type:"object",properties:{campaign:{type:"object",properties:{id:{type:"string"},name:{type:"string"}}},user:{type:"object",properties:{firstName:{type:"string"},email:{type:"string"},phone:{type:"string"},subscriptions:{type:"array",items:{type:"object",properties:{type:{type:"string"},topic:{type:"string"}},required:["type","topic"]}}},required:["email","subscriptions"]},name:{type:"string"},category:{type:"string"}},required:["user","name","category"]},"Added Product to Wishlist":{type:"object",properties:{name:{type:"string"},category:{type:"string"},product:{type:"object",properties:{id:{type:"string"},skuCode:{type:"string"}},required:["id","skuCode"]}},required:["name","category","product"]},"Removed Product from Wishlist":{type:"object",properties:{category:{type:"string"},name:{type:"string"},product:{type:"object",properties:{id:{type:"string"},skuCode:{type:"string"}},required:["id","skuCode"]}},required:["category","name","product"]},"Updated Cart":{type:"object",properties:{category:{type:"string"},name:{type:"string"},cart:{type:"object",properties:{currency:{type:"string"},lineItems:{type:"array",items:{type:"object",properties:{product:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currency:{type:"string"},description:{type:"string"},id:{type:"string"},imageUrl:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},rating:{type:"number"},skuCode:{type:"string"},stock:{type:"number"},thumbnailUrl:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},url:{type:"string"}},required:["categoryId","currency","id","name","skuCode","unitPrice","unitSalePrice"]},quantity:{type:"number"},subtotal:{type:"number"}},required:["product","quantity","subtotal"]}},paymentMethod:{type:"string"},shippingCost:{type:"number"},shippingMethod:{type:"string"},subtotal:{type:"number"},total:{type:"number"},voucherDiscount:{type:"number"},vouchers:{type:"array",items:{type:"string"}},tax:{type:"number"}},required:["currency","lineItems","subtotal","total"]}},required:["category","name","cart"]},"Completed Transaction":{type:"object",properties:{category:{type:"string"},name:{type:"string"},transaction:{type:"object",properties:{currency:{type:"string"},isFirst:{type:"boolean"},isReturning:{type:"boolean"},lineItems:{type:"array",items:{type:"object",properties:{product:{type:"object",properties:{category:{type:"array",items:{type:"string"}},categoryId:{type:"string"},currency:{type:"string"},description:{type:"string"},id:{type:"string"},imageUrl:{type:"string"},manufacturer:{type:"string"},name:{type:"string"},rating:{type:"number"},skuCode:{type:"string"},stock:{type:"number"},thumbnailUrl:{type:"string"},unitPrice:{type:"number"},unitSalePrice:{type:"number"},url:{type:"string"},color:{type:"string"},size:{type:"string"}},required:["categoryId","currency","id","name","skuCode","unitPrice","unitSalePrice"]},quantity:{type:"number"},subtotal:{type:"number"},shippingMethod:{type:"number"},shippingCost:{type:"string"}},required:["product","quantity","subtotal"]}},orderId:{type:"string"},orderIndex:{type:"number"},paymentMethod:{type:"string"},shippingCost:{type:"number"},shippingMethod:{type:"string"},subtotal:{type:"number"},total:{type:"number"},voucher:{type:"array",items:{type:"string"}},voucherDiscount:{type:"number"}},required:["currency","isFirst","isReturning","lineItems","orderId","subtotal","total"]}},required:["category","name","transaction"]}}}}}},event:"Viewed Page",fireOnce:!1,priority:10,runAfterPageLoaded:!1},{name:"ci: VK - buyer",handler:function(e){!1===this.digitalData("user.isLoggedIn")&&(VK.Retargeting.Init('VK-RTRG-740345-e0KWW"'),VK.Goal("buyer"))},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!0},{name:"Validation - digitalData",handler:function(e){var t=this,i=t.global("ddSchema.properties");this.validate(i.page,digitalData,"page"),this.validate(i.website,digitalData,"website"),this.validate(i.version,digitalData,"version"),!0===t.digitalData("user.isLoggedIn")?this.validate(i.userLoggedIn,digitalData,"user"):this.validate(i.user,digitalData,"user"),"product"===t.digitalData("page.type")&&this.validate(i.product,digitalData,"product"),"confirmation"===t.digitalData("page.type")?(this.validate(i.transaction,digitalData,"transaction"),this.validate(i.cartEmpty,digitalData,"cart")):this.validate(i.cart,digitalData,"cart"),"Search Listing"===t.digitalData("page.category")&&this.validate(i.listingSearch,digitalData,"listing"),"Category Listing"===t.digitalData("page.category")&&this.validate(i.listing,digitalData,"listing"),"Category Navigation"===t.digitalData("page.category")&&this.validate(i.listingNavigation,digitalData,"listing"),t.digitalData("recommendation")&&this.validate(i.recommendation,digitalData,"recommendation")},event:"Viewed Page",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - Viewed Product Listing",handler:function(e){"listing"===this.digitalData("page.type")&&this.retry(function(){UXS.sendEvent("listing")})},event:"Viewed Product Listing",fireOnce:!1,priority:0,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Viewed Product Detail (Ð¨Ð¸Ð½Ñ Ð¸ Ð´Ð¸ÑÐºÐ¸)",handler:function(e){-1<this.digitalData("product.category").indexOf("Ð¨Ð¸Ð½Ñ Ð¸ Ð´Ð¸ÑÐºÐ¸")&&this.retry(function(){UXS.sendEvent("detailShinyDiski")})},event:"Viewed Product Detail",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Media Sniper - Viewed Page",handler:function(e){var t=this;t.loadScript({src:"https://static.terratraf.io/engine/GP.js",id:"Media Sniper"}),window.generalPixel=window.generalPixel||[],window.generalPixel.push({type:"GPID",id:"10002472"}),t.digitalData("user.userId")&&window.generalPixel.push({UserID:t.digitalData("user.userId")}),t.loadPixel({src:"https://sync.bumlam.com/?src=gp3&cid=A2D4FF&cmp=pxleadvisitc9275&act=turbov9275&page={originalURL}&r={referrer}",id:"Media Sniper Pixel 1"}),t.loadPixel({src:"https://sync.bumlam.com/?src=gp3&cid=10002472&cmp=pxleadvisitc9330&act=turbov9330&page={originalURL}&r={referrer}",id:"ÐÐ³ÐµÐ½ÑÑÑÐ²Ð¾ Ð¡Ð±ÐµÑÐ¼Ð°ÑÐºÐµÑÐ¸Ð½Ð³ (ÑÐ½Ð´ÐµÐºÑ ÑÑÑÐ±Ð¾)"}),t.loadPixel({src:"https://sync.bumlam.com/?src=gp3&cid=A2D4FF&cmp=pxleadvisitc9275&act=ampv9275&page=SOURCE_URL&r=DOCUMENT_REFERRER",id:"Media Sniper Pixel 2"}),t.loadPixel({src:"https://sync.bumlam.com/?src=gp3&cid=10002472&cmp=pxleadvisitc9330&act=ampv9330&page=SOURCE_URL&r=DOCUMENT_REFERRER",id:"ÐÐ³ÐµÐ½ÑÑÑÐ²Ð¾ Ð¡Ð±ÐµÑÐ¼Ð°ÑÐºÐµÑÐ¸Ð½Ð³ (AMP ÑÑÑÐ°Ð½Ð¸ÑÑ)"})},event:"Viewed Page",fireOnce:!0,priority:10,runAfterPageLoaded:!1},{name:"ci: Floodlight - Viewed Checkout",handler:function(e){var t=this,i=t.digitalData("cart.lineItems"),a=t.digitalData("cart.lineItems"),i=i.map(function(e){return e.product.skuCode}),a=a.map(function(e){return e.product.categoryId}),i=i.join("|"),a=a.join("|");gtag("event","conversion",{allow_custom_scripts:!0,session_id:t.digitalData("user.analytics_session_id")||"",u1:t.digitalData("user.googleClientId")||"",u2:t.digitalData("user.userId")||"",u3:a,u4:i,send_to:"DC-10810778/goods/ciiu30+per_session"})},event:"Clicked Checkout Buttons (Floodlight)",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Applied Sorting",handler:function(e){this.retry(function(){UXS.sendEvent("sort")})},event:"Applied Sorting",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Applied Filter (custom)",handler:function(e){var t=this.digitalData("listing.category[0]")||"";"listing"===this.digitalData("page.type")&&("Ð­Ð»ÐµÐºÑÑÐ¾Ð½Ð¸ÐºÐ°"===t||"ÐÑÑÐ¾Ð²Ð°Ñ ÑÐµÑÐ½Ð¸ÐºÐ°"===t?setTimeout(function(){UXS.sendEvent("filterCatalogApplyHouseholdElectronics")},3e3):"ÐÐ´ÐµÐ¶Ð´Ð°, Ð¾Ð±ÑÐ²Ñ Ð¸ Ð°ÐºÑÐµÑÑÑÐ°ÑÑ"===t?setTimeout(function(){UXS.sendEvent("filterCatalogApplyFashion")},3e3):"ÐÐµÐ±ÐµÐ»Ñ"===t||"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð´Ð¾Ð¼Ð°"===t||"ÐÐ²ÑÐ¾ÑÐ¾Ð²Ð°ÑÑ"===t||"Ð¡ÑÑÐ¾Ð¸ÑÐµÐ»ÑÑÑÐ²Ð¾ Ð¸ ÑÐµÐ¼Ð¾Ð½Ñ"===t||"ÐÐ°ÑÐ°, ÑÐµÐ·Ð¾Ð½Ð½ÑÐµ ÑÐ¾Ð²Ð°ÑÑ"===t||"Ð¡Ð¿Ð¾ÑÑ Ð¸ Ð°ÐºÑÐ¸Ð²Ð½ÑÐ¹ Ð¾ÑÐ´ÑÑ"===t?setTimeout(function(){UXS.sendEvent("filterCatalogApplyDurable")},3e3):"ÐÑÐ°ÑÐ¾ÑÐ° Ð¸ ÑÑÐ¾Ð´"!==t&&"fan goods"!==t&&"ÐÑÐ¾Ð´ÑÐºÑÑ Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ"!==t&&"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð²Ð·ÑÐ¾ÑÐ»ÑÑ"!==t&&"ÐÐµÑÑÐºÐ¸Ðµ ÑÐ¾Ð²Ð°ÑÑ"!==t&&"Ð¤Ð°Ð½Ð´Ð¾Ð¼ Ð°ÑÑÐ¸Ð±ÑÑÐ¸ÐºÐ°"!==t&&"ÐÐ½Ð¸Ð³Ð¸, ÑÐ¾Ð±Ð±Ð¸, ÐºÐ°Ð½ÑÐµÐ»ÑÑÐ¸Ñ"!==t&&"ÐÐ¾Ð¾ÑÐ¾Ð²Ð°ÑÑ"!==t&&"ÐÐ´Ð¾ÑÐ¾Ð²ÑÐµ"!==t||setTimeout(function(){UXS.sendEvent("filterCatalogApplyFMCG")},3e3))},event:"Applied Filter",fireOnce:!1,priority:6,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Completed Transaction",handler:function(e){var t=this,i=t.digitalData("cartType")||"";t.retry(function(){UXS.sendEvent("purchaseSuccess")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Delivery_type:i.toString()})})},2e3)},event:"Completed Transaction",fireOnce:!1,priority:5,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Viewed Orders In Profile",handler:function(e){"/personal/order/"===(this.digitalData("page.path")||"")&&this.retry(function(){UXS.sendEvent("profileOrdersView")})},event:"Viewed Page",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - Applied Filter After Search",handler:function(e){"search"===(this.digitalData("page.type")||"")&&this.retry(function(){UXS.sendEvent("filterSearchApply"),console.log("filterSearchApply")})},event:"Applied Filter",fireOnce:!1,priority:6,runAfterPageLoaded:!0},{name:"Clear DDM Cookies",handler:function(e){var n=this;["dd_custom.searchRelatedArray","dd_custom.userAppliedVoucher_go","dd_custom.prioritiesTestGroup","dd_user.hasAccount","dd_custom.listing_veiwedcnc_count","dd_custom.lt3","dd_custom.ts4","dd_custom.lt1","dd_custom.ts2","dd_user.isReturning","dd_custom.lt9","dd_custom.ts10","dd_custom.completedTransactions","dd_custom.lt13","dd_custom.ts14","dd_user.hasTransacted","dd_user.lastTransactionDate","dd_custom.lt5","dd_custom.ts6","dd_user.everLoggedIn","dd_user.email","dd_custom.lt11","dd_custom.ts12","dd_user.isSubscribed","dd_custom.isSearchRelated","dd__persistedKeys","dd_user.analytics_session_id","dd_user.scullyData","dd_custom.lt7","dd_custom.exponeaViewedPages","dd__lastEventTimestamp","dd_custom.ts8"].forEach(function(e){var t,i,a;n.cookie(e)&&(t=e,i="",a=0,(e=new Date).setTime(e.getTime()+(24*a*60*60*1e3+1)),e="expires="+e.toUTCString(),document.cookie=t+"="+i+";"+e+";path=/;domain=sbermegamarket.ru")})},event:"Viewed Page",fireOnce:!0,runAfterPageLoaded:!1},{name:"ci: Clear localStorage",handler:function(e){window&&window.localStorage.getItem("smm_unused_cleared")||(function(){if(window&&window.localStorage){const t=["ddl:user.isReturning","ddl:custom.searchRelatedArray","ddl:custom.prioritiesTestGroup","ddl:custom.exponeaViewedPages","ddl:user.hasAccount","ddl:custom.listing_veiwedcnc_count","ddl:custom.userAppliedVoucher_go","ddl:user.analytics_session_id","ddl:custom.isSearchRelated","ddl:custom.pageViews"],e=Object.keys(window.localStorage).filter(e=>e.startsWith("ddl")),i=[];e.forEach(e=>{t.includes(e)||i.push(e)}),i.forEach(e=>{window.localStorage.removeItem(e)})}}(),window.localStorage.setItem("smm_unused_cleared",Number(new Date)))},event:"Viewed Page",fireOnce:!0,priority:999,runAfterPageLoaded:!1},{name:"ci: UX Feedback - searchRusultViewNoCategory",handler:function(e){this.retry(function(){UXS.sendEvent("searchRusultViewNoCategory")})},event:"Searched Products",fireOnce:!1,priority:6,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Add Properties",handler:function(e){var t=this;setTimeout(function(){t.retry(function(){UXS.addProperties({User_id:t.digitalData("user.userId"),City:t.digitalData("website.region")})})},3e3)},event:"Viewed Page",fireOnce:!1,priority:999,runAfterPageLoaded:!0},{name:"Adjust Post View",handler:function(e){var t,i,a,n,r=this;"mobile"===r.digitalData("website.type")&&r.digitalData("context.campaign")&&(!r.digitalData("custom.pageViews")||r.digitalData("custom.pageViews")<2)&&(t=r.digitalData("context.campaign.source")||"",i=r.digitalData("context.campaign.medium")||"",a=r.digitalData("context.campaign.name")||"",(t||i||a)&&r.loadPixel({src:n="yandex"==t&&"cpc"==i?"https://app.adjust.com/w44p33g?campaign="+t+"&adgroup="+i+"&creative="+a:"https://app.adjust.com/k2s71e6?campaign="+t+"&adgroup="+i+"&creative="+a,id:"adjust_post_view"}),console.log("test"),console.log(n))},event:"Viewed Page",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - Viewed Product Page (custom)",handler:function(e){var t=this,i=t.digitalData("page.category"),a=t.digitalData("product.category[0]")||"",n=t.digitalData("product.category[1]")||"",r=t.digitalData("product.category[2]")||"",o=t.digitalData("product.unitPrice")||"",c=t.digitalData("product.BPG2")||"",d=t.digitalData("product.deliveryPeriodByCourier")||"";"Product Detail"===i&&("Ð­Ð»ÐµÐºÑÑÐ¾Ð½Ð¸ÐºÐ°"===a||"ÐÑÑÐ¾Ð²Ð°Ñ ÑÐµÑÐ½Ð¸ÐºÐ°"===a?(t.retry(function(){UXS.sendEvent("productViewHouseholdElectronics")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Price:o.toString(),Category_1lvl:a.toString(),Category_2lvl:n.toString(),Category_3lvl:r.toString(),Stock_Status:c.toString(),Delivery_time:d.toString()})})},2e3)):"ÐÐ´ÐµÐ¶Ð´Ð°, Ð¾Ð±ÑÐ²Ñ Ð¸ Ð°ÐºÑÐµÑÑÑÐ°ÑÑ"===a?(t.retry(function(){UXS.sendEvent("productViewFashion")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Price:o.toString(),Category_1lvl:a.toString(),Category_2lvl:n.toString(),Category_3lvl:r.toString(),Stock_Status:c.toString(),Delivery_time:d.toString()})})},2e3)):"ÐÐµÐ±ÐµÐ»Ñ"===a||"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð´Ð¾Ð¼Ð°"===a||"ÐÐ²ÑÐ¾ÑÐ¾Ð²Ð°ÑÑ"===a||"Ð¡ÑÑÐ¾Ð¸ÑÐµÐ»ÑÑÑÐ²Ð¾ Ð¸ ÑÐµÐ¼Ð¾Ð½Ñ"===a||"ÐÐ°ÑÐ°, ÑÐµÐ·Ð¾Ð½Ð½ÑÐµ ÑÐ¾Ð²Ð°ÑÑ"===a||"Ð¡Ð¿Ð¾ÑÑ Ð¸ Ð°ÐºÑÐ¸Ð²Ð½ÑÐ¹ Ð¾ÑÐ´ÑÑ"===a?(t.retry(function(){UXS.sendEvent("productViewDurable")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Price:o.toString(),Category_1lvl:a.toString(),Category_2lvl:n.toString(),Category_3lvl:r.toString(),Stock_Status:c.toString(),Delivery_time:d.toString()})})},2e3)):"ÐÑÐ°ÑÐ¾ÑÐ° Ð¸ ÑÑÐ¾Ð´"!==a&&"fan goods"!==a&&"ÐÑÐ¾Ð´ÑÐºÑÑ Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ"!==a&&"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð²Ð·ÑÐ¾ÑÐ»ÑÑ"!==a&&"ÐÐµÑÑÐºÐ¸Ðµ ÑÐ¾Ð²Ð°ÑÑ"!==a&&"Ð¤Ð°Ð½Ð´Ð¾Ð¼ Ð°ÑÑÐ¸Ð±ÑÑÐ¸ÐºÐ°"!==a&&"ÐÐ½Ð¸Ð³Ð¸, ÑÐ¾Ð±Ð±Ð¸, ÐºÐ°Ð½ÑÐµÐ»ÑÑÐ¸Ñ"!==a&&"ÐÐ¾Ð¾ÑÐ¾Ð²Ð°ÑÑ"!==a&&"ÐÐ´Ð¾ÑÐ¾Ð²ÑÐµ"!==a||(t.retry(function(){UXS.sendEvent("productViewFMCG")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Price:o.toString(),Category_1lvl:a.toString(),Category_2lvl:n.toString(),Category_3lvl:r.toString(),Stock_Status:c.toString(),Delivery_time:d.toString()})})},2e3)))},event:"Viewed Page",fireOnce:!1,priority:5,runAfterPageLoaded:!0},{name:"ci: Flocktory - Logged In",handler:function(e){var t=document.createElement("div");t.innerHTML='<div class="i-flocktory" data-fl-action="exchange" data-fl-spot="new" data-fl-user-name="'+this.get(e,"user.firstName")+" "+this.get(e,"user.lastName")+'" data-fl-user-email="'+this.get(e,"user.email")+'"></div>',document.body.appendChild(t)},event:"Logged In",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - Viewed Product With Delivery",handler:function(e){var t=this,i=t.digitalData("page.category")||"",a=t.digitalData("product.category[0]")||"",n=t.digitalData("product.category[1]")||"",r=t.digitalData("product.category[2]")||"",o=t.digitalData("product.deliveryPeriodByCourier")||"";t.digitalData("product.deliveryPeriodByPickup");"Product Detail"===i&&null!==o&&""!==o&&(t.retry(function(){UXS.sendEvent("productViewDeliveryTrue")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Price:productPrice.toString(),Category_1lvl:a.toString(),Category_2lvl:n.toString(),Category_3lvl:r.toString(),Stock_Status:stockStatus.toString(),Delivery_time:o.toString()})})},2e3))},event:"Viewed Page",fireOnce:!1,priority:6,runAfterPageLoaded:!0},{name:"ci: UX Feedback - Viewed Product Listing (custom)",handler:function(e){var t=this,i=t.digitalData("listing.category[0]")||"",a=t.digitalData("product.category[1]")||"",n=t.digitalData("product.category[2]")||"";"listing"===t.digitalData("page.type")&&("Ð­Ð»ÐµÐºÑÑÐ¾Ð½Ð¸ÐºÐ°"===i||"ÐÑÑÐ¾Ð²Ð°Ñ ÑÐµÑÐ½Ð¸ÐºÐ°"===i?(t.retry(function(){UXS.sendEvent("catalogViewHouseholdElectronics")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Category_1lvl:i.toString(),Category_2lvl:a.toString(),Category_3lvl:n.toString()})})},2e3)):"ÐÐ´ÐµÐ¶Ð´Ð°, Ð¾Ð±ÑÐ²Ñ Ð¸ Ð°ÐºÑÐµÑÑÑÐ°ÑÑ"===i?(t.retry(function(){UXS.sendEvent("catalogViewFashion")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Category_1lvl:i.toString(),Category_2lvl:a.toString(),Category_3lvl:n.toString()})})},2e3)):"ÐÐµÐ±ÐµÐ»Ñ"===i||"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð´Ð¾Ð¼Ð°"===i||"ÐÐ²ÑÐ¾ÑÐ¾Ð²Ð°ÑÑ"===i||"Ð¡ÑÑÐ¾Ð¸ÑÐµÐ»ÑÑÑÐ²Ð¾ Ð¸ ÑÐµÐ¼Ð¾Ð½Ñ"===i||"ÐÐ°ÑÐ°, ÑÐµÐ·Ð¾Ð½Ð½ÑÐµ ÑÐ¾Ð²Ð°ÑÑ"===i||"Ð¡Ð¿Ð¾ÑÑ Ð¸ Ð°ÐºÑÐ¸Ð²Ð½ÑÐ¹ Ð¾ÑÐ´ÑÑ"===i?(t.retry(function(){UXS.sendEvent("catalogViewDurable")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Category_1lvl:i.toString(),Category_2lvl:a.toString(),Category_3lvl:n.toString()})})},2e3)):"ÐÑÐ°ÑÐ¾ÑÐ° Ð¸ ÑÑÐ¾Ð´"!==i&&"fan goods"!==i&&"ÐÑÐ¾Ð´ÑÐºÑÑ Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ"!==i&&"Ð¢Ð¾Ð²Ð°ÑÑ Ð´Ð»Ñ Ð²Ð·ÑÐ¾ÑÐ»ÑÑ"!==i&&"ÐÐµÑÑÐºÐ¸Ðµ ÑÐ¾Ð²Ð°ÑÑ"!==i&&"Ð¤Ð°Ð½Ð´Ð¾Ð¼ Ð°ÑÑÐ¸Ð±ÑÑÐ¸ÐºÐ°"!==i&&"ÐÐ½Ð¸Ð³Ð¸, ÑÐ¾Ð±Ð±Ð¸, ÐºÐ°Ð½ÑÐµÐ»ÑÑÐ¸Ñ"!==i&&"ÐÐ¾Ð¾ÑÐ¾Ð²Ð°ÑÑ"!==i&&"ÐÐ´Ð¾ÑÐ¾Ð²ÑÐµ"!==i||(t.retry(function(){UXS.sendEvent("catalogViewFMCG")}),setTimeout(function(){t.retry(function(){UXS.addProperties({Category_1lvl:i.toString(),Category_2lvl:a.toString(),Category_3lvl:n.toString()})})},2e3)))},event:"Viewed Product Listing",fireOnce:!1,priority:5,runAfterPageLoaded:!0},{name:"ci: UX Feedback - product_history_chart_view",handler:function(e){this.retry(function(){UXS.sendEvent("ViewHistoryChart")})},event:"product_history_chart_view",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Criteo - Added Product",handler:function(e){window.criteo_q=window.criteo_q||[];var t=/iPad/.test(navigator.userAgent)?"t":/webOS|Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent)?"m":"d";window.criteo_q.push({event:"setAccount",account:40745},{event:"setEmail",email:this.digitalData("user.email")},{event:"setSiteType",type:t},{event:"viewBasket",item:[{id:this.get(e,"product.skuCode"),price:this.get(e,"product.unitPrice"),quantity:this.get(e,"quantity")||1}]})},event:"Added Product",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Yandex Metrika: Transaction Goal (value = GMV)",handler:function(e){var t=this;t.retry(function(){ym(42694559,"reachGoal","transaction_gmv",{order_price:t.get(e,"transaction.subtotal")+t.get(e,"transaction.shippingCost"),currency:"RUB"})})},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - Viewed Page",handler:function(e){var t,i;t=window,i=document,t._uxsSettings={id:"giev56vba9hzuzxxffkx31vr"},t=i.getElementsByTagName("head")[0],(i=i.createElement("script")).async=1,i.src="https://cdn.uxfeedback.ru/widget.js",t.appendChild(i)},event:"Viewed Page",fireOnce:!0,priority:5,runAfterPageLoaded:!1},{name:"ci: floctory_pdp_ab_test",handler:function(e){var t="banner_show";2==this.digitalData("custom.flocktorySegment")&&(t="banners_not_show"),dataLayer.push({event:"floctory_pdp_ab_test",eventCategory:t})},event:"Viewed Product Detail",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Yandex Metrika: Transaction Goal (ÐÐµÑÐ²Ð°Ñ Ð¿Ð¾ÐºÑÐ¿ÐºÐ°)",handler:function(e){this.digitalData("custom.completedTransactions")<=1&&this.retry(function(){ym(42694559,"reachGoal","firstTransaction")})},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: UX Feedback - nav_choose_adress_map_show",handler:function(e){this.retry(function(){UXS.sendEvent("nav_choose_adress_map_show")})},event:"nav_choose_adress_map_show_from_gtm",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Google Ads - Started Order",handler:function(e){function t(){dataLayer.push(arguments)}function t(){dataLayer.push(arguments)}this.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790096914",id:"gtag"}),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","AW-790096914"),t("event","conversion",{send_to:"AW-790096914/LIp1CLGdwpoBEJLY3_gC",value:this.digitalData("cart.total"),currency:"RUB"}),this.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790109431",id:"gtag"}),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","AW-790109431"),t("event","conversion",{send_to:"AW-790109431/uzu4CLig1ZoBEPe54PgC",value:this.digitalData("cart.total"),currency:"RUB"})},event:"Started Order",fireOnce:!1,runAfterPageLoaded:!0},{name:"Retail Rocket Click Attribution",handler:function(e){var t,i,a,n,r,o=this;"RetailRocket"===o.get(e,"source")&&(o.get(e,"product")?t="rr_click_"+o.get(e,"product.skuCode"):o.get(e,"listItem")&&(t="rr_click_"+o.get(e,"listItem.product.skuCode")),t&&(i=t,a="true",n=1,(r=new Date).setTime(r.getTime()+24*n*60*60*1e3),r="expires="+r.toUTCString(),document.cookie=i+"="+a+";"+r+";path=/;domain=sbermegamarket.ru"))},event:"Clicked Product",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Criteo - setCustomerID",handler:function(e){var t=this;t.digitalData("user.userId")&&t.retry(function(){window.criteo_q=window.criteo_q||[],window.criteo_q.push({event:"setCustomerID",id:t.digitalData("user.userId")})},10,1e3)},event:"Viewed Page",fireOnce:!0,runAfterPageLoaded:!1},{name:"Load Time",handler:function(e){var d,s,l;window.performance&&"function"==typeof window.performance.getEntriesByName&&(d=setInterval(function(){var e=window.performance.getEntriesByName("https://cdn.ddmanager.ru/ddm-initialization/f72a2e9d-633c-4ab0-9cff-2c32b4d5cad6.js"),t=window.performance.getEntries().filter(function(e){return/https:\/\/cdn.ddmanager.ru\/sdk\/dd-manager.js/.test(e.name)}),i=window.performance.getEntriesByName("https://cdn.retailrocket.ru/content/javascript/tracking.js"),a=window.performance.getEntriesByName("https://api.flocktory.com/v2/loader.js?site_id=2319"),n=0,r=0,o=0,c=0;e.forEach(function(e){n+=l(e.startTime)}),t.forEach(function(e){r+=l(e.startTime)}),i.forEach(function(e){o+=l(e.startTime)}),a.forEach(function(e){c+=l(e.startTime)}),.995<s&&(o<35&&0<o&&digitalData.events.push({category:"Timing",name:"RetailRocket Load Started After Page Load",label:+o.toFixed(3),value:Math.round(1e3*o),testVariation:"20.12.2018_1",nonInteraction:!0}),n<35&&0<n&&digitalData.events.push({category:"Timing",name:"DDM Initialization Load Started After Page Load",label:+n.toFixed(3),value:Math.round(1e3*n),testVariation:"20.12.2018_1",nonInteraction:!0}),r<35&&0<r&&digitalData.events.push({category:"Timing",name:"DDM SDK Load Started After Page Load",label:+r.toFixed(3),value:Math.round(1e3*r),testVariation:"20.12.2018_1",nonInteraction:!0}),c<35&&0<c&&digitalData.events.push({category:"Timing",name:"Flocktory Load Started After Page Load",label:+c.toFixed(3),value:Math.round(1e3*c),testVariation:"20.12.2018_1",nonInteraction:!0}),clearInterval(d))},1e3),s=Math.random(),l=function(e){return Math.round(100*e)/1e5})},event:"Viewed Page",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: Media Sniper - Completed Transaction - Card Payment",handler:function(e){this.retry(function(){generalPixel.postClick("a5")})},event:"Completed Transaction - Card Payment",fireOnce:!1,priority:9,runAfterPageLoaded:!0},{name:"ci: Media Sniper - Completed Transaction - Cash Payment",handler:function(e){this.retry(function(){generalPixel.postClick("a4")})},event:"Completed Transaction - Cash Payment",fireOnce:!1,priority:9,runAfterPageLoaded:!0},{name:"ci: VK - Email Promocode",handler:function(e){"login"===this.digitalData("event.action")&&(VK.Retargeting.Init('VK-RTRG-740345-e0KWW"'),VK.Goal("email_promocode"))},event:"Flocktory Event",fireOnce:!1,runAfterPageLoaded:!1},{name:"ci: RTB House - Added Product",handler:function(e){var t=this.get(e,"product.skuCode"),e=this.digitalData("website.regionId");this.loadScript({src:"//creativecdn.com/tags?type=script&id=pr_onCQwGPAIJoGJk6waEgH_basketadd_"+(t+="1"===e||"50"===e?"@1":"47"===e||"78"===e?"@2":"@3")})},event:"Added Product",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Media Sniper - Clicked ToCart Button",handler:function(e){this.retry(function(){generalPixel.postClick("a2")})},event:"Clicked ToCart Button",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Floodlight - Completed Transaction",handler:function(e){var t=this,i=t.get(e,"transaction.lineItems"),a=t.get(e,"transaction.lineItems"),i=i.map(function(e){return e.product.skuCode}),a=a.map(function(e){return e.product.categoryId}),i=i.join("|"),a=a.join("|");gtag("event","purchase",{allow_custom_scripts:!0,value:t.get(e,"transaction.total"),transaction_id:t.get(e,"transaction.orderId"),u1:t.digitalData("user.googleClientId")||"",u2:t.digitalData("user.userId")||"",u3:a,u4:i,send_to:"DC-10810778/gcard/jenyg0+transactions"})},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Floodlight - Viewed Checkout",handler:function(e){var t=this,i=t.digitalData("cart.lineItems"),a=t.digitalData("cart.lineItems"),i=i.map(function(e){return e.product.skuCode}),a=a.map(function(e){return e.product.categoryId}),i=i.join("|"),a=a.join("|");"/multicart/"==t.digitalData("page.path")&&gtag("event","conversion",{allow_custom_scripts:!0,session_id:t.digitalData("user.analytics_session_id")||"",u1:t.digitalData("user.googleClientId")||"",u2:t.digitalData("user.userId")||"",u3:a,u4:i,send_to:"DC-10810778/goods/j7an30+per_session"}),"/multicart/"!==t.digitalData("page.path")&&gtag("event","conversion",{allow_custom_scripts:!0,session_id:t.digitalData("user.analytics_session_id")||"",u1:t.digitalData("user.googleClientId")||"",u2:t.digitalData("user.userId")||"",u3:a,u4:i,send_to:"DC-10810778/goods/9obl_0+per_session"})},event:"Viewed Checkout Step",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Google Ads - Added Product",handler:function(e){function t(){dataLayer.push(arguments)}function t(){dataLayer.push(arguments)}this.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790096914",id:"gtag"}),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","AW-790096914"),t("event","conversion",{send_to:"AW-790096914/77uPCNCbwpoBEJLY3_gC",value:this.get(e,"product.unitSalePrice"),currency:"RUB"}),this.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790109431",id:"gtag"}),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","AW-790109431"),t("event","conversion",{send_to:"AW-790109431/Hqa_CKyswZoBEPe54PgC",value:this.get(e,"product.unitSalePrice"),currency:"RUB"})},event:"Added Product",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Google Ads - Completed Transaction",handler:function(e){var t=this;{function i(){dataLayer.push(arguments)}function i(){dataLayer.push(arguments)}function i(){dataLayer.push(arguments)}function i(){dataLayer.push(arguments)}"ÐÐ°Ð»Ð¸ÑÐ½ÑÐµ"===t.get(e,"transaction.paymentMethod")?(t.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790096914",id:"gtag"}),window.dataLayer=window.dataLayer||[],i("js",new Date),i("config","AW-790096914"),i("event","conversion",{send_to:"AW-790096914/2KPfCP-41poBEJLY3_gC",value:t.get(e,"transaction.total"),currency:"RUB"}),t.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790109431",id:"gtag"}),window.dataLayer=window.dataLayer||[],i("js",new Date),i("config","AW-790109431"),i("event","conversion",{send_to:"AW-790109431/dQqBCJ3xy5oBEPe54PgC",value:t.get(e,"transaction.total"),currency:"RUB"})):(t.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790096914",id:"gtag"}),window.dataLayer=window.dataLayer||[],i("js",new Date),i("config","AW-790096914"),i("event","conversion",{send_to:"AW-790096914/JgTMCLa2y5oBEJLY3_gC",value:t.get(e,"transaction.total"),currency:"RUB"}),t.loadScript({src:"https://www.googletagmanager.com/gtag/js?id=AW-790109431",id:"gtag"}),window.dataLayer=window.dataLayer||[],i("js",new Date),i("config","AW-790109431"),i("event","conversion",{send_to:"AW-790109431/dAHYCJu7ypoBEPe54PgC",value:t.get(e,"transaction.total"),currency:"RUB"}))}},event:"Completed Transaction",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Media Sniper - Logged In",handler:function(e){this.retry(function(){generalPixel.postClick("a7")})},event:"Logged In",fireOnce:!1,runAfterPageLoaded:!0},{name:"ci: Media Sniper - Registered",handler:function(e){this.retry(function(){generalPixel.postClick("a8")})},event:"Registered",fireOnce:!1,runAfterPageLoaded:!0},{name:"Inhouse Recommendation Click Attribution",handler:function(e){var t,i,a,n;this.get(e,"listItem").listId&&this.get(e,"listItem").product.id&&-1<["200000002","200000004","200000005","DailyItem","recentlyViewed"].indexOf(this.get(e,"listItem").listId)&&(e="inh_rec_click_"+this.get(e,"listItem").product.id,t=e,i="true",a=1,(n=new Date).setTime(n.getTime()+24*a*60*60*1e3),n="expires="+n.toUTCString(),document.cookie=t+"="+i+";"+n+";path=/;domain=sbermegamarket.ru")},event:"Clicked Product",fireOnce:!1,runAfterPageLoaded:!1}],integrationsPriority:{after:["myTarget","Flocktory","Vkontakte","DoubleClick Floodlight"],before:["Yandex Metrica","Retail Rocket","DDManager Streaming","Google Analytics","OWOX BI Streaming","Google Tag Manager"]},integrations:{"Retail Rocket":{partnerId:"59f319fbc7d011dbaceaa05e",useGroupView:!0,trackAllEmails:!1,productVariables:{"product.skuCode":{type:"digitalData",value:"test"}},eventEnrichments:[{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"ignore",handler:function(e){return!0},event:"Viewed Product Detail [DELETE]"},{scope:"event",prop:"ignore",handler:function(e){return!(this.digitalData("listing.collectionId")||this.digitalData("listing.categoryId"))},event:"Viewed Product Listing [DELETE]"},{scope:"event",prop:"ignore",handler:function(e){return"desktop"===this.digitalData("website.type")&&!this.digitalData("website.ssr")},event:"[DELETE]"},{scope:"event",prop:"user.email",handler:function(e){if(!this.digitalData("user.email")&&this.digitalData("contactInfo.email"))return this.digitalData("contactInfo.email")}},{scope:"event",prop:"listing.categoryId",handler:function(e){return this.digitalData("listing.collectionId")||this.digitalData("listing.categoryId")},event:"Viewed Product Listing"},{scope:"product",prop:"variations",handler:function(e){e=this.get(e,"groupSkuCodeList")||[];if(console.log(e),e.length)return console.log("MAP",e.map(function(e){return{skuCode:e}})),e.map(function(e){return{skuCode:e}})}},{scope:"event",prop:"product.skuCode",handler:function(e){return this.digitalData("product.skuCode")},event:"Viewed Product"},{scope:"event",prop:"ignore",handler:function(e){if(-1===this.digitalData("page.url").indexOf("/catalog/")||-1!=this.digitalData("page.url").indexOf("/brand-"))return!0},event:"Viewed Product Listing"}]},"Yandex Metrica":{goals:{"Added Product":"product_add_to_cart","Transaction Check":"firstTransaction"},clickmap:!0,webvisor:!0,counterId:"42694559",trackHash:!1,sendUserId:!0,trackLinks:!0,webvisorVersion:2,accurateTrackBounce:!0,feedWithGroupedProducts:!1,eventEnrichments:[{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"ignore",handler:function(e){return this.get(e,"label").indexOf("isFirst")<0},event:"Transaction Check"},{scope:"event",prop:"transaction.total",handler:function(e){return this.digitalData("transaction.subtotal")+this.digitalData("transaction.shippingCost")},event:"Completed Transaction"},{scope:"event",prop:"ignore",handler:function(e){return!(0===this.digitalData("page.url").indexOf("https://sbermegamarket.ru")||0===this.digitalData("page.url").indexOf("https://goods.ru")||0===this.digitalData("page.url").indexOf("https://test.goods.ru")||0===this.digitalData("page.url").indexOf("https://blue.goods.ru"))}}]},"DoubleClick Floodlight":{events:[{event:"Viewed Elektronika Category",customVars:{u1:{type:"digitalData",value:"user.googleClientId"},u2:{type:"digitalData",value:"user.userId"}},countingMethod:"standard",activityTagString:"_5muo0",floodlightConfigID:"10810778",activityGroupTagString:"goods"},{event:"Viewed Elektroinstrumenty Category",customVars:{u1:{type:"digitalData",value:"user.googleClientId"},u2:{type:"digitalData",value:"user.userId"}},countingMethod:"standard",activityTagString:"hp-3i0",floodlightConfigID:"10810778",activityGroupTagString:"goods"},{event:"Viewed Detskie Tovary Category",customVars:{u1:{type:"digitalData",value:"user.googleClientId"},u2:{type:"digitalData",value:"user.userId"}},countingMethod:"standard",activityTagString:"e2ldv0",floodlightConfigID:"10810778",activityGroupTagString:"goods"},{event:"Clicked To Login By Sber Id",customVars:{u1:{type:"digitalData",value:"user.googleClientId"},u2:{type:"digitalData",value:"user.userId"}},countingMethod:"standard",activityTagString:"sberi0",floodlightConfigID:"10810778",activityGroupTagString:"goods"},{event:"Viewed Home Page",customVars:{u1:{type:"digitalData",value:"user.googleClientId"},u2:{type:"digitalData",value:"user.userId"}},countingMethod:"standard",activityTagString:"_uxy40",floodlightConfigID:"10810778",activityGroupTagString:"goods"}],eventEnrichments:[{scope:"event",prop:"productCategory",handler:function(e){var t=this.digitalData("product.category")||this.digitalData("listing.category")||"";if(t)return t[t.length-1]},event:"Added Product"}]},"DDManager Streaming":{dimensions:{"isC&C":{type:"digitalData",value:"page.isMerchant"},isSSR:{type:"digitalData",value:"website.ssr"},stock:{type:"product",value:"stock"},isBPG2:{type:"product",value:"BPG2"},rrDivId:{type:"event",value:"rrDivId"},category:{type:"event",value:"custom.category"},dayOffer:{type:"event",value:"dayOffer"},listName:{type:"product",value:"listName"},"page.path":{type:"digitalData",value:"page.path"},"page.type":{type:"digitalData",value:"page.type"},isDayOffer:{type:"product",value:"isDayOffer"},rrListName:{type:"event",value:"rrListName"},scullyData:{type:"event",value:"scullyData"},rr_algoritm:{type:"product",value:"rr_algoritm"},checkoutStep:{type:"event",value:"checkoutStep"},cncAvailable:{type:"product",value:"cncAvailable"},"event.action":{type:"event",value:"action"},"event.source":{type:"event",value:"source"},"page.referrer":{type:"digitalData",value:"page.referrer"},paymentMethod:{type:"event",value:"transaction.paymentMethod"},selectedPrice:{type:"product",value:"selectedPrice"},"campaigns.slug":{type:"digitalData",value:"campaigns.slug"},category_lvl_1:{type:"event",value:"category_lvl_1"},category_lvl_2:{type:"event",value:"category_lvl_2"},googleClientId:{type:"digitalData",value:"user.googleClientId"},"product.seller":{type:"product",value:"seller"},rrAbsentReason:{type:"event",value:"rrAbsentReason"},shippingMethod:{type:"event",value:"transaction.shippingMethod"},yandexClientId:{type:"digitalData",value:"user.yandexClientId"},appWebView_name:{type:"event",value:"appWebView_name"},googleSessionId:{type:"digitalData",value:"custom.sessionId"},isSearchRelated:{type:"product",value:"isSearchRelated"},"product.skuCode":{type:"event",value:"product.skuCode"},"user.scullyData":{type:"digitalData",value:"user.scullyData"},"custom.ecomscore":{type:"digitalData",value:"custom.ecomscore"},"product.category":{type:"event",value:"product.category"},"custom.previousUrl":{type:"digitalData",value:"custom.previousUrl"},isRRClickAttributed:{type:"product",value:"isRRClickAttributed"},"campaigns.merchantId":{type:"digitalData",value:"campaigns.merchantId"},"campaigns.positionId":{type:"digitalData",value:"campaigns.positionId"},"campaigns.formatAlias":{type:"digitalData",value:"campaigns.formatAlias"},"campaigns.subcategory":{type:"digitalData",value:"campaigns.subcategory"},"campaigns.advertiserId":{type:"digitalData",value:"campaigns.advertiserId"},"custom.isSearchRelated":{type:"digitalData",value:"custom.isSearchRelated"},deliveryPeriodByPickup:{type:"product",value:"deliveryPeriodByPickup"},deliveryPeriodByCourier:{type:"product",value:"deliveryPeriodByCourier"},isCrossedPrice_dynamics:{type:"product",value:"isCrossedPrice_dynamics"},isCrossedPrice_merchant:{type:"product",value:"isCrossedPrice_merchant"},"user.analytics_session_id":{type:"digitalData",value:"user.analytics_session_id"},"campaigns.parentCampaignId":{type:"digitalData",value:"campaigns.parentCampaignId"},"campaigns.parentCampaignName":{type:"digitalData",value:"campaigns.parentCampaignName"},isInhouseRecommendationClickAttributed:{type:"product",value:"isInhouseRecommendationClickAttributed"}},eventEnrichments:[{scope:"event",prop:"transaction.lineItems",handler:function(e){var i=this,t=i.digitalData("custom.searchRelatedArray")||[],a={};return t.forEach(function(e){a[Object.keys(e)[0]]=e[Object.keys(e)[0]]}),i.get(e,"transaction.lineItems").map(function(e){e.product.isSearchRelated=a[e.product.skuCode]||!1;var t="rr_click_"+e.product.skuCode;return i.cookie(t)&&(e.product.isRRClickAttributed=!0),t="inh_rec_click_"+e.product.skuCode,i.cookie(t)&&(e.product.isInhouseRecommendationClickAttributed=!0),e})},event:"Completed Transaction"},{scope:"event",prop:"dayOffer",handler:function(e){return"/tovar-dnya/"===this.digitalData("page.path")?"landing":this.get(e,"product.isDayOffer")?"other":void 0},event:"Added Product"},{scope:"event",prop:"appWebView_name",handler:function(e){return this.digitalData("custom.webView.isGoodsApp")?"goodsAPP":this.digitalData("custom.webView.isPochtaApp")?"pochtaAPP":void 0}},{scope:"event",prop:"rrListName",handler:function(e){return this.get(e,"label").split("/")[0]},event:"Absent RR Block"},{scope:"event",prop:"rrAbsentReason",handler:function(e){return this.get(e,"label").split("/")[1]},event:"Absent RR Block"},{scope:"event",prop:"listItems",handler:function(t){var i=this;if("RetailRocket"===i.get(t,"source"))return i.get(t,"listItems").map(function(e){return e.listId=e.listName,e.product.rr_algoritm=i.get(t,"rr_algoritm"),e})},event:"Viewed Product"},{scope:"event",prop:"listItem",handler:function(e){if("RetailRocket"===this.get(e,"source")&&this.get(e,"listItem")){var t=this.get(e,"listItem");return t.listId=t.listName||"",t.product.rr_algoritm=this.get(e,"rr_algoritm"),t}},event:"Clicked Product"},{scope:"event",prop:"product.skuCode",handler:function(e){return this.digitalData("product.skuCode")},event:"Flocktory Event"},{scope:"event",prop:"product.category",handler:function(e){var t="",i=this.digitalData("product.category");return i&&i.forEach(function(e){t=t+e+"/"}),t},event:"Flocktory Event"},{scope:"event",prop:"custom.category",handler:function(e){var t="",i=this.digitalData("listing.category")||this.digitalData("product.category");return i&&i.forEach(function(e){t=t+e+"/"}),t}},{scope:"event",prop:"cart.lineItems",handler:function(e){var i=this,t=i.digitalData("custom.searchRelatedArray")||[],a={};return t.forEach(function(e){a[Object.keys(e)[0]]=e[Object.keys(e)[0]]}),i.digitalData("cart.lineItems").map(function(e){e.product.isSearchRelated=a[e.product.skuCode]||!1;var t="rr_click_"+e.product.skuCode;return i.cookie(t)&&(e.product.isRRClickAttributed=!0),e})}},{scope:"event",prop:"category_lvl_1",handler:function(e){var t=this.digitalData("listing.category")||this.digitalData("product.category")||"";if(t)return t[0]}},{scope:"event",prop:"category_lvl_2",handler:function(e){var t=this.digitalData("listing.category")||this.digitalData("product.category")||"";if(t)return t[1]}},{scope:"event",prop:"label",handler:function(e){return this.get(e,"receiveTooManyEmails")+";"+this.get(e,"uninterestingOffers")+";"+this.get(e,"other")},event:"Unsubscribe"},{scope:"event",prop:"campaigns",handler:function(e){return(this.get(e,"campaigns")||[]).map(function(e){return e.design=e.formatAlias,e})},event:"Viewed Campaign"}]},"Google Analytics":{domain:"auto",metrics:{metric1:{type:"event",value:"transaction.bonusReceivedByProduct"},metric2:{type:"event",value:"transaction.bonusUsedByProduct"},metric3:{type:"event",value:"searchValue"}},useProxy:!1,dimensions:{dimension2:{type:"event",value:"Hit_ID"},dimension3:{type:"digitalData",value:"user.userId"},dimension4:{type:"digitalData",value:"page.type"},dimension5:{type:"event",value:"cartType"},dimension6:{type:"event",value:"transaction.paymentMethod"},dimension7:{type:"digitalData",value:"website.regionId"},dimension8:{type:"event",value:"transaction.pickupPoint"},dimension13:{type:"product",value:"stock"},dimension14:{type:"product",value:"chosenOffer"},dimension15:{type:"product",value:"seller"},dimension16:{type:"digitalData",value:"website.type"},dimension17:{type:"event",value:"category_lvl_1"},dimension18:{type:"digitalData",value:"listing.resultCountOnPage"},dimension19:{type:"event",value:"category_lvl_2"},dimension20:{type:"product",value:"bonusAmount"},dimension21:{type:"digitalData",value:"listing.sortBy"},dimension22:{type:"event",value:"transaction.bonusReceived"},dimension23:{type:"product",value:"productCategory"},dimension24:{type:"event",value:"transaction.bonusUsed"},dimension25:{type:"event",value:"transaction.vouchers[0]"},dimension26:{type:"event",value:"transaction.voucherDiscount"},dimension27:{type:"digitalData",value:"user.isLoggedIn"},dimension29:{type:"product",value:"unitSalePrice"},dimension30:{type:"product",value:"photosCount"},dimension32:{type:"event",value:"BPG2"},dimension33:{type:"digitalData",value:"product.availableShops"},dimension34:{type:"product",value:"BPG2Price"},dimension37:{type:"event",value:"website.isDDM"},dimension39:{type:"digitalData",value:"user.segment.bidStrategy"},dimension40:{type:"digitalData",value:"custom.prioritiesTestGroup"},dimension57:{type:"digitalData",value:"user.userId"},dimension58:{type:"digitalData",value:"custom.isSearchRelated"},dimension59:{type:"digitalData",value:"context.ip"},dimension60:{type:"event",value:"appWebView_name"},dimension62:{type:"digitalData",value:"user.analytics_session_id"},dimension63:{type:"digitalData",value:"page.category"},dimension72:{type:"event",value:"checkoutStep"},dimension98:{type:"event",value:"cncAvailable"},dimension99:{type:"event",value:"deliveryAvailable"},dimension100:{type:"event",value:"timestamp"},dimension101:{type:"event",value:"categoryId"},dimension102:{type:"event",value:"authType"},dimension103:{type:"digitalData",value:"product.isAddedFromFixedBtnInTop"},dimension105:{type:"digitalData",value:"website.ssr"},dimension106:{type:"digitalData",value:"isSberAuthPersonalisedBtn"},dimension107:{type:"digitalData",value:"page.fashionView"},dimension108:{type:"digitalData",value:"custom.previousUrl"},dimension109:{type:"digitalData",value:"page.url"},dimension111:{type:"digitalData",value:"product.isAddressConfirmed"},dimension112:{type:"digitalData",value:"product.additionFrom"},dimension113:{type:"digitalData",value:"product.additionHow"}},sendUserId:!1,trackingId:"UA-89387429-1",anonymizeIp:!1,contentGroups:{contentGroup1:{type:"digitalData",value:"category1_2lvl"}},transliterate:!1,defaultCurrency:"RUB",enhancedEcommerce:!0,crossDomainTracking:!1,siteSpeedSampleRate:1,clientIdCustomDimension:"dimension1",enhancedLinkAttribution:!1,eventEnrichments:[{scope:"event",prop:"action",handler:function(e){return"Add_To_Cart"},event:"Added Product"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Added Product"},{scope:"event",prop:"action",handler:function(e){return"Remove_From_Cart"},event:"Removed Product"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Removed Product"},{scope:"event",prop:"category",handler:function(e){return"ÐÐ¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¸Ð·Ð±ÑÐ°Ð½Ð½Ð¾Ðµ"},event:"Added Product to Wishlist"},{scope:"event",prop:"action",handler:function(e){return this.digitalData("page.type")},event:"Added Product to Wishlist"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Added Product to Wishlist"},{scope:"event",prop:"category",handler:function(e){return"OtherEvents"},event:"Changed Layout"},{scope:"event",prop:"action",handler:function(e){return"Ð¡Ð¼ÐµÐ½Ð° ÑÐ¾ÑÐ¼Ð°ÑÐ° Ð»Ð¸ÑÑÐ¸Ð½Ð³Ð°"},event:"Changed Layout"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Changed Layout"},{scope:"event",prop:"action",handler:function(e){return this.digitalData("listing.sortBy")},event:"Applied Sorting"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Applied Sorting"},{scope:"event",prop:"category",handler:function(e){return"OtherEvents"},event:"Selected Shipping Method"},{scope:"event",prop:"action",handler:function(e){return"Change_Delivery_Option"},event:"Selected Shipping Method"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("cart.shippingMethod")},event:"Selected Shipping Method"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("cart.deliveryDate")},event:"Selected Delivery Date"},{scope:"event",prop:"action",handler:function(e){return"Change_ Delivery_Date"},event:"Selected Delivery Date"},{scope:"event",prop:"category",handler:function(e){return"OtherEvents"},event:"Selected Delivery Date"},{scope:"event",prop:"category",handler:function(e){return"Registration"},event:"Failed To Register"},{scope:"event",prop:"action",handler:function(e){return"Error"},event:"Failed To Register"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Failed To Register"},{scope:"event",prop:"loadTimeSincePageLoad",handler:function(e){return this.get(e,"label")},event:"RetailRocket Load Started After Page Load"},{scope:"event",prop:"loadTimeSinceDDMLoad",handler:function(e){return this.get(e,"label")},event:"RetailRocket Load Started After DDM Load"},{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"action",handler:function(e){return this.digitalData("website.region")},event:"Selected Region"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Selected Region"},{scope:"event",prop:"label",handler:function(e){if(!this.get(e,"label"))return this.digitalData("page.path")}},{scope:"event",prop:"category",handler:function(e){return"Authorization"},event:"Failed To Log In"},{scope:"event",prop:"action",handler:function(e){return"Error"},event:"Failed To Log In"},{scope:"product",prop:"availability",handler:function(e){return 0<this.get(e,"stock")?"in_stock":0===this.get(e,"stock")?"out_of_stock":void 0}},{scope:"event",prop:"listingCategory",handler:function(e){if(this.digitalData("listing.category")&&this.digitalData("listing.category")[0])return this.digitalData("listing.category")[0]}},{scope:"event",prop:"listingCategorySecond",handler:function(e){if(this.digitalData("listing.category")&&this.digitalData("listing.category")[1])return this.digitalData("listing.category")[1]}},{scope:"product",prop:"productCategory",handler:function(e){if(this.get(e,"category")){e=this.get(e,"category");return e[e.length-1]}}},{scope:"event",prop:"transactionVoucher",handler:function(e){e=this.get(e,"vouchers");if(e&&0<e.length)return e[0]},event:"Completed Transaction"},{scope:"event",prop:"isLoggedIn",handler:function(e){return!0===this.digitalData("user.isLoggedIn")?"yes":!1===this.digitalData("user.isLoggedIn")?"no":void 0}},{scope:"event",prop:"ignore",handler:function(e){var t=this,i=t.get(e,"name"),a=t.get(e,"action"),n=t.get(e,"category"),r=t.get(e,"source"),o=(t.get(e,"label"),t.digitalData("page.type"));return"Completed Transaction"===t.get(e,"name")||"Scrolled Page"===t.get(e,"name")&&"home"!=o||"Viewed Product"===t.get(e,"name")||"Form Analytics"===t.get(e,"category")||"Logged In"===t.get(e,"name")||"Registered"===t.get(e,"name")||"Scully"===t.get(e,"category")||"30 Seconds Spent On Page"===t.get(e,"name")||"Started Registration"===t.get(e,"name")||!("Thank You Page Check"===i||"Viewed Product Detail"===i||"HomePage_View"===a||"PLP_View"===a||"PDP_View"===a||"Add_To_Cart"===a||"Remove_From_Cart"===a||"Authorization"===n||"Registration"===n||"ÐÑÐ¸Ð±ÐºÐ° 404"===n||"ÐÐ»ÑÐ±Ð¸Ð½Ð° Ð¿ÑÐ¾ÐºÑÑÑÐºÐ¸"===n||"ÐÐ¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¸Ð·Ð±ÑÐ°Ð½Ð½Ð¾Ðµ"===n||"ReviewsAction"===n||"Tab_Click Ð¥Ð°ÑÐ°ÐºÑÐµÑÐ¸ÑÑÐ¸ÐºÐ¸"===a||"Tab_Click ÐÑÐ·ÑÐ²Ñ"===a||"Tab_Click ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ"===a||"ÐÐ»Ð¸Ðº Ð² Ð¿Ð¾ÑÐ¾Ð¶Ð¸Ðµ ÑÐ¾Ð²Ð°ÑÐ°"===a||"Promo_Code_Cancel"===n||"Registration SMS"===n||"Search_View"===a||"Tab_Click Ð¦ÐµÐ½Ñ"===a||"Change_Delivery_Option"===a||"Change_ Delivery_Date"===a||"Ð¡Ð¼ÐµÐ½Ð° ÑÐ¾ÑÑÐ¸ÑÐ¾Ð²ÐºÐ¸ Ð»Ð¸ÑÑÐ¸Ð½Ð³Ð°"===n||"Impressions"===a||"ÐÑÐ±Ð¾Ñ ÑÐµÐ³Ð¸Ð¾Ð½Ð°"===n||"ÐÐ¾ÐºÐ°Ð· Ð¿Ð»Ð°Ð²Ð°ÑÑÐµÐ³Ð¾ ÑÐ°Ð±Ð°"===a||"ÐÑÐ¾ÑÐµÐ½Ð½Ð°Ñ ÐºÐ¾ÑÐ·Ð¸Ð½Ð°"===a||"ÐÐ¾ÐºÐ°Ð·Ð°ÑÑ ÐµÑÐµ"===a||"ÐÑÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¿ÑÐ¾Ð´Ð°Ð²ÑÐ¾Ð²"===a||"Tab_Click ÐÑÐ¿Ð¸ÑÑ"===a||"Ð¡Ð¼ÐµÐ½Ð° ÑÐ¾ÑÐ¼Ð°ÑÐ° Ð»Ð¸ÑÑÐ¸Ð½Ð³Ð°"===a||"Clicked Campaign"===i||"Viewed Campaign"===i||"Transaction Check"===i||"Viewed Checkout Step"===i||"Viewed Page"===i&&-1<t.digitalData("page.path").indexOf("/personal/order/make")||"Completed Checkout"===i||"Viewed Page"===i&&"DDManager SDK"!==r||"Clicked Filter Reset"===i||"ÐÐ»Ð¸ÐºÐ¸ Ð² Ð¼ÐµÐ½Ñ"===n||"ÐÐ·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑÐ²Ð¸Ðµ Ñ ÑÐ¸Ð»ÑÑÑÐ¾Ð¼"===n||"Product_Click"===a||"Promo_Code_Apply"===n||"Flocktory Event"===i||"Return Application"===n||"Viewed CNC Product"===i||"Clicked Partner Link"===i||"Map Initialized"===i||"ÐÐµÑÐµÑÐ¾Ð´ Ð² ÐºÐ¾ÑÐ·Ð¸Ð½Ñ|ÐÐ»Ð¸Ðº"===n||"ÐÐµÑÐµÑÐ¾Ð´ Ð½Ð° Ð´ÐµÑÐ°Ð»ÑÐ½ÑÑ PDP"===n||"Behaviour"===n||"Bonus Info"===n||"ÐÐ·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑÐ²Ð¸Ðµ Ñ ÑÐ¸Ð»ÑÑÑÐ°Ð¼Ð¸ Ð°ÐºÑÐ¸Ð¹"===n||"ÐÐ·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑÐ²Ð¸Ðµ Ñ ÑÐ¸Ð»ÑÑÑÐ°Ð¼Ð¸ ÐÐÐ"===n||"Merchant Regrouping Available"===i||"Clicked Category Block"===i||"30 Seconds Spent On Page"===i||"ÐÐ»ÑÐ±Ð¸Ð½Ð° Ð¿ÑÐ¾ÐºÑÑÑÐºÐ¸"===n||"Clicked Customer Help Article"===i||"Clicked To Customer Help"===i||"Viewed Auth Popup"===i||"Sent Authentication SMS Code"===i||"Clicked To Login By Sber Id"===i||"Clicked To Subscription To SberPrime"===i||"Clicked Supermarket In Header"===i||"Selected Store In Supermarket Page"===i||"nav_button_click"===i||"Remove Inaccessible Item From Cart"===i||"Not Enough Order Amount Popup Viewed - custom"===i||"Coupon Applied"===i||"Add More Products Clicked"===i||"Clicked Repeat Order"===i||"plp"===n||"pdp"===n||"popup"===n||"navigation"===n||"merchant"===n||"map"===n||"profile"===n||"Unsubscribe"==a)}},{scope:"event",prop:"action",handler:function(e){return"Error"},event:"Refused Voucher"},{scope:"event",prop:"category",handler:function(e){return"Promo_Code_Apply"},event:"Refused Voucher"},{scope:"event",prop:"action",handler:function(e){return"Success"},event:"Applied Voucher"},{scope:"event",prop:"action",handler:function(e){return"Success"},event:"Removed Voucher"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Sent Registration SMS Code"},{scope:"event",prop:"website.isDDM",handler:function(e){return"false"}},{scope:"event",prop:"action",handler:function(e){return"Success"},event:"Sent Registration Info"},{scope:"event",prop:"category",handler:function(e){return"Registration"},event:"Sent Registration Info"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.path")},event:"Sent Registration Info"},{scope:"event",prop:"appWebView_name",handler:function(e){return this.digitalData("custom.webView.isGoodsApp")?"goodsAPP":this.digitalData("custom.webView.isPochtaApp")?"pochtaAPP":void 0}},{scope:"event",prop:"action",handler:function(e){return"Review_Not_Sent"},event:"Review Window Closed"},{scope:"event",prop:"action",handler:function(e){return"Review_Sent"},event:"Published Review"},{scope:"event",prop:"ignore",handler:function(e){return!0},event:"Completed Transaction - Card Payment"},{scope:"event",prop:"ignore",handler:function(e){return!0},event:"Viewed Page: dbm cpv"},{scope:"event",prop:"ignore",handler:function(e){return!0},event:"Viewed Page: yandex cpm||banner"},{scope:"event",prop:"action",handler:function(e){return"Product_Click"},event:"Clicked Product"},{scope:"event",prop:"label",handler:function(e){return this.digitalData("page.url")},event:"Clicked Product"},{scope:"event",prop:"Hit_ID",handler:function(e){return(new Date).getTime().toString()+Math.random().toString()}},{scope:"event",prop:"cartType",handler:function(e){e=this.get(e,"product.id");if(e)return-1<e.indexOf("CART_TYPE_DEFAULT")?"CART_TYPE_DEFAULT":-1<e.indexOf("CART_TYPE_CNC")?"CART_TYPE_CNC":-1<e.indexOf("CART_TYPE_CND")?"CART_TYPE_CND":-1<e.indexOf("CART_TYPE_MERCHANT")?"CART_TYPE_MERCHANT":void 0}},{scope:"event",prop:"category_lvl_1",handler:function(e){var t=this.digitalData("listing.category")||this.digitalData("product.category")||"";if(t)return t[0]}},{scope:"event",prop:"category_lvl_2",handler:function(e){var t=this.digitalData("listing.category")||this.digitalData("product.category")||"";if(t)return t[1]}},{scope:"event",prop:"cncAvailable",handler:function(e){return this.digitalData("product.cncAvailable")||this.get(e,"product.cncAvailable")||""}},{scope:"event",prop:"deliveryAvailable",handler:function(e){return this.digitalData("product.deliveryAvailable")||this.get(e,"product.deliveryAvailable")||""}},{scope:"event",prop:"BPG2",handler:function(e){return this.get(e,"product.BPG2")||this.digitalData("product.BPG2")||""}},{scope:"event",prop:"ignore",handler:function(e){if(2<=this.digitalData("custom.listing_veiwedcnc_count"))return!0},event:"Viewed CNC Product"},{scope:"event",prop:"categoryId",handler:function(e){if(this.digitalData("listing.categoryId")||this.digitalData("product.categoryId"))return this.digitalData("listing.categoryId")||this.digitalData("product.categoryId")}},{scope:"event",prop:"authType",handler:function(e){if(this.digitalData("user.isLoggedIn")||"Logged In"===this.get(e,"name"))return this.digitalData("user.lastAuthType")}},{scope:"event",prop:"category",handler:function(e){return"Authorization"},event:"Clicked To Login By Sber Id"},{scope:"event",prop:"category",handler:function(e){return"Authorization"},event:"Viewed Auth Popup"},{scope:"event",prop:"action",handler:function(e){return"Sent Authentication SMS Code"},event:"Sent Authentication SMS Code"},{scope:"event",prop:"category",handler:function(e){return"Authorization"},event:"Sent Authentication SMS Code"},{scope:"event",prop:"category1_2lvl",handler:function(e){var t=this.digitalData("listing.category")||this.digitalData("product.category")||"";if(t)return t[0]+"/"+t[1]+"/"+t[2]+"/"+t[3]}}]},myTarget:{goals:{Registered:"registered","Completed Transaction with MyTarget Source":"transaction"},counters:[{listVar:{type:"constant",value:"10"},counterId:"2856588",feedWithGroupedProducts:!1},{listVar:{type:"constant",value:"4"},counterId:"3223603"},{listVar:{type:"constant",value:"7"},counterId:"3223603"},{listVar:{type:"constant",value:"8"},counterId:"3223603"},{listVar:{type:"constant",value:"9"},counterId:"3223603"},{listVar:{type:"constant",value:"10"},counterId:"3223603"},{listVar:{type:"constant",value:"1"},counterId:"3223603"},{listVar:{type:"constant",value:"33255"},counterId:"3223603"},{listVar:{type:"constant",value:"33323"},counterId:"3223603"},{listVar:{type:"constant",value:"33537"},counterId:"3223603"},{listVar:{type:"constant",value:"33538"},counterId:"3223603"},{listVar:{type:"constant",value:"33539"},counterId:"3223603"},{listVar:{type:"constant",value:"33540"},counterId:"3223603"},{listVar:{type:"constant",value:"39451"},counterId:"3223603"},{listVar:{type:"constant",value:"39452"},counterId:"3223603"},{listVar:{type:"constant",value:"39453"},counterId:"3223603"},{listVar:{type:"constant",value:"39454"},counterId:"3223603"},{listVar:{type:"constant",value:"39455"},counterId:"3223603"},{listVar:{type:"constant",value:"39456"},counterId:"3223603"},{counterId:"3215949"}],eventEnrichments:[{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"ignore",handler:function(e){return"cart"===this.digitalData("page.type")},event:"Completed Transaction"}]},Vkontakte:{pixels:[{pixelId:"VK-RTRG-1421183-77G99",priceListId:{type:"constant",value:"1"}},{pixelId:"VK-RTRG-1522272-gSw6t",priceListId:{type:"constant",value:"1"}},{priceListId:{type:"constant",value:"1"}},{pixelId:"VK-RTRG-1392950-ns48",priceListId:{type:"constant",value:"1"}},{pixelId:"VK-RTRG-740345-e0KWW",priceListId:{type:"constant",value:"1"}},{pixelId:"VK-RTRG-934121-8M7uZ",priceListId:{type:"constant",value:"1"}},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"140664"},feedWithGroupedProducts:!1},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"343775"},feedWithGroupedProducts:!1},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"352574"}},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"343768"}},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"343764"}},{pixelId:"VK-RTRG-1042270-gnJEy",priceListId:{type:"constant",value:"343773"}}],customEvents:{"Logged In":"auth",Registered:"reg","15 Seconds Spent On Site":"15second"},eventEnrichments:[{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"ignore",handler:function(e){return"cart"===this.digitalData("page.type")},event:"Completed Transaction"}]},"OWOX BI Streaming":{sessionStreaming:!0,sessionIdDimension:"104"},"Google Tag Manager":{noConflict:!0},Flocktory:{siteId:"2319",exchange:!0,preCheckout:!0,postCheckout:!0,exchangeTriggerEvent:["Order Success Thank You Page View"],eventEnrichments:[{scope:"product",prop:"id",handler:function(e){return this.get(e,"skuCode")}},{scope:"event",prop:"ignore",handler:function(e){return"cart"===this.digitalData("page.type")},event:"Completed Transaction"},{scope:"event",prop:"ignore",handler:function(e){return!!this.digitalData("custom.webView.isPochtaApp")}},{scope:"event",prop:"user.email",handler:function(e){return this.digitalData("user.email")||this.digitalData("contactInfo.email")||this.digitalData("contactInfo.phone")+"@unknown.email"},event:"Completed Transaction"},{scope:"event",prop:"ignore",handler:function(e){},event:"Viewed Page"}]}}});